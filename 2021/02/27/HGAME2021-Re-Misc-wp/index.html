<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>HGAME2021 Re&amp;Misc wp | in1t's blog</title><meta name="keywords" content="CTF,逆向,Misc"><meta name="author" content="in1t"><meta name="copyright" content="in1t"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="为期 4 个星期的 HGAME2021 结束了，今年的 hgame 依然有着较高质量的题目和出题人的手把手 hint，可以说对👴这样的萌新很友好">
<meta property="og:type" content="article">
<meta property="og:title" content="HGAME2021 Re&amp;Misc wp">
<meta property="og:url" content="https://in1t.top/2021/02/27/HGAME2021-Re-Misc-wp/index.html">
<meta property="og:site_name" content="in1t&#39;s blog">
<meta property="og:description" content="为期 4 个星期的 HGAME2021 结束了，今年的 hgame 依然有着较高质量的题目和出题人的手把手 hint，可以说对👴这样的萌新很友好">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://in1t.top/img/cover/hgame2021.jpg">
<meta property="article:published_time" content="2021-02-27T05:23:15.000Z">
<meta property="article:modified_time" content="2021-07-07T08:28:28.021Z">
<meta property="article:author" content="in1t">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="逆向">
<meta property="article:tag" content="Misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://in1t.top/img/cover/hgame2021.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://in1t.top/2021/02/27/HGAME2021-Re-Misc-wp/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HGAME2021 Re&Misc wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-07-07 16:28:28'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">45</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-play-circle"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/hgame2021.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">in1t's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-play-circle"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HGAME2021 Re&amp;Misc wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-02-27T05:23:15.000Z" title="发表于 2021-02-27 13:23:15">2021-02-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-07T08:28:28.021Z" title="更新于 2021-07-07 16:28:28">2021-07-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>47分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>为期 4 个星期的 HGAME2021 结束了，今年的 hgame 依然有着较高质量的题目和出题人的手把手 hint，可以说对👴这样的萌新很友好。所有的题目里我只做了 Re 和 Misc 的，没办法太菜了其他的不敢染指，题目（re/pwn/misc）及官方 wp 我都整理到了 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/193dK07RIaDHFhD0aQRAp3Q">网盘</a>（提取码：3oyi），8说了，自闭去了</p>
<h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><h4 id="apacha"><a href="#apacha" class="headerlink" title="apacha"></a>apacha</h4><blockquote>
<p>分值：150pts</p>
<p>描述：一杯阿帕茶</p>
</blockquote>
<p>main 函数：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/1.png" alt="hgame2021"></p>
<p>输入 35 个字符，程序将每个字符零扩展成四字节，保存在元素个数为 35 的 DWORD 数组中作为明文，用已知的 key 进行 xxtea 加密，结果与已知的数组比较。脚本（xxtea 函数是网上找的）：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX ((z &gt;&gt; 5 ^ y <span class="meta-string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4) ^ (sum ^ y) + (k[p &amp; 3 ^ e] ^ z))</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">xxtea</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span>* v, <span class="keyword">int</span> n, <span class="keyword">unsigned</span> <span class="keyword">int</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> z = v[n - <span class="number">1</span>], y = v[<span class="number">0</span>], sum = <span class="number">0</span>, e, DELTA = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> p, q;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123; <span class="comment">/* Coding Part */</span></span><br><span class="line">        q = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        <span class="keyword">while</span> (q-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">                y = v[p + <span class="number">1</span>], z = v[p] += MX;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) &#123; <span class="comment">/* Decoding Part */</span></span><br><span class="line">        n = -n;</span><br><span class="line">        q = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = q * DELTA;</span><br><span class="line">        <span class="keyword">while</span> (sum != <span class="number">0</span>) &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">                z = v[p - <span class="number">1</span>], y = v[p] -= MX;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v[<span class="number">35</span>] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">3880694563u</span>, <span class="number">3081185334u</span>, <span class="number">1506439138u</span>, <span class="number">2524759489u</span>,</span><br><span class="line">        <span class="number">3883935348u</span>, <span class="number">1026381030u</span>, <span class="number">2325545814u</span>, <span class="number">2581382044u</span>,</span><br><span class="line">        <span class="number">1881594093u</span>, <span class="number">1781792173u</span>, <span class="number">4103492874u</span>, <span class="number">1553756062u</span>,</span><br><span class="line">        <span class="number">468045900u</span>, <span class="number">1730391575u</span>, <span class="number">1383114178u</span>, <span class="number">2890011402u</span>,</span><br><span class="line">        <span class="number">2227070898u</span>, <span class="number">1885128569u</span>, <span class="number">1548828056u</span>, <span class="number">4214676013u</span>,</span><br><span class="line">        <span class="number">571971141u</span>, <span class="number">1558401693u</span>, <span class="number">3515474427u</span>, <span class="number">3898332297u</span>,</span><br><span class="line">        <span class="number">1942540575u</span>, <span class="number">1421197718u</span>, <span class="number">3061626000u</span>, <span class="number">555214026u</span>,</span><br><span class="line">        <span class="number">2648963476u</span>, <span class="number">794468778u</span>, <span class="number">2816999933u</span>, <span class="number">3272437419u</span>,</span><br><span class="line">        <span class="number">464379036u</span>, <span class="number">877899850u</span>, <span class="number">2460223225u</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> key[<span class="number">4</span>] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">    <span class="built_in">xxtea</span>(v, <span class="number">-35</span>, key);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, v[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// hgame&#123;l00ks_1ike_y0u_f0Und_th3_t34&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="helloRe"><a href="#helloRe" class="headerlink" title="helloRe"></a>helloRe</h4><blockquote>
<p>分值：150pts</p>
<p>描述：Welcome to reverse world !</p>
</blockquote>
<p>shift + F12 查找字符串 “checking flag” 的交叉引用，来到函数 sub_1400014C0，逻辑很简单：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/2.png" alt="hgame2021"></p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line">target = <span class="string">&quot;97 99 9C 91 9E 81 91 9D 9B 9A 9A AB 81 97 AE 80 83 8F 94 89 99 97&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">b = <span class="number">0xFF</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> target:</span><br><span class="line">  flag += <span class="built_in">chr</span>(t ^ b)</span><br><span class="line">  b -= <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span> flag</span><br><span class="line"><span class="comment"># hgame&#123;hello_re_player&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h4><blockquote>
<p>分值：150pts</p>
<p>描述：pypy。<strong>flag的格式为hgame{your_flag_here}</strong></p>
</blockquote>
<p>题目是一个 python 程序的字节码，阅读一遍后还原 python 代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">raw_flag = <span class="built_in">input</span>(<span class="string">&quot;give me your flag:\n&quot;</span>)</span><br><span class="line">cipher = <span class="built_in">list</span>(raw_flag[<span class="number">6</span>:-<span class="number">1</span>])</span><br><span class="line">length = <span class="built_in">len</span>(cipher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">	cipher[<span class="number">2</span>*i], cipher[<span class="number">2</span>*i+<span class="number">1</span>] = cipher[<span class="number">2</span>*i+<span class="number">1</span>], cipher[<span class="number">2</span>*i]</span><br><span class="line"></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">	res.append(<span class="built_in">ord</span>(cipher[i]) ^ i)</span><br><span class="line">res = <span class="built_in">bytes</span>(res).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;your flag: &quot;</span> + res)</span><br><span class="line"><span class="comment"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span></span><br></pre></td></tr></table></figure>

<p>解题脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cipher = []</span><br><span class="line">res = <span class="string">&quot;30466633346f59213b4139794520572b45514d61583151576638643a&quot;</span>.decode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">	cipher.append(<span class="built_in">ord</span>(res[i]) ^ i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res) // <span class="number">2</span>):</span><br><span class="line">	cipher[<span class="number">2</span>*i], cipher[<span class="number">2</span>*i+<span class="number">1</span>] = cipher[<span class="number">2</span>*i+<span class="number">1</span>], cipher[<span class="number">2</span>*i]</span><br><span class="line">cipher = <span class="built_in">map</span>(<span class="built_in">chr</span>, cipher)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(cipher)</span><br><span class="line"><span class="comment"># hgame&#123;G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Base全家福"><a href="#Base全家福" class="headerlink" title="Base全家福"></a>Base全家福</h4><blockquote>
<p>分值：50pts</p>
<p>描述：新年即将来临之际，Base家族也团聚了，他们用他们特有的打招呼方式向你问了个好，你知道他们在说什么吗？</p>
</blockquote>
<p>base64 -&gt; base32 -&gt; base16</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b32decode, b16decode</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;R1k0RE1OWldHRTNFSU5SVkc1QkRLTlpXR1VaVENOUlRHTVlETVJCV0dVMlVNTlpVR01ZREtSUlVIQTJET01aVUdSQ0RHTVpWSVlaVEVNWlFHTVpER01KWElRPT09PT09&quot;</span></span><br><span class="line"><span class="built_in">print</span> b16decode(b32decode(b64decode(data)))</span><br><span class="line"><span class="comment"># hgame&#123;We1c0me_t0_HG4M3_2021&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="不起眼压缩包的养成的方法"><a href="#不起眼压缩包的养成的方法" class="headerlink" title="不起眼压缩包的养成的方法"></a>不起眼压缩包的养成的方法</h4><blockquote>
<p>分值：100pts</p>
<p>描述：0x4qE给了张图给我，说这图暗藏玄机，你能帮我找出来吗？</p>
</blockquote>
<p>图片备注里有提示 <code>Secret hidden IN picture.</code>，binwalk 分离得到一个 zip 压缩包。打开发现备注里提示 <code>Password is picture ID</code>，那肯定是 P 站的 ID 了，百度识图找到 ID 为 <code>70415155</code></p>
<p>解压得到一个文本文档和一个压缩包，而这个 txt 恰好在 plain.zip 里也有，明文攻击得到口令 <code>C8uvP$DP</code></p>
<p>解压得到 flag.zip，该压缩包是伪加密，将文件偏移 0x11E 处的 01 改成 00 后解压，得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#x68;&amp;#x67;&amp;#x61;&amp;#x6D;&amp;#x65;&amp;#x7B;&amp;#x32;&amp;#x49;&amp;#x50;&amp;#x5F;&amp;#x69;&amp;#x73;&amp;#x5F;&amp;#x55;&amp;#x73;&amp;#x65;&amp;#x66;&amp;#x75;&amp;#x31;&amp;#x5F;&amp;#x61;&amp;#x6E;&amp;#x64;&amp;#x5F;&amp;#x4D;&amp;#x65;&amp;#x39;&amp;#x75;&amp;#x6D;&amp;#x69;&amp;#x5F;&amp;#x69;&amp;#x35;&amp;#x5F;&amp;#x57;&amp;#x30;&amp;#x72;&amp;#x31;&amp;#x64;&amp;#x7D;</span><br></pre></td></tr></table></figure>

<p>这是 html 转义字符，可以创建一个 flag.html，将上面的内容复制进去，再用浏览器打开，得到 flag <code>hgame&#123;2IP_is_Usefu1_and_Me9umi_i5_W0r1d&#125;</code></p>
<br>

<h4 id="Galaxy"><a href="#Galaxy" class="headerlink" title="Galaxy"></a>Galaxy</h4><blockquote>
<p>分值：100pts</p>
<p>描述：Akira的信物：用于提升Akira的潜能。一张藏着秘密的星空壁纸，不幸的是似乎在某次行动中遗失了。</p>
</blockquote>
<p>跟踪 tcp 流 26，将图片导出，把 png 高度改大点，得到 flag <code>hgame&#123;Wh4t_A_W0nderfu1_Wa11paper&#125;</code></p>
<br>

<h4 id="Word-RE-MASTER"><a href="#Word-RE-MASTER" class="headerlink" title="Word RE:MASTER"></a>Word RE:MASTER</h4><blockquote>
<p>分值：150pts</p>
<p>描述：timmix不知所踪，只留下了两个word文档，作为word专家的你能帮忙找出他的去向吗？</p>
</blockquote>
<p>first.docx 后缀改为 zip 解压，在 word 目录下有一个 password.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++.&lt;+ ++[-&gt; +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;-.++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-. +++.+ .++++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-- ----. +.--- --..+ .++++ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----- .&lt;<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>妥妥的 brainfuck，解码得到 <code>DOYOUKNOWHIDDEN?</code>，是 maimai.docx 的密码。打开 maimai.docx，图片下面有隐藏文字，选中它们，右键字体，取消勾选隐藏文字后，发现其由空格和 tab 组成，联系图片想到 snow 隐写。将其复制到 snow.txt 中：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/16.png" alt="hgame2021"></p>
<p>ubuntu 下使用指令 <code>stegsnow -C snow.txt</code>，得到 flag <code>hgame&#123;Cha11en9e_Whit3_P4ND0R4_P4R4D0XXX&#125;</code></p>
<br>

<h2 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h2><h3 id="Re-1"><a href="#Re-1" class="headerlink" title="Re"></a>Re</h3><h4 id="ezApk"><a href="#ezApk" class="headerlink" title="ezApk"></a>ezApk</h4><blockquote>
<p>分值：200pts</p>
<p>描述：input your flag to check！</p>
</blockquote>
<p>jadx 打开 apk，在 com.ryen.ezapk.MainActivity 类中找到 onClick 方法，和 flag 有关的只有一句判断：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/3.png" alt="hgame2021"></p>
<p>由于存在混淆，许多符号被替换成了单个字母，不过不影响通过函数行为判断其作用。c.d.b.a.a 方法的代码：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/4.png" alt="hgame2021"></p>
<p>不难看出是 isEqual，由此可知  <code>MainActivity.s(mainActivity3, editText2.getText().toString())</code> 的返回值就是 flag，其中 <code>editText2.getText()</code> 就是输入。MainActivity.s 对输入进行了加密：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/5.png" alt="hgame2021"></p>
<p>可以发现，key 和 iv 都被 mainActivity.t 函数处理了：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/6.png" alt="hgame2021"></p>
<p>该函数的作用是对 str2 进行 str 指定的 hash 算法，于是 key 为 sha256(R.string.key)，iv 为 md5(R.string.key)，R.string.flag 和 R.string.key 都可以从资源文件中取到（路径在 resources.arsc/res/values/strings.xml）：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/7.png" alt="hgame2021"></p>
<p>解题脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256, md5</span><br><span class="line"></span><br><span class="line">ori = <span class="string">&quot;EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY&quot;</span></span><br><span class="line">cipher = b64decode(ori)</span><br><span class="line"></span><br><span class="line">key = sha256(<span class="string">&quot;A_HIDDEN_KEY&quot;</span>).digest()</span><br><span class="line">iv = md5(<span class="string">&quot;A_HIDDEN_KEY&quot;</span>).digest()</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="built_in">print</span> aes.decrypt(cipher).rstrip()</span><br><span class="line"><span class="comment"># hgame&#123;jUst_A_3z4pp_write_in_k07l1n&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="helloRe2"><a href="#helloRe2" class="headerlink" title="helloRe2"></a>helloRe2</h4><blockquote>
<p>分值：250pts</p>
<p>描述：Input 2 passwords and get your flag !</p>
</blockquote>
<p>main 函数中验证第一个密码的部分：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/8.png" alt="hgame2021"></p>
<p>将输入（16个字符）视作 128 位的数值与 xmmword_4030F0 比较，所以 <code>pwd1 = 2b0c5e6a3a20b189</code>。pwd1 正确后，程序：</p>
<ul>
<li>以暂停状态创建新进程</li>
<li>通过 CreateFileMappingA 创建一个共享文件映射对象</li>
<li>将密钥变换后映射到文件中去（可以理解成往共享内存里写密钥）</li>
<li>启动新进程</li>
</ul>
<p>新进程由于已经设置了共享对象，所以走 main 函数开头的 if 判断里，进行 pwd2 的检测：<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/9.png" alt="hgame2021"></p>
<p>由 BCryptOpenAlgorithmProvider 参数 pszAlgId 可知<strong>加密方式为 AES</strong>，由 BCryptSetProperty 参数 pbInput 可知<strong>加密模式为 CBC</strong>。BCryptGenerateSymmetricKey 的参数 pbSecret 为被映射的密钥，可以用调试器附加新进程取得：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/10.png" alt="hgame2021"></p>
<p>由 BCryptEncrypt 的第五个参数可知 iv 为 unk_40312C，加密结果与 xmmword_4030E0 比较。解题脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">pwd1 = <span class="string">&quot;2b0c5e6a3a20b189&quot;</span></span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&quot;B7FEFED9077679653F4E5F62D502F67E&quot;</span>.decode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line">key = <span class="string">&quot;2c2`1`0f;h8;n&lt;66&quot;</span></span><br><span class="line">iv = <span class="string">&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F&quot;</span></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">pwd2 = aes.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;hgame&#123;%s_%s&#125;&quot;</span> % (pwd1, pwd2)</span><br><span class="line"><span class="comment"># hgame&#123;2b0c5e6a3a20b189_7a4ad6c5671fb313&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="fake-debugger-beta"><a href="#fake-debugger-beta" class="headerlink" title="fake_debugger beta"></a>fake_debugger beta</h4><blockquote>
<p>分值：150pts</p>
<p>描述：你写了一个什么奇怪的debugger？这东西能用？看起来规则也不太一样？</p>
</blockquote>
<p>首先测试得到最短 flag 长度为 11，输入 <code>hgame&#123;aaaaa</code>，根据单步调试结果：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/11.png" alt="hgame2021"></p>
<p>分析可知程序会从头开始逐一字符检查输入，每个字符要单步两次才知道对不对，ecx 记录经检查已正确的字符数。对于 flag 的前 6 个字符（”hgame{“），每个字符的第一次单步中，eax ^ ebx 的结果就是这个字符应为的 ascii 值。对于 flag 的后面部分，每个字符第一次单步的 ebx 与 第二次单步的 ebx 异或的结果就是这个字符应为的 ascii 值，如上图</p>
<p>逐一测试后得到 flag <code>hgame&#123;You_Kn0w_debuGg3r&#125;</code></p>
<br>

<h3 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h4><blockquote>
<p>分值：100pts</p>
<p>描述：工欲善其事，必先利其器。</p>
</blockquote>
<p>第一层：F5 隐写，密码在 <strong>属性 -&gt; 详细信息 -&gt;备注</strong> 里，<code>java Extract ~/Matryoshka.jpg -p \!LyJJ9bi\&amp;M7E72\*JyD</code>（ubuntu 下执行，注意加反斜杠转义），得到 F5.7z 压缩包密码 <code>e@317S*p1A4bIYIs1M</code></p>
<p>第二层：Steghide 隐写，密码也在备注里，<code>steghide extract -sf 01.jpg -p A7SL9nHRJXLh\@\$EbE8</code>，得到 Steghide.7z 压缩包密码 <code>u0!FO4JUhl5!L55%$&amp;</code></p>
<p>第三层：Outguess 隐写，密码在备注里，<code>outguess -k &quot;z0GFieYAee%gdf0%lF&quot; -r 02.jpg out.txt</code> ，得到 Outguess.7z 压缩包密码 <code>@UjXL93044V5zl2ZKI</code></p>
<p>第四层：使用软件 jphs，密码在备注里，得到 JPHS.7z 压缩包密码 <code>xSRejK1^Z1Cp9M!z@H</code></p>
<p>将 4 块二维码拼接起来扫描得到 flag <code>hgame&#123;Taowa_is_N0T_g00d_but_T001s_is_Useful&#125;</code></p>
<br>

<h4 id="Telegraph：1601-6639-3459-3134-0892"><a href="#Telegraph：1601-6639-3459-3134-0892" class="headerlink" title="Telegraph：1601 6639 3459 3134 0892"></a>Telegraph：1601 6639 3459 3134 0892</h4><blockquote>
<p>分值：150pts</p>
<p>描述：他曾经最喜欢的曲师写的曲子，让人犹如漫步在星空之下，可如今他听见只觉得反胃。<strong>请将flag以hgame{your_flag_here}形式提交，flag为全大写。</strong></p>
</blockquote>
<p>粗听一遍，在 1:10 左右听到一连串的摩斯电码，Audacity 打开，查看频谱图：<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/12.png" alt="hgame2021"></p>
<p>故摩斯电码在 850Hz 左右的频段，注意到摩斯电码中间部分与音乐本身重叠，波形图有些难以辨认，而且速度很快。考虑使用 pr 将 850Hz 的音频提取出来。音频效果里加图形均衡器（30段），把 800 和 1khz 拉高，其他全拉到最低，并延长播放时间（保持音调），导出后再用 Audacity 打开，波形图就很清晰了（修正后的音频见 exp 目录下的 pr_modified.mp3）。得到摩斯电码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-.-- --- ..- .-. ..-. .-.. .- --. .. ... ---... ....- --. ----- ----- -.. ... ----- -. --. -... ..- - -. ----- - ....- --. ----- ----- -.. -- .- -. ----- ...-- ----. ...-- .---- ----- -.- ..</span><br><span class="line">YOURFLAGIS4G00DS0NGBUTN0T4G00DMAN039310KI</span><br></pre></td></tr></table></figure>

<p>故 flag 为 <code>hgame&#123;4G00DS0NGBUTN0T4G00DMAN039310KI&#125;</code></p>
<br>

<h4 id="Hallucigenia"><a href="#Hallucigenia" class="headerlink" title="Hallucigenia"></a>Hallucigenia</h4><blockquote>
<p>分值：200pts</p>
<p>描述：“我们不仅弄错了他的上下，还颠倒了它的左右。”</p>
</blockquote>
<p>stegsolve 打开，在 Red plane 0 通道发现被反相的二维码，截图出来反相、扫描，得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC/KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51/KHHT/6/ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5/IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF/LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y///p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk=</span><br></pre></td></tr></table></figure>

<p>base64 解一下发现是顺序反过来的 png，脚本生成 png：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">raw = <span class="string">&quot;gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC/KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51/KHHT/6/ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5/IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF/LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y///p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk=&quot;</span></span><br><span class="line">data = base64.b64decode(raw)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(data)</span><br></pre></td></tr></table></figure>

<p>得到一个上下颠倒的 flag：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/13.png" alt="hgame2021"></p>
<p>ps 里垂直翻转一下得到 flag <code>hgame&#123;tenchi_souzou_dezain_bu&#125;</code></p>
<br>

<h4 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h4><blockquote>
<p>分值：100pts</p>
<p>描述：A significant invention.</p>
</blockquote>
<p>Wireshark 打开，跟踪编号为 71 的 http 流：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/14.png" alt="hgame2021"></p>
<p>访问的域名是 flag.hgame2021.cf，根据提示的 SPF 和题目名字 DNS，联想到通过 dig 指令查看该域名的 TXT 记录，在 ubuntu 命令行键入 <code>dig flag.hgame2021.cf TXT</code>，得到 flag：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/15.png" alt="hgame2021"></p>
<br>

<h2 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h2><h3 id="Re-2"><a href="#Re-2" class="headerlink" title="Re"></a>Re</h3><h4 id="gun"><a href="#gun" class="headerlink" title="gun"></a>gun</h4><blockquote>
<p>分值：350pts</p>
<p>描述：I shoot flag out, Can you catch it?</p>
</blockquote>
<p>jadx 打开，发现包 com.SecShell.SecShell，梆梆加固。反射大师可以脱，但是题目附件有问题，装在手机上运行就闪退，所以就不做了= =</p>
<br>

<h4 id="FAKE"><a href="#FAKE" class="headerlink" title="FAKE"></a>FAKE</h4><blockquote>
<p>分值：300pts</p>
<p>描述：你能算出来吗？</p>
</blockquote>
<p>init_array 数组中存在 sub_406A11，在 main 函数执行前的初始化阶段被调用，该函数检测进程是否被调试，未被调试的话就调用 sub_40699B 进行 SMC。用 ida python 脚本还原：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;00 00 00 00 00 00 00 00 00 08 91 88 C6 45 FC 48 89 BD 28 B6 74 BA A0 C5 16 90 D3 74 FF D3 D0 35 48 8B FC FA 48 83 C0 74 02 D7 98 88 E9 C6 47 88 75 BA 17 BE 55 C0 0C 4C 85 AF 3E 34 72 AB EC 48 8B 82 6D 80 7D 3F E7 7C FA 89 D0 06 65 CE FF 2F FE 5F DE D0 01 06 CD 5B BB 17 B7 4F 35 80 8B D7 0C 04 3F 1F F9 87 09 8D 14 C6 CD 53 BB 17 B7 37 3A 00 00 C7 0E DC 95 3F BC C2 0C 48 8B 82 6D A8 7D 3F BB C7 D1 6B C0 11 84 26 B6 74 BA ED 4E 00 6B 07 98 E9 3C B7 74 CB 2B 48 83 07 C9 67 FE 94 3F DC AD C2 48 4C C0 18 B6 7C 3F 39 24 00 6B 07 3A 79 F2 FD B7 11 F0 E8 48 44 45 DC 75 EF 76 18 72 E0 03 C6 55 71 EA FE B7 B0 E8 E8 48 44 45 70 74 FF 94 8A 65 8D 0C C5 CD 8F BA 17 B7 D3 6D 68 8B D7 0C D8 3E 1D FC E7 06 C1 E0 C4 84 CD B7 74 BA 54 B9 83 C0 E7 0E 00 76 2F 3E F0 ED 29 D0 06 65 10 72 EB FE 53 68 45 E8 8F 06 D8 CF 74 FF E9 21 EC 01 05 CD 97 BA 17 B7 37 16 7C 8B C7 EE E0 E5 FE 3D 99 35 45 E8 8F 06 E4 A7 74 FF 39 07 BA 8D CB 87 60 74 BA 17 95 42 C0 1C 4C 95 A5 2F 3E 1F 5F BD D0 01 06 CD BB BA 17 B7 A3 7B 34 8B D7 0C E4 FE 3F FE 57 07 E0 04 4A 91 39 B7 74 BA EC FE 05 84 C7 85 3C 74 FF 94 95 03 01 C2 8F 0E 05 17 B7 7C E5 B9 8B 00 AC 45 9F FE 3D B7 B4 F1 E8 48 44 45 3C 74 FF 94 D6 AA 01 C2 8F 0E 09 17 B7 FA 10 B6 00 00 4C 85 5B 3E 43 72 64 02 48 8B 82 6D 7C 7D 3F EB EC 10 89 D0 06 67 3B D7 2F FE A1 8D 14 01 8F 0E 79 16 B7 7C AD 28 8B 00 AC 45 DD FF 3D B7 EE 45 E8 48 44 45 7C 75 FF 94 BB 5A 01 C2 8F 0E 0D 16 B7 7C 80 5C 8B 00 AC 45 A5 FF 3D B7 D4 45 E8 48 44 45 00 75 FF 94 86 DF 01 C2 8F 0E 11 16 B7 7C 81 6C 8B 00 C6 47 10 75 BA 17 03 83 C0 78 4C 85 D5 3F 3E 1F 46 29 C1 89 0F 84 A2 B6 74 BA B7 48 83 C0 A3 0E 64 95 3F A7 67 C2 48 8B 82 6D 20 7D 3F EF E7 00 6B C0 2A 84 AE B6 74 BA 89 48 83 C0 87 0E 70 95 3F 30 66 C2 48 8B 82 6D 3C 7D 3F 9F AA 00 6B C0 9E 84 BA B6 74 BA C5 48 83 C0 CF 0E 7C 95 3F 22 65 C2 48 8B 82 6D C8 7D 3F B7 E4 00 6B C0 7A 84 54 C3 69 03 A0 FF 0F 85 C3 D0 88 FE B7 74 1C E8 48 83 07 F1 07 EE 76 2F F1 E0 02 01 17 72 48 B6 74 AA 9D 48 83 C2 9F 0E 86 95 2D C3 5E C2 48 8B 82 6D D0 7D 3F CF E0 00 6B C0 34 08 90 FC B7 74 2A E8 48 83 07 F5 2B EE 76 2F AF E0 02 01 17 08 B0 FF B7 74 32 E8 48 83 07 C1 23 FE 94 3F FB 01 C2 48 4C C0 44 B6 7C 3F 77 8B 00 6B 07 DF B1 3C B7 74 08 E8 48 83 07 AD 3F FE 94 3F 7D 01 C2 48 4C C0 50 B6 7C 3F 63 8B 00 6B 07 BC BD 3C B7 74 38 E8 48 83 07 29 77 01 6B C0 A5 C6 87 B0 8B 45 E8 8B E9 D2 C0 D8 01 05 0D 7F 45 E8 48 83 29 E3 8B 00 6B 07 7D F1 C2 48 8B 45 01 CD 83 E8 80 00 55 71 48 11 E1 C6 28 11 88 08 04 CE 89 0D 7F 44 38 00 1B 4B 94 0E 40 76 2F 3E 69 56 D1 59 11 E1 C3 00 11 49 4B CC 2A C3 40 7C 01 D0 48 13 58 04 C4 44 E0 02 01 D0 49 4B 84 E9 B6 74 BA A0 49 53 4B 08 02 D1 02 85 F1 49 D1 D1 01 E1 D2 00 10 88 03 C3 CE B1 E9 98 CB 58 E3 0F 95 B9 2E 3E 1F 0D AE 18 06 41 F9 C1 5B 44 28 49 53 C1 F4 02 C2 02 84 35 E1 D6 A4 D5 87 80 99 4B DC 0E 15 17 B7 7C 43 55 7B 01 E8 BD C9 04 CD C6 FA BA 17 B7 00 85 A0 8A 83 16 34 5F 0E 4C 1F 74 BA 17 CB C6 38 3D 08 7D 93 C5 C8 8F FF B7 74 BA 2F 0D 6F C0 48 8B 00 2A B8 C1 44 2A 48 8B 45 E8 A3 C6 4B 41 67 89 BB C1 DE 00 12 49 4B CC 2A C3 C6 28 19 5B 48 F3 4B 63 84 92 B7 74 BA 63 1D 6F 49 9C 8A C0 6A 10 B0 C1 4B 8A 00 00 00 49 D5 CC 98 8B 84 0E C0 95 3F D0 38 03 3C 8C 82 AD B4 83 C0 04 8B 83 2E 28 ED 82 BF A0 8E 3B 5D CB 40 64 01 83 7D 67 05 15 62 C8 44 3E 81 48 00 04 70 40 00 00 00 00 00&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">table = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> table]</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x401216</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x43F</span>):</span><br><span class="line">	b = get_bytes(addr + i, <span class="number">1</span>)</span><br><span class="line">	idc.PatchByte(addr + i, <span class="built_in">ord</span>(b) ^ table[i])</span><br></pre></td></tr></table></figure>

<p>之后 main 函数调用 sub_401216 检查输入，该函数意在解多元一次方程组，使用 z3：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = [BitVec(<span class="string">&#x27;flag_%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>)]</span><br><span class="line">solver = Solver()</span><br><span class="line">solver.add(<span class="number">104</span> * flag[<span class="number">0</span>] + <span class="number">64</span> * flag[<span class="number">1</span>] + <span class="number">95</span> * flag[<span class="number">2</span>] + <span class="number">45</span> * flag[<span class="number">3</span>] + <span class="number">117</span> * flag[<span class="number">4</span>] + <span class="number">95</span> * flag[<span class="number">5</span>] == <span class="number">55030</span>)</span><br><span class="line">solver.add(<span class="number">103</span> * flag[<span class="number">0</span>] + <span class="number">95</span> * flag[<span class="number">1</span>] + <span class="number">102</span> * flag[<span class="number">2</span>] + <span class="number">100</span> * flag[<span class="number">3</span>] + <span class="number">95</span> * flag[<span class="number">4</span>] + <span class="number">83</span> * flag[<span class="number">5</span>] == <span class="number">61095</span>)</span><br><span class="line">solver.add(<span class="number">97</span> * flag[<span class="number">0</span>] + <span class="number">70</span> * flag[<span class="number">1</span>] + <span class="number">108</span> * flag[<span class="number">2</span>] + <span class="number">111</span> * flag[<span class="number">3</span>] + <span class="number">107</span> * flag[<span class="number">4</span>] + <span class="number">77</span> * flag[<span class="number">5</span>] == <span class="number">60151</span>)</span><br><span class="line">solver.add(<span class="number">109</span> * flag[<span class="number">0</span>] + <span class="number">65</span> * flag[<span class="number">1</span>] + <span class="number">97</span> * flag[<span class="number">2</span>] + <span class="number">95</span> * flag[<span class="number">3</span>] + <span class="number">111</span> * flag[<span class="number">4</span>] + <span class="number">67</span> * flag[<span class="number">5</span>] == <span class="number">57247</span>)</span><br><span class="line">solver.add(<span class="number">101</span> * flag[<span class="number">0</span>] + <span class="number">75</span> * flag[<span class="number">1</span>] + <span class="number">103</span> * flag[<span class="number">2</span>] + <span class="number">89</span> * flag[<span class="number">3</span>] + <span class="number">110</span> * flag[<span class="number">4</span>] + <span class="number">63</span> * flag[<span class="number">5</span>] == <span class="number">56780</span>)</span><br><span class="line">solver.add(<span class="number">123</span> * flag[<span class="number">0</span>] + <span class="number">69</span> * flag[<span class="number">1</span>] + <span class="number">33</span> * flag[<span class="number">2</span>] + <span class="number">48</span> * flag[<span class="number">3</span>] + <span class="number">119</span> * flag[<span class="number">4</span>] + <span class="number">125</span> * flag[<span class="number">5</span>] == <span class="number">55726</span>)</span><br><span class="line">solver.add(<span class="number">104</span> * flag[<span class="number">6</span>] + <span class="number">64</span> * flag[<span class="number">7</span>] + <span class="number">95</span> * flag[<span class="number">8</span>] + <span class="number">45</span> * flag[<span class="number">9</span>] + <span class="number">117</span> * flag[<span class="number">10</span>] + <span class="number">95</span> * flag[<span class="number">11</span>] == <span class="number">46642</span>)</span><br><span class="line">solver.add(<span class="number">103</span> * flag[<span class="number">6</span>] + <span class="number">95</span> * flag[<span class="number">7</span>] + <span class="number">102</span> * flag[<span class="number">8</span>] + <span class="number">100</span> * flag[<span class="number">9</span>] + <span class="number">95</span> * flag[<span class="number">10</span>] + <span class="number">83</span> * flag[<span class="number">11</span>] == <span class="number">52931</span>)</span><br><span class="line">solver.add(<span class="number">97</span> * flag[<span class="number">6</span>] + <span class="number">70</span> * flag[<span class="number">7</span>] + <span class="number">108</span> * flag[<span class="number">8</span>] + <span class="number">111</span> * flag[<span class="number">9</span>] + <span class="number">107</span> * flag[<span class="number">10</span>] + <span class="number">77</span> * flag[<span class="number">11</span>] == <span class="number">53580</span>)</span><br><span class="line">solver.add(<span class="number">109</span> * flag[<span class="number">6</span>] + <span class="number">65</span> * flag[<span class="number">7</span>] + <span class="number">97</span> * flag[<span class="number">8</span>] + <span class="number">95</span> * flag[<span class="number">9</span>] + <span class="number">111</span> * flag[<span class="number">10</span>] + <span class="number">67</span> * flag[<span class="number">11</span>] == <span class="number">50437</span>)</span><br><span class="line">solver.add(<span class="number">101</span> * flag[<span class="number">6</span>] + <span class="number">75</span> * flag[<span class="number">7</span>] + <span class="number">103</span> * flag[<span class="number">8</span>] + <span class="number">89</span> * flag[<span class="number">9</span>] + <span class="number">110</span> * flag[<span class="number">10</span>] + <span class="number">63</span> * flag[<span class="number">11</span>] == <span class="number">50062</span>)</span><br><span class="line">solver.add(<span class="number">123</span> * flag[<span class="number">6</span>] + <span class="number">69</span> * flag[<span class="number">7</span>] + <span class="number">33</span> * flag[<span class="number">8</span>] + <span class="number">48</span> * flag[<span class="number">9</span>] + <span class="number">119</span> * flag[<span class="number">10</span>] + <span class="number">125</span> * flag[<span class="number">11</span>] == <span class="number">44186</span>)</span><br><span class="line">solver.add(<span class="number">104</span> * flag[<span class="number">12</span>] + <span class="number">64</span> * flag[<span class="number">13</span>] + <span class="number">95</span> * flag[<span class="number">14</span>] + <span class="number">45</span> * flag[<span class="number">15</span>] + <span class="number">117</span> * flag[<span class="number">16</span>] + <span class="number">95</span> * flag[<span class="number">17</span>] == <span class="number">44909</span>)</span><br><span class="line">solver.add(<span class="number">103</span> * flag[<span class="number">12</span>] + <span class="number">95</span> * flag[<span class="number">13</span>] + <span class="number">102</span> * flag[<span class="number">14</span>] + <span class="number">100</span> * flag[<span class="number">15</span>] + <span class="number">95</span> * flag[<span class="number">16</span>] + <span class="number">83</span> * flag[<span class="number">17</span>] == <span class="number">46490</span>)</span><br><span class="line">solver.add(<span class="number">97</span> * flag[<span class="number">12</span>] + <span class="number">70</span> * flag[<span class="number">13</span>] + <span class="number">108</span> * flag[<span class="number">14</span>] + <span class="number">111</span> * flag[<span class="number">15</span>] + <span class="number">107</span> * flag[<span class="number">16</span>] + <span class="number">77</span> * flag[<span class="number">17</span>] == <span class="number">46024</span>)</span><br><span class="line">solver.add(<span class="number">109</span> * flag[<span class="number">12</span>] + <span class="number">65</span> * flag[<span class="number">13</span>] + <span class="number">97</span> * flag[<span class="number">14</span>] + <span class="number">95</span> * flag[<span class="number">15</span>] + <span class="number">111</span> * flag[<span class="number">16</span>] + <span class="number">67</span> * flag[<span class="number">17</span>] == <span class="number">44347</span>)</span><br><span class="line">solver.add(<span class="number">101</span> * flag[<span class="number">12</span>] + <span class="number">75</span> * flag[<span class="number">13</span>] + <span class="number">103</span> * flag[<span class="number">14</span>] + <span class="number">89</span> * flag[<span class="number">15</span>] + <span class="number">110</span> * flag[<span class="number">16</span>] + <span class="number">63</span> * flag[<span class="number">17</span>] == <span class="number">43850</span>)</span><br><span class="line">solver.add(<span class="number">123</span> * flag[<span class="number">12</span>] + <span class="number">69</span> * flag[<span class="number">13</span>] + <span class="number">33</span> * flag[<span class="number">14</span>] + <span class="number">48</span> * flag[<span class="number">15</span>] + <span class="number">119</span> * flag[<span class="number">16</span>] + <span class="number">125</span> * flag[<span class="number">17</span>] == <span class="number">44368</span>)</span><br><span class="line">solver.add(<span class="number">104</span> * flag[<span class="number">18</span>] + <span class="number">64</span> * flag[<span class="number">19</span>] + <span class="number">95</span> * flag[<span class="number">20</span>] + <span class="number">45</span> * flag[<span class="number">21</span>] + <span class="number">117</span> * flag[<span class="number">22</span>] + <span class="number">95</span> * flag[<span class="number">23</span>] == <span class="number">54990</span>)</span><br><span class="line">solver.add(<span class="number">103</span> * flag[<span class="number">18</span>] + <span class="number">95</span> * flag[<span class="number">19</span>] + <span class="number">102</span> * flag[<span class="number">20</span>] + <span class="number">100</span> * flag[<span class="number">21</span>] + <span class="number">95</span> * flag[<span class="number">22</span>] + <span class="number">83</span> * flag[<span class="number">23</span>] == <span class="number">61884</span>)</span><br><span class="line">solver.add(<span class="number">97</span> * flag[<span class="number">18</span>] + <span class="number">70</span> * flag[<span class="number">19</span>] + <span class="number">108</span> * flag[<span class="number">20</span>] + <span class="number">111</span> * flag[<span class="number">21</span>] + <span class="number">107</span> * flag[<span class="number">22</span>] + <span class="number">77</span> * flag[<span class="number">23</span>] == <span class="number">61202</span>)</span><br><span class="line">solver.add(<span class="number">109</span> * flag[<span class="number">18</span>] + <span class="number">65</span> * flag[<span class="number">19</span>] + <span class="number">97</span> * flag[<span class="number">20</span>] + <span class="number">95</span> * flag[<span class="number">21</span>] + <span class="number">111</span> * flag[<span class="number">22</span>] + <span class="number">67</span> * flag[<span class="number">23</span>] == <span class="number">58139</span>)</span><br><span class="line">solver.add(<span class="number">101</span> * flag[<span class="number">18</span>] + <span class="number">75</span> * flag[<span class="number">19</span>] + <span class="number">103</span> * flag[<span class="number">20</span>] + <span class="number">89</span> * flag[<span class="number">21</span>] + <span class="number">110</span> * flag[<span class="number">22</span>] + <span class="number">63</span> * flag[<span class="number">23</span>] == <span class="number">57730</span>)</span><br><span class="line">solver.add(<span class="number">123</span> * flag[<span class="number">18</span>] + <span class="number">69</span> * flag[<span class="number">19</span>] + <span class="number">33</span> * flag[<span class="number">20</span>] + <span class="number">48</span> * flag[<span class="number">21</span>] + <span class="number">119</span> * flag[<span class="number">22</span>] + <span class="number">125</span> * flag[<span class="number">23</span>] == <span class="number">54964</span>)</span><br><span class="line">solver.add(<span class="number">104</span> * flag[<span class="number">24</span>] + <span class="number">64</span> * flag[<span class="number">25</span>] + <span class="number">95</span> * flag[<span class="number">26</span>] + <span class="number">45</span> * flag[<span class="number">27</span>] + <span class="number">117</span> * flag[<span class="number">28</span>] + <span class="number">95</span> * flag[<span class="number">29</span>] == <span class="number">48849</span>)</span><br><span class="line">solver.add(<span class="number">103</span> * flag[<span class="number">24</span>] + <span class="number">95</span> * flag[<span class="number">25</span>] + <span class="number">102</span> * flag[<span class="number">26</span>] + <span class="number">100</span> * flag[<span class="number">27</span>] + <span class="number">95</span> * flag[<span class="number">28</span>] + <span class="number">83</span> * flag[<span class="number">29</span>] == <span class="number">51026</span>)</span><br><span class="line">solver.add(<span class="number">97</span> * flag[<span class="number">24</span>] + <span class="number">70</span> * flag[<span class="number">25</span>] + <span class="number">108</span> * flag[<span class="number">26</span>] + <span class="number">111</span> * flag[<span class="number">27</span>] + <span class="number">107</span> * flag[<span class="number">28</span>] + <span class="number">77</span> * flag[<span class="number">29</span>] == <span class="number">49629</span>)</span><br><span class="line">solver.add(<span class="number">109</span> * flag[<span class="number">24</span>] + <span class="number">65</span> * flag[<span class="number">25</span>] + <span class="number">97</span> * flag[<span class="number">26</span>] + <span class="number">95</span> * flag[<span class="number">27</span>] + <span class="number">111</span> * flag[<span class="number">28</span>] + <span class="number">67</span> * flag[<span class="number">29</span>] == <span class="number">48219</span>)</span><br><span class="line">solver.add(<span class="number">101</span> * flag[<span class="number">24</span>] + <span class="number">75</span> * flag[<span class="number">25</span>] + <span class="number">103</span> * flag[<span class="number">26</span>] + <span class="number">89</span> * flag[<span class="number">27</span>] + <span class="number">110</span> * flag[<span class="number">28</span>] + <span class="number">63</span> * flag[<span class="number">29</span>] == <span class="number">47904</span>)</span><br><span class="line">solver.add(<span class="number">123</span> * flag[<span class="number">24</span>] + <span class="number">69</span> * flag[<span class="number">25</span>] + <span class="number">33</span> * flag[<span class="number">26</span>] + <span class="number">48</span> * flag[<span class="number">27</span>] + <span class="number">119</span> * flag[<span class="number">28</span>] + <span class="number">125</span> * flag[<span class="number">29</span>] == <span class="number">50823</span>)</span><br><span class="line">solver.add(<span class="number">104</span> * flag[<span class="number">30</span>] + <span class="number">64</span> * flag[<span class="number">31</span>] + <span class="number">95</span> * flag[<span class="number">32</span>] + <span class="number">45</span> * flag[<span class="number">33</span>] + <span class="number">117</span> * flag[<span class="number">34</span>] + <span class="number">95</span> * flag[<span class="number">35</span>] == <span class="number">46596</span>)</span><br><span class="line">solver.add(<span class="number">103</span> * flag[<span class="number">30</span>] + <span class="number">95</span> * flag[<span class="number">31</span>] + <span class="number">102</span> * flag[<span class="number">32</span>] + <span class="number">100</span> * flag[<span class="number">33</span>] + <span class="number">95</span> * flag[<span class="number">34</span>] + <span class="number">83</span> * flag[<span class="number">35</span>] == <span class="number">50517</span>)</span><br><span class="line">solver.add(<span class="number">97</span> * flag[<span class="number">30</span>] + <span class="number">70</span> * flag[<span class="number">31</span>] + <span class="number">108</span> * flag[<span class="number">32</span>] + <span class="number">111</span> * flag[<span class="number">33</span>] + <span class="number">107</span> * flag[<span class="number">34</span>] + <span class="number">77</span> * flag[<span class="number">35</span>] == <span class="number">48421</span>)</span><br><span class="line">solver.add(<span class="number">109</span> * flag[<span class="number">30</span>] + <span class="number">65</span> * flag[<span class="number">31</span>] + <span class="number">97</span> * flag[<span class="number">32</span>] + <span class="number">95</span> * flag[<span class="number">33</span>] + <span class="number">111</span> * flag[<span class="number">34</span>] + <span class="number">67</span> * flag[<span class="number">35</span>] == <span class="number">46143</span>)</span><br><span class="line">solver.add(<span class="number">101</span> * flag[<span class="number">30</span>] + <span class="number">75</span> * flag[<span class="number">31</span>] + <span class="number">103</span> * flag[<span class="number">32</span>] + <span class="number">89</span> * flag[<span class="number">33</span>] + <span class="number">110</span> * flag[<span class="number">34</span>] + <span class="number">63</span> * flag[<span class="number">35</span>] == <span class="number">46102</span>)</span><br><span class="line">solver.add(<span class="number">123</span> * flag[<span class="number">30</span>] + <span class="number">69</span> * flag[<span class="number">31</span>] + <span class="number">33</span> * flag[<span class="number">32</span>] + <span class="number">48</span> * flag[<span class="number">33</span>] + <span class="number">119</span> * flag[<span class="number">34</span>] + <span class="number">125</span> * flag[<span class="number">35</span>] == <span class="number">46744</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">	result = solver.model()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">chr</span>(result[flag[i]].as_long()), end = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># hgame&#123;E@sy_Se1f-Modifying_C0oodee33&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="helloRe3"><a href="#helloRe3" class="headerlink" title="helloRe3"></a>helloRe3</h4><blockquote>
<p>分值：350pts</p>
<p>描述：开发者留下了调试信息，会不会有用呢？ 试试DbgView。</p>
</blockquote>
<p>Alt +T 搜索 <code>input length</code>，来到 sub_1400C8BD0，0x1400C8CBF 处调用加密函数 sub_14008BC07 对输入序列进行加密，该函数是典型的 RC4，解题脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">res = <span class="string">&quot;63 80 04 F0 D3 D6 62 D0 D8 3C 76 C5 93 14 CF BC 3A 05 F4 6C&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">res = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> res]</span><br><span class="line">table = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x14</span>):</span><br><span class="line">	table.append(res[i] ^ <span class="number">0x15</span>)</span><br><span class="line"></span><br><span class="line">order = <span class="built_in">range</span>(<span class="number">21</span>, <span class="number">33</span>) + <span class="built_in">range</span>(<span class="number">37</span>, <span class="number">50</span>) + <span class="built_in">range</span>(<span class="number">54</span>, <span class="number">65</span>) + <span class="built_in">range</span>(<span class="number">66</span>, <span class="number">76</span>)</span><br><span class="line">char = <span class="string">r&quot;1234567890-+qwertyuiop&#123;&#125;|asdfghjkl;&#x27;zxcvbnm,./&quot;</span>.upper()</span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(order)):</span><br><span class="line">	dic[order[i]] = char[i]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">target = <span class="string">&quot;4D AF 27 AD E1 EC 6D DA F0 31 5E 9A 9E 29 FA BE 6B 08 C8 49&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x14</span>):</span><br><span class="line">	o = target[i] ^ table[i]</span><br><span class="line">	flag += dic[o]</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Misc-2"><a href="#Misc-2" class="headerlink" title="Misc"></a>Misc</h3><h4 id="A-R-K"><a href="#A-R-K" class="headerlink" title="A R K"></a>A R K</h4><blockquote>
<p>分值：250pts</p>
<p>描述：星藏点雪 月隐晦明 以夕为墨 泼雪作屏</p>
<p>hint：明日方舟是一款塔防游戏，可以将可部署单位放置在场地中。并且具有自律功能，可以记录部署的操作。翻译：没用 没用 出题人用可部署单位画了个东西 背景是白色的</p>
</blockquote>
<p>首先通过后面部分的 FTP 流量获得 CS 交互的 ssl.log，导入 wireshark 解密 TLS 流量：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/17.png" alt="hgame2021"></p>
<p>导出 http 对象，在 getBattleReplay json 文件中，battleReplay 的值为一长串 base64。解码后得到一个 zip，但是开头是 <code>50 4B 05 06</code>，改为 <code>50 4B 03 04</code>，解压得到文件 default_entry，其中记录了很多单位的 xy 坐标，使用脚本提取：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;default_entry&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	data = json.load(f)</span><br><span class="line">logs = data[<span class="string">&quot;journal&quot;</span>][<span class="string">&quot;logs&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;points.txt&quot;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> g:</span><br><span class="line">	<span class="keyword">for</span> log <span class="keyword">in</span> logs:</span><br><span class="line">		pos = log[<span class="string">&quot;pos&quot;</span>]</span><br><span class="line">		g.write(<span class="string">&quot;%s %s \n&quot;</span> % (pos[<span class="string">&quot;row&quot;</span>], pos[<span class="string">&quot;col&quot;</span>]))</span><br></pre></td></tr></table></figure>

<p>再用 gnuplot 绘制，得到一个二维码，扫码得到 flag <code>hgame&#123;Did_y0u_ge7_Dusk?&#125;</code></p>
<br>

<h4 id="A-R-C"><a href="#A-R-C" class="headerlink" title="A R C"></a>A R C</h4><blockquote>
<p>分值：350pts</p>
<p>描述：</p>
<p>​    Akira虽然不玩🐍，但有些东西成功引起了他的注意。</p>
<p>hint：</p>
<p>​    hint1: 8558应该理解成85和58，BV号是___所以图片里的是___<br>​    hint2: 用tables而不是table，是因为字体是用来对照图片里字符串的内容的算一个table，而这个字体表示的东西也是一个table。<strong>注意本字体的i和j，I(0x49)和l(0x6C)有点相似</strong><br>​    hint3: 用了某种ROT的范围，但是位移不一样。词频分析是个好东西，别忘了视频里的问题。<br>​    hint4: 有的东西可以参考Crypto WEEK-1 第一题。<br>​    hint5: / 不是可输入的意思，是网站路径</p>
</blockquote>
<p>8558.png 中的字符串摘取下来，base85 解码得到 BV 号编码的 table（BV 号基于 base58），从 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/381784377/answer/1099438784">知乎</a> 上找来 mcfx 大佬的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;BK0ICG]Qr*88_$gC,&#x27;-j2+KH86?Q\&quot;%928;LG@O*!Am0+`;E7iV2agSE&lt;c&#x27;U;6Yg^#H?!YBAQ]&quot;</span></span><br><span class="line">table = base64.a85decode(string).decode()</span><br><span class="line"></span><br><span class="line">tr=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">58</span>):</span><br><span class="line">	tr[table[i]]=i</span><br><span class="line">s=[<span class="number">11</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>]</span><br><span class="line">xor=<span class="number">177451812</span></span><br><span class="line">add=<span class="number">8728348608</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">x</span>):</span></span><br><span class="line">	r=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">		r+=tr[x[s[i]]]*<span class="number">58</span>**i</span><br><span class="line">	<span class="keyword">return</span> (r-add)^xor</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">x</span>):</span></span><br><span class="line">	x=(x^xor)+add</span><br><span class="line">	r=<span class="built_in">list</span>(<span class="string">&#x27;BV1  4 1 7  &#x27;</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">		r[s[i]]=table[x//<span class="number">58</span>**i%<span class="number">58</span>]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(r)</span><br><span class="line"><span class="built_in">print</span>(enc(<span class="number">10001540</span>))</span><br><span class="line"><span class="comment"># BV17f411J77h</span></span><br></pre></td></tr></table></figure>

<p>得到 7z 密码，解压得到一个视频和 Fragments.txt，视频中的问题百度一下得到答案 42，所以视频里的两行字符串应该与 rot42 有关。多次测试后，发现第一行分为前后两段，前半段 <code>#)+F7IIMEH:?I</code> 是 rot42，后半段 <code>njiikffi</code> 是 rot47，解密后拼接起来得到 <code>MSUpasswordis:6557225</code></p>
<p>使用 VirtualDub + MSU 插件（去年的题目也用到了这俩），从 mkv 中提取出一个 txt，得到一个网址和用户名密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arc.hgame2021.cf</span><br><span class="line">Hikari</span><br><span class="line">Tairitsu</span><br></pre></td></tr></table></figure>

<p>访问网址，输入用户名密码，页面中只有一个斜杠代表网站根路径：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/18.png" alt="hgame2021"></p>
<p>脚本处理 Fragments.txt 中的内容（也是 rot42 和 rot47）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">s1 = <span class="string">&quot;&quot;&quot;zB7= ?I DEJ &gt;;H;` 8KJ &#125; MH?J; ?J 8;97KI; OEK C7O D;;: CEH; MEH:I JE 7D7BOI?I M&gt;7J ;D9E:?D= J&gt;; B?D;e ?Ib</span></span><br><span class="line"><span class="string">zEH B?D;f` \&quot;?A? &gt;7I JEB: OEK M&gt;7J ?J ?I` 7D: uA?H7 ?I D;9;II7HO JE :E ?Jb</span></span><br><span class="line"><span class="string">*ME OEKD= =?HBI ;NFBEH; 7 I&gt;7JJ;H;: MEHB:` &lt;?BB;: M?J&gt; IEKD:n 7 F7IJ JE 8; KD9EL;H;:bbb</span></span><br><span class="line"><span class="string">y79&gt; 7M7A;DI ?D J&gt;?I 8B7DA` HK?Da:EJJ;: MEHB: JE :?I9EL;H J&gt;7J I&gt;; ?I ;GK7BBO 8B7DA` H;C;C8;H?D= DEJ&gt;?D= E&lt; M&gt;7J 97C; 8;&lt;EH;b</span></span><br><span class="line"><span class="string">uD: J&gt;;D J&gt;;O C7A; 7 I;9ED: :?I9EL;HOn J&gt;; uH97;7` CKBJ?JK:;I E&lt; &lt;BE7J?D= =B7IIaB?A; I&gt;7H:I 9EDJ7?D?D= L?L?: C;CEH?;I E&lt; J&gt;; F7IJb&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1)):</span><br><span class="line">	<span class="keyword">if</span> s1[i] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&#x27; \n&#x27;</span>:</span><br><span class="line">		<span class="keyword">if</span> s1[i] &gt;= <span class="string">&#x27;`&#x27;</span>:</span><br><span class="line">			tmp = <span class="built_in">ord</span>(s1[i]) - <span class="number">52</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			tmp = <span class="built_in">ord</span>(s1[i]) + <span class="number">42</span></span><br><span class="line">		s += <span class="built_in">chr</span>(tmp)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">if</span> s1[i] == <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">			s += <span class="string">&#x27; &#x27;</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			s += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flag is not here, but I write it because you may need more words to analysis what encoding the line1 is.</span><br><span class="line">For line2, Liki has told you what it is, and Akira is necessary to do it.</span><br><span class="line">Two young girls explore a shattered world, filled with sound: a past to be uncovered...</span><br><span class="line">Each awakens in this blank, ruin-dotted world to discover that she is equally blank, remembering nothing of what came before.</span><br><span class="line">And then they make a second discovery: the Arcaea, multitudes of floating glass-like shards containing vivid memories of the past.</span><br></pre></td></tr></table></figure>

<p>对于视频中第二行字符串，根据 hint，需要用到 Crypto WEEK-1 第一题用过的维吉尼亚密码，密文是 <code>pwbvmpoakiscqdobil</code> 密钥是 <code>Akira</code>，解密得到 <code>pmtempestissimobyd</code>，访问 <code>arc.hgame2021.cf/pmtempestissimobyd</code> 得到 flag：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/19.png" alt="hgame2021"></p>
<br>

<h4 id="accuracy"><a href="#accuracy" class="headerlink" title="accuracy"></a>accuracy</h4><blockquote>
<p>分值：350pts</p>
<p>描述：石碑上的文字,究竟隐藏着怎样的秘密……</p>
</blockquote>
<p>考的人工智能，需要训练一个模型来识别所有的图片然后提交字符串，官方说准确率到 95 就给 flag。我用 imageai 库训练了 10 个小时，得到的模型却并不理想，于是就放弃了。看官方 wp 别人手撸了神经网络，告辞！</p>
<br>

<h2 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h2><h3 id="Re-3"><a href="#Re-3" class="headerlink" title="Re"></a>Re</h3><h4 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h4><blockquote>
<p>分值：450pts</p>
<p>描述：ovm++ hates debugger</p>
</blockquote>
<p>类构造函数 sub_140001640 初始化虚拟机的指令和数据。构造函数 sub_140001610 调用 sub_14000128F 将进程加入一个 Job 中（可以理解为沙箱），防止调试器附加（不过如果是调试启动的话就没有影响了）</p>
<p>查字符串 <code>Welcome to ovm++!</code> 的交叉引用来到 main 函数，流程比较简单：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/20.png" alt="hgame2021"></p>
<p>run_vm 函数就在运行虚拟机改变输入了，但是我不想去理解这个虚拟机的操作了。在动调的时候发现 case22 每次只修改输入的一个字符，而且运算结果与其他位置的字符无关，所以就写了个 ida python 脚本来爆破 flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">charset = string.printable</span><br><span class="line"><span class="comment"># Initialize flag as &quot;hgame&#123;&#x27;a&#x27;*27&#125;&quot;</span></span><br><span class="line">flag = [<span class="number">104</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">123</span>] + [<span class="number">0x61</span>] * <span class="number">27</span> + [<span class="number">125</span>]</span><br><span class="line"><span class="comment"># Here&#x27;s the target array picked from IDA</span></span><br><span class="line">target = <span class="string">&quot;CF BF 80 3B F6 AF 7E 02 24 ED 70 3A F4 EB 7A 4A E7 F7 A2 67 17 F0 C6 76 36 E8 AD 82 2E DB B7 4F E6 09&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line"></span><br><span class="line">image_base = <span class="number">0x7FF62DD90000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">5</span>, -<span class="number">1</span>):</span><br><span class="line">	isFound = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(charset)):</span><br><span class="line">		<span class="comment"># run_vm(): ret</span></span><br><span class="line">		RunTo(image_base + <span class="number">0x3FC4</span>)</span><br><span class="line">		GetDebuggerEvent(WFNE_SUSP, -<span class="number">1</span>)</span><br><span class="line">		input_addr = Qword(image_base + <span class="number">0xE3A0</span>)</span><br><span class="line">		bs = get_bytes(input_addr, <span class="number">34</span>)</span><br><span class="line">		<span class="comment"># Check last trial</span></span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">ord</span>(bs[i]) == target[i]:</span><br><span class="line">			<span class="keyword">if</span> j == <span class="number">0</span>:</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&quot;Found [%d]: %s&quot;</span> % (i, charset[j]))</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&quot;Found [%d]: %s&quot;</span> % (i, charset[j - <span class="number">1</span>]))</span><br><span class="line">			isFound = <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">not</span> isFound:</span><br><span class="line">			<span class="comment"># Assign and patch input for next trial</span></span><br><span class="line">			flag[i] = <span class="built_in">ord</span>(charset[j])</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>):</span><br><span class="line">				PatchByte(input_addr + k, flag[k])</span><br><span class="line">		<span class="comment"># Reset regs</span></span><br><span class="line">		PatchByte(image_base + <span class="number">0xE3A8</span>, <span class="number">0</span>)</span><br><span class="line">		PatchByte(image_base + <span class="number">0xE3AD</span>, <span class="number">0</span>)</span><br><span class="line">		PatchDword(image_base + <span class="number">0xE3A9</span>, <span class="number">0</span>)</span><br><span class="line">		<span class="comment"># Set function param</span></span><br><span class="line">		SetRegValue(image_base + <span class="number">0xE378</span>, <span class="string">&quot;rcx&quot;</span>)</span><br><span class="line">		SetRegValue(input_addr, <span class="string">&quot;rdx&quot;</span>)</span><br><span class="line">		<span class="comment"># Redo</span></span><br><span class="line">		SetRegValue(image_base + <span class="number">0x3CC0</span>, <span class="string">&quot;rip&quot;</span>)</span><br><span class="line">		<span class="comment"># If current char is found, still need to do things above</span></span><br><span class="line">		<span class="keyword">if</span> isFound:</span><br><span class="line">			<span class="comment"># So we can only &#x27;break&#x27; at here</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, flag))</span><br></pre></td></tr></table></figure>

<p>在 ida7.0 中设置好 Local Windows debugger，运行脚本就能爆出 flag 了：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/21.png" alt="hgame2021"></p>
<br>

<h4 id="A-5-Second-Challenge"><a href="#A-5-Second-Challenge" class="headerlink" title="A 5 Second Challenge"></a>A 5 Second Challenge</h4><blockquote>
<p>分值：400pts</p>
<p>描述：</p>
<p>​    oops! 我不小心把一些不该泄露的文件也打包进去了，不过还好，有个 dll 被我提前动过了手脚，别想通过 ILSpy 一把梭了~！</p>
<p>hint：</p>
<p>​    hint 1: 这个扫雷甚至没做胜利判定，雷的位置就是 flag，多踩几局雷就能发现是二维码了 囧 </p>
<p>​    hint 2: il2cpp 中间文件（源码）已经直接给了，就不太需要用 il2cppdumper 这类工具去死怼 GameAssembly.dll 了 囧<br>​    hint 3: 动的手脚只是把某个函数 nop 掉了，那个 dll 还是有用的<br>（除非你想从内存里把 matrix 动调出来</p>
</blockquote>
<p>il2cpp 打包的 unity 游戏，用 IL2cppDumper 去怼 GameAssembly.dll。ida 加载 IL2cppDumper 的脚本，找到一个有意思的方法 <code>Brick::OnMouseUp</code>，这个方法就是在方块上抬起鼠标左键会调用的回调函数。函数会检查是否超时：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/22.png" alt="hgame2021"></p>
<p>那就把它 nop 掉：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/23.png" alt="hgame2021"></p>
<p>然后检查这个方块有没有雷，有雷就把游戏结束标志置为 1：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/24.png" alt="hgame2021"></p>
<p>所以把 <code>isOver = 1</code> patch 成 0，让我们就算踩了雷也不会结束：<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/25.png" alt="hgame2021"></p>
<p>为了正确运行，还需要 patch <code>BombChecker::CheckBombAt</code>：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/26.png" alt="hgame2021"></p>
<p>然后应用一下 patch，打开游戏把雷块都点开：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/27.png" alt="hgame2021"></p>
<p>像不像一个二维码……然后👴是龙鸣，👴 <a target="_blank" rel="noopener" href="https://merricx.github.io/qrazybox/">手点</a> 了一个 45*45 的二维码：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/hgame2021/28.png" alt="hgame2021"></p>
<p>扫码得到 flag <code>hgame&#123;YOU~hEn-duO_yOU-X|~DOU-sHi~un1Ty~k4i-fA_de_O&#125;</code></p>
<br>

<h4 id="nllvm"><a href="#nllvm" class="headerlink" title="nllvm"></a>nllvm</h4><blockquote>
<p>分值：350pts</p>
<p>描述：cosmos掉入了异世界中，帮助cosmos回到现实……</p>
</blockquote>
<p>main 函数是 sub_1400105F0，其他没啥好说的，动调跟一下就能知道程序逻辑了，加密函数也不难（其实就是 AES，这里闲的没事我选择手撸），用 python 翻译加密函数就是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line">const_key = <span class="string">&quot;43 72 79 70 74 6F 46 41 49 4C 55 52 45 66 6F 72 52 53 41 32 30 34 38 4B 65 79 21 21 21 21 21 21 BF 8F 84 8D CB E0 C2 CC 82 AC 97 9E C7 CA F8 EC 94 27 00 FC A4 13 38 B7 C1 6A 19 96 E0 4B 38 B7 0E 88 2D 6C C5 68 EF A0 47 C4 78 3E 80 0E 80 D2 59 8C CD 49 FD 9F F5 FE 3C F5 EC 68 DC BE D4 DF A4 C0 B3 EA 61 A8 5C 4A 26 6C 24 74 A6 62 A4 A6 7D 26 84 6D 80 B9 71 93 BC 4C 9D FB 60 F2 49 24 25 FB 85 3A 44 53 D9 70 62 3F FD 04 C4 5D 59 A2 61 6A 4F 57 E1 D3 3E C4 5D 9F A3 3F 3D 6D EA 1B 09 7C 2A 1D 4D 2F F3 6D 2F 10 0E 69 EB 4D 57 CB 88 89 14 48 69 5A 2A 8C 34 C5 89 B3 09 A8 63 A8 EB 87 E8 1C A6 A8 1B 71 89 B8 15 18 62 F5 42 D3 22 6F 38 2E 4B 35 12 A2 7F F0 9B 11 76 58 F8 B9 C1 C6 BE 24 67 6E A5 55 EE D6 B0 4D 8C 23 F2 9E&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">const_key = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> const_key]</span><br><span class="line">table = <span class="string">&quot;63 7C 77 7B F2 6B 6F C5 30 01 67 2B FE D7 AB 76 CA 82 C9 7D FA 59 47 F0 AD D4 A2 AF 9C A4 72 C0 B7 FD 93 26 36 3F F7 CC 34 A5 E5 F1 71 D8 31 15 04 C7 23 C3 18 96 05 9A 07 12 80 E2 EB 27 B2 75 09 83 2C 1A 1B 6E 5A A0 52 3B D6 B3 29 E3 2F 84 53 D1 00 ED 20 FC B1 5B 6A CB BE 39 4A 4C 58 CF D0 EF AA FB 43 4D 33 85 45 F9 02 7F 50 3C 9F A8 51 A3 40 8F 92 9D 38 F5 BC B6 DA 21 10 FF F3 D2 CD 0C 13 EC 5F 97 44 17 C4 A7 7E 3D 64 5D 19 73 60 81 4F DC 22 2A 90 88 46 EE B8 14 DE 5E 0B DB E0 32 3A 0A 49 06 24 5C C2 D3 AC 62 91 95 E4 79 E7 C8 37 6D 8D D5 4E A9 6C 56 F4 EA 65 7A AE 08 BA 78 25 2E 1C A6 B4 C6 E8 DD 74 1F 4B BD 8B 8A 70 3E B5 66 48 03 F6 0E 61 35 57 B9 86 C1 1D 9E E1 F8 98 11 69 D9 8E 94 9B 1E 87 E9 CE 55 28 DF 8C A1 89 0D BF E6 42 68 41 99 2D 0F B0 54 BB 16&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">table = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> table]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">n, a, b</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">			a[<span class="number">4</span>*i+j] ^= b[<span class="number">16</span>*n+<span class="number">4</span>*i+j]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_table</span>(<span class="params">a</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">			idx = a[<span class="number">4</span>*j+i]</span><br><span class="line">			a[<span class="number">4</span>*j+i] = table[idx]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swap</span>(<span class="params">a</span>):</span></span><br><span class="line">	a[<span class="number">1</span>], a[<span class="number">5</span>], a[<span class="number">9</span>], a[<span class="number">13</span>] = a[<span class="number">5</span>], a[<span class="number">9</span>], a[<span class="number">13</span>], a[<span class="number">1</span>]</span><br><span class="line">	a[<span class="number">2</span>], a[<span class="number">10</span>] = a[<span class="number">10</span>], a[<span class="number">2</span>]</span><br><span class="line">	a[<span class="number">6</span>], a[<span class="number">14</span>] = a[<span class="number">14</span>], a[<span class="number">6</span>]</span><br><span class="line">	a[<span class="number">3</span>], a[<span class="number">15</span>], a[<span class="number">11</span>], a[<span class="number">7</span>] = a[<span class="number">15</span>], a[<span class="number">11</span>], a[<span class="number">7</span>], a[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">func = <span class="keyword">lambda</span> a : ((<span class="number">27</span> * ((a &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>)) ^ (<span class="number">2</span> * a)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deal</span>(<span class="params">a</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		t1 = a[<span class="number">4</span>*i]</span><br><span class="line">		t2 = a[<span class="number">4</span>*i+<span class="number">3</span>] ^ a[<span class="number">4</span>*i+<span class="number">2</span>] ^ a[<span class="number">4</span>*i+<span class="number">1</span>] ^ t1</span><br><span class="line">		a[<span class="number">4</span>*i] = t2 ^ func(a[<span class="number">4</span>*i+<span class="number">1</span>] ^ t1) ^ t1</span><br><span class="line">		a[<span class="number">4</span>*i+<span class="number">1</span>] ^= t2 ^ func(a[<span class="number">4</span>*i+<span class="number">2</span>] ^ a[<span class="number">4</span>*i+<span class="number">1</span>])</span><br><span class="line">		a[<span class="number">4</span>*i+<span class="number">2</span>] ^= t2 ^ func(a[<span class="number">4</span>*i+<span class="number">3</span>] ^ a[<span class="number">4</span>*i+<span class="number">2</span>])</span><br><span class="line">		a[<span class="number">4</span>*i+<span class="number">3</span>] ^= t2 ^ func(t1 ^ a[<span class="number">4</span>*i+<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">plain</span>):</span></span><br><span class="line">	plain = <span class="built_in">map</span>(<span class="built_in">ord</span>, plain)</span><br><span class="line">	v4 = <span class="built_in">range</span>(<span class="number">16</span>)</span><br><span class="line">	cipher = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>, <span class="number">16</span>):</span><br><span class="line">		inp = plain[i:]</span><br><span class="line">		xor(<span class="number">0</span>, inp, v4)</span><br><span class="line">		xor(<span class="number">0</span>, inp, const_key)</span><br><span class="line">		j = <span class="number">1</span></span><br><span class="line">		<span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">			find_table(inp)</span><br><span class="line">			swap(inp)</span><br><span class="line">			<span class="keyword">if</span> j == <span class="number">14</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			deal(inp)</span><br><span class="line">			xor(j, inp, const_key)</span><br><span class="line">			j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">		xor(<span class="number">0xE</span>, inp, const_key)</span><br><span class="line">		v4 = inp[:<span class="number">16</span>]</span><br><span class="line">		cipher += v4</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">map</span>(<span class="built_in">hex</span>, cipher)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> encrypt(<span class="string">&#x27;a&#x27;</span> * <span class="number">64</span>)</span><br></pre></td></tr></table></figure>

<p>所以对应写个解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;91 B3 C1 EB 14 5D D5 CE 3A 1D 30 E4 70 6C 6B D7 69 78 79 02 A3 A5 DF 1B FD 1C 02 89 14 20 7A FD 24 52 F8 A9 F9 F1 6B 1C 0F 5D 50 5B EC 42 D1 8C B8 12 CF 2C A9 69 31 46 FD 9B EA DE C8 BF 94 69&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line">const_key = <span class="string">&quot;43 72 79 70 74 6F 46 41 49 4C 55 52 45 66 6F 72 52 53 41 32 30 34 38 4B 65 79 21 21 21 21 21 21 BF 8F 84 8D CB E0 C2 CC 82 AC 97 9E C7 CA F8 EC 94 27 00 FC A4 13 38 B7 C1 6A 19 96 E0 4B 38 B7 0E 88 2D 6C C5 68 EF A0 47 C4 78 3E 80 0E 80 D2 59 8C CD 49 FD 9F F5 FE 3C F5 EC 68 DC BE D4 DF A4 C0 B3 EA 61 A8 5C 4A 26 6C 24 74 A6 62 A4 A6 7D 26 84 6D 80 B9 71 93 BC 4C 9D FB 60 F2 49 24 25 FB 85 3A 44 53 D9 70 62 3F FD 04 C4 5D 59 A2 61 6A 4F 57 E1 D3 3E C4 5D 9F A3 3F 3D 6D EA 1B 09 7C 2A 1D 4D 2F F3 6D 2F 10 0E 69 EB 4D 57 CB 88 89 14 48 69 5A 2A 8C 34 C5 89 B3 09 A8 63 A8 EB 87 E8 1C A6 A8 1B 71 89 B8 15 18 62 F5 42 D3 22 6F 38 2E 4B 35 12 A2 7F F0 9B 11 76 58 F8 B9 C1 C6 BE 24 67 6E A5 55 EE D6 B0 4D 8C 23 F2 9E&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">const_key = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> const_key]</span><br><span class="line">table = <span class="string">&quot;63 7C 77 7B F2 6B 6F C5 30 01 67 2B FE D7 AB 76 CA 82 C9 7D FA 59 47 F0 AD D4 A2 AF 9C A4 72 C0 B7 FD 93 26 36 3F F7 CC 34 A5 E5 F1 71 D8 31 15 04 C7 23 C3 18 96 05 9A 07 12 80 E2 EB 27 B2 75 09 83 2C 1A 1B 6E 5A A0 52 3B D6 B3 29 E3 2F 84 53 D1 00 ED 20 FC B1 5B 6A CB BE 39 4A 4C 58 CF D0 EF AA FB 43 4D 33 85 45 F9 02 7F 50 3C 9F A8 51 A3 40 8F 92 9D 38 F5 BC B6 DA 21 10 FF F3 D2 CD 0C 13 EC 5F 97 44 17 C4 A7 7E 3D 64 5D 19 73 60 81 4F DC 22 2A 90 88 46 EE B8 14 DE 5E 0B DB E0 32 3A 0A 49 06 24 5C C2 D3 AC 62 91 95 E4 79 E7 C8 37 6D 8D D5 4E A9 6C 56 F4 EA 65 7A AE 08 BA 78 25 2E 1C A6 B4 C6 E8 DD 74 1F 4B BD 8B 8A 70 3E B5 66 48 03 F6 0E 61 35 57 B9 86 C1 1D 9E E1 F8 98 11 69 D9 8E 94 9B 1E 87 E9 CE 55 28 DF 8C A1 89 0D BF E6 42 68 41 99 2D 0F B0 54 BB 16&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">table = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> table]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">n, a, b</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">			a[<span class="number">4</span>*i+j] ^= b[<span class="number">16</span>*n+<span class="number">4</span>*i+j]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d_swap</span>(<span class="params">a</span>):</span></span><br><span class="line">	a[<span class="number">5</span>], a[<span class="number">9</span>], a[<span class="number">13</span>], a[<span class="number">1</span>] = a[<span class="number">1</span>], a[<span class="number">5</span>], a[<span class="number">9</span>], a[<span class="number">13</span>]</span><br><span class="line">	a[<span class="number">2</span>], a[<span class="number">10</span>] = a[<span class="number">10</span>], a[<span class="number">2</span>]</span><br><span class="line">	a[<span class="number">6</span>], a[<span class="number">14</span>] = a[<span class="number">14</span>], a[<span class="number">6</span>]</span><br><span class="line">	a[<span class="number">15</span>], a[<span class="number">11</span>], a[<span class="number">7</span>], a[<span class="number">3</span>] = a[<span class="number">3</span>], a[<span class="number">15</span>], a[<span class="number">11</span>], a[<span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d_find_table</span>(<span class="params">a</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">			idx = table.index(a[<span class="number">4</span>*j+i])</span><br><span class="line">			a[<span class="number">4</span>*j+i] = idx</span><br><span class="line"></span><br><span class="line">func = <span class="keyword">lambda</span> a : ((<span class="number">27</span> * ((a &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>)) ^ (<span class="number">2</span> * a)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">x</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">		<span class="keyword">if</span> i ^ func(i) == x:</span><br><span class="line">			<span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_f</span>(<span class="params">x</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">		<span class="keyword">if</span> func(i) == x:</span><br><span class="line">			<span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">re</span>(<span class="params">x</span>):</span></span><br><span class="line">	t01 = x[<span class="number">0</span>] ^ x[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">		eq = t01 ^ func(i)</span><br><span class="line">		old01 = solve(eq)</span><br><span class="line">		old02 = old01 ^ i</span><br><span class="line">		t02 = x[<span class="number">0</span>] ^ x[<span class="number">2</span>]</span><br><span class="line">		old23 = solve_f(t02 ^ old02 ^ func(old01))</span><br><span class="line">		old03 = old02 ^ old23</span><br><span class="line">		a2 = x[<span class="number">3</span>] ^ func(old03) ^ old01</span><br><span class="line">		a3 = old23 ^ a2</span><br><span class="line">		a0 = old02 ^ a2</span><br><span class="line">		a1 = old01 ^ a0</span><br><span class="line">		<span class="keyword">if</span>(x[<span class="number">0</span>] == a1 ^ a2 ^ a3 ^ func(a0 ^ a1)</span><br><span class="line">			<span class="keyword">and</span> x[<span class="number">1</span>] == a0 ^ a2 ^ a3 ^ func(a2 ^ a1)</span><br><span class="line">			<span class="keyword">and</span> x[<span class="number">2</span>] == a1 ^ a0 ^ a3 ^ func(a2 ^ a3)</span><br><span class="line">			<span class="keyword">and</span> x[<span class="number">3</span>] == a1 ^ a2 ^ a0 ^ func(a3 ^ a0)):</span><br><span class="line">			<span class="keyword">return</span> [a0, a1, a2, a3]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d_deal</span>(<span class="params">a</span>):</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		ori = re(a[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)])</span><br><span class="line">		a[<span class="number">4</span>*i] = ori[<span class="number">0</span>]</span><br><span class="line">		a[<span class="number">4</span>*i+<span class="number">1</span>] = ori[<span class="number">1</span>]</span><br><span class="line">		a[<span class="number">4</span>*i+<span class="number">2</span>] = ori[<span class="number">2</span>]</span><br><span class="line">		a[<span class="number">4</span>*i+<span class="number">3</span>] = ori[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">cipher</span>):</span></span><br><span class="line">	plain = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, -<span class="number">1</span>, -<span class="number">16</span>):</span><br><span class="line">		inp = cipher[i:i+<span class="number">16</span>]</span><br><span class="line">		<span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">			v4 = <span class="built_in">range</span>(<span class="number">16</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			v4 = cipher[i-<span class="number">16</span>:i]</span><br><span class="line">		xor(<span class="number">0xE</span>, inp, const_key)</span><br><span class="line"></span><br><span class="line">		d_swap(inp)</span><br><span class="line">		d_find_table(inp)</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">			xor(j, inp, const_key)</span><br><span class="line">			d_deal(inp)</span><br><span class="line">			d_swap(inp)</span><br><span class="line">			d_find_table(inp)</span><br><span class="line">		xor(<span class="number">0</span>, inp, const_key)</span><br><span class="line">		xor(<span class="number">0</span>, inp, v4)</span><br><span class="line">		plain = inp + plain</span><br><span class="line">	<span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line">flag = decrypt(target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, flag)))</span><br><span class="line"><span class="comment"># hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;</span></span><br></pre></td></tr></table></figure>

<p>直接用 AES 库的话：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">text</span>):</span></span><br><span class="line">	key = <span class="string">b&quot;CryptoFAILUREforRSA2048Key!!!!!!&quot;</span></span><br><span class="line">	iv = <span class="string">b&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f&quot;</span></span><br><span class="line"></span><br><span class="line">	mode = AES.MODE_CBC</span><br><span class="line">	cryptor = AES.new(key, mode, iv)</span><br><span class="line">	plain_text = cryptor.decrypt(a2b_hex(text))</span><br><span class="line">	<span class="keyword">return</span> plain_text.decode()</span><br><span class="line"></span><br><span class="line">raw = <span class="string">&quot;91 B3 C1 EB 14 5D D5 CE 3A 1D 30 E4 70 6C 6B D7 69 78 79 02 A3 A5 DF 1B FD 1C 02 89 14 20 7A FD 24 52 F8 A9 F9 F1 6B 1C 0F 5D 50 5B EC 42 D1 8C B8 12 CF 2C A9 69 31 46 FD 9B EA DE C8 BF 94 69&quot;</span></span><br><span class="line">target = raw.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(decrypt(target))</span><br><span class="line"><span class="comment"># hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="Misc-3"><a href="#Misc-3" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Akira之瞳-1"><a href="#Akira之瞳-1" class="headerlink" title="Akira之瞳-1"></a>Akira之瞳-1</h4><blockquote>
<p>分值：350pts</p>
<p>描述：有人想问 Akira 为什么总喜欢用眼睛当头像，Akira 说：“我给你讲个故事吧，从前有一天一位原画师在上班，不幸的是突然起了火灾，情急之下 IT 部门把她没保存的工作 dump 了下来并传到了网上 …… ”</p>
</blockquote>
<p><code>volatility -f important_work.raw imageinfo</code>，选择 <code>Win7SP1x64</code> 作为 profile 参数</p>
<p><code>volatility -f important_work.raw --profile=Win7SP1x64 pslist</code>，得知 important_work 进程的 pid 为 1092</p>
<p><code>volatility -f important_work.raw --profile=Win7SP1x64 memdump -p 1092 -D .</code>，得到 1092.dmp</p>
<p><code>foremost 1092.dmp</code>，得到压缩包 <code>00002256.zip</code>，压缩包备注里提示 <code>Password is sha256(login_password)</code></p>
<p>获取压缩包密码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~<span class="comment"># volatility -f important_work.raw --profile=Win7SP1x64 hashdump</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Genga03:1001:aad3b435b51404eeaad3b435b51404ee:84b0d9c9f830238933e7131d60ac6436:::</span><br></pre></td></tr></table></figure>

<p>拿 <code>84b0d9c9f830238933e7131d60ac6436</code> 去 cmd5 查，得到密码 asdqwe123，sha256 一下得到压缩包密码</p>
<p>压缩包里两张一样的图，很明显的盲水印，用 <a target="_blank" rel="noopener" href="https://github.com/chishaxie/BlindWaterMark">github</a> 的脚本解一下得到含有 flag 的图片（需要放大仔细看），<code>hgame&#123;7he_f1ame_brin9s_me_end1ess_9rief&#125;</code></p>
<br>

<h4 id="Akira之瞳-2"><a href="#Akira之瞳-2" class="headerlink" title="Akira之瞳-2"></a>Akira之瞳-2</h4><blockquote>
<p>分值：400pts</p>
<p>描述：</p>
<p>​    ……<br>​    “最后呢？”<br>​    “最后她还是没能幸免，人们在保险箱旁发现了她烧焦的尸体，打开保险箱人们发现了一个U盘，是她将回家画好的原稿带来时用的 ……”</p>
</blockquote>
<p>👴懒得做了，和第二名差的分一道题补不回来，寄！</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">in1t</a></span></div><div class="post-cover__authorid"><span class="post-copyright-meta">封面画师: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://www.pixiv.net/users/17810">17810</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://in1t.top/2021/02/27/HGAME2021-Re-Misc-wp/">https://in1t.top/2021/02/27/HGAME2021-Re-Misc-wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://in1t.top" target="_blank">in1t's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91/">逆向</a><a class="post-meta__tags" href="/tags/Misc/">Misc</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/hgame2021.jpg" data-sites="wechat,qq,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/03/13/%E7%AC%AC%E4%B8%80%E6%AC%A1malloc%E9%83%BD%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/malloc.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">第一次malloc都发生了什么？</div></div></a></div><div class="next-post pull-right"><a href="/2021/02/03/buuoj-%E9%80%86%E5%90%91%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%EF%BC%89/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/buuojre3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">buuoj 逆向刷题之旅（三）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/07/19/CISCN2021参赛纪行/" title="CISCN2021参赛纪行"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/ciscn2021.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-19</div><div class="title">CISCN2021参赛纪行</div></div></a></div><div><a href="/2020/03/18/Source-Insight-3破解/" title="Source Insight 3破解"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/sourceinsight.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-18</div><div class="title">Source Insight 3破解</div></div></a></div><div><a href="/2020/03/08/分析winxp扫雷游戏/" title="分析winxp扫雷游戏"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/minesweeper.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-08</div><div class="title">分析winxp扫雷游戏</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1"><span class="toc-number">1.</span> <span class="toc-text">Week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Re"><span class="toc-number">1.1.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#apacha"><span class="toc-number">1.1.1.</span> <span class="toc-text">apacha</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#helloRe"><span class="toc-number">1.1.2.</span> <span class="toc-text">helloRe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pypy"><span class="toc-number">1.1.3.</span> <span class="toc-text">pypy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc"><span class="toc-number">1.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Base%E5%85%A8%E5%AE%B6%E7%A6%8F"><span class="toc-number">1.2.1.</span> <span class="toc-text">Base全家福</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E8%B5%B7%E7%9C%BC%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%9A%84%E5%85%BB%E6%88%90%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">不起眼压缩包的养成的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Galaxy"><span class="toc-number">1.2.3.</span> <span class="toc-text">Galaxy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Word-RE-MASTER"><span class="toc-number">1.2.4.</span> <span class="toc-text">Word RE:MASTER</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2"><span class="toc-number">2.</span> <span class="toc-text">Week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Re-1"><span class="toc-number">2.1.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ezApk"><span class="toc-number">2.1.1.</span> <span class="toc-text">ezApk</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#helloRe2"><span class="toc-number">2.1.2.</span> <span class="toc-text">helloRe2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fake-debugger-beta"><span class="toc-number">2.1.3.</span> <span class="toc-text">fake_debugger beta</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-1"><span class="toc-number">2.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tools"><span class="toc-number">2.2.1.</span> <span class="toc-text">Tools</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Telegraph%EF%BC%9A1601-6639-3459-3134-0892"><span class="toc-number">2.2.2.</span> <span class="toc-text">Telegraph：1601 6639 3459 3134 0892</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hallucigenia"><span class="toc-number">2.2.3.</span> <span class="toc-text">Hallucigenia</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS"><span class="toc-number">2.2.4.</span> <span class="toc-text">DNS</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week3"><span class="toc-number">3.</span> <span class="toc-text">Week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Re-2"><span class="toc-number">3.1.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gun"><span class="toc-number">3.1.1.</span> <span class="toc-text">gun</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FAKE"><span class="toc-number">3.1.2.</span> <span class="toc-text">FAKE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#helloRe3"><span class="toc-number">3.1.3.</span> <span class="toc-text">helloRe3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-2"><span class="toc-number">3.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-R-K"><span class="toc-number">3.2.1.</span> <span class="toc-text">A R K</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#A-R-C"><span class="toc-number">3.2.2.</span> <span class="toc-text">A R C</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#accuracy"><span class="toc-number">3.2.3.</span> <span class="toc-text">accuracy</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week4"><span class="toc-number">4.</span> <span class="toc-text">Week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Re-3"><span class="toc-number">4.1.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vm"><span class="toc-number">4.1.1.</span> <span class="toc-text">vm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#A-5-Second-Challenge"><span class="toc-number">4.1.2.</span> <span class="toc-text">A 5 Second Challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nllvm"><span class="toc-number">4.1.3.</span> <span class="toc-text">nllvm</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-3"><span class="toc-number">4.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Akira%E4%B9%8B%E7%9E%B3-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">Akira之瞳-1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Akira%E4%B9%8B%E7%9E%B3-2"><span class="toc-number">4.2.2.</span> <span class="toc-text">Akira之瞳-2</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/cover/hgame2021.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By in1t</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-orange?style=flat&logo=bitdefender" title="主题采用butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Source-Github-brightgreen?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);</script><div class="js-pjax"></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="/js/modify.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="💐,🌸,💮,🏵,🌹,🥀,🌺,🌻,🌼,🌷,🌱,🌲,🌳,🌴,🌵,🌾,🌿,☘,🍀,🍁,🍂,🍃,🍇,🍈,🍉,🍊,🍋,🍌,🍍,🍎,🍏,🍐,🍑,🍒,🍓,🥝,🍅,🥥,🥑,🍆,🥔,🥕,🌽,🌶,🥒,🥬,🥦,🧄,🧅,🍄,🥜,🌰,🍞,🥐,🥖,🥨,🥯,🥞,🧇,🧀,🍖,🍗,🥩,🥓,🍔,🍟,🍕,🌭,🥪,🌮,🌯,🥙,🧆,🥚,🍳,🥘,🍲,🥣,🥗,🍿,🧈,🧂,🥫,🍱,🍘,🍙,🍚,🍛,🍜,🍠,🍢,🍣,🍤,🍥,🥮,🍡,🥟,🥠,🥡,🦪,🍨,🍩,🍪,🎂,🍰,🧁,🥧,🍫,🍬,🍭,🍮,🍯,🍼,🥛,☕,🍵,🍶,🍾,🍷,🍹,🍻,🥂,🥃,🥤,🧃,🧉,🧊,🥢,🍽,🥄" data-fontsize="20px" data-random="false" async="async"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":20,"vOffset":-65},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body></html>