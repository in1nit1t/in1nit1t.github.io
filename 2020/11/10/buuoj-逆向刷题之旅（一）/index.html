<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸€ï¼‰ | in1t's blog</title><meta name="keywords" content="é€†å‘,buuoj"><meta name="author" content="in1t"><meta name="copyright" content="in1t"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å½©ç¬”æ¥ buu åšé¢˜äº† QAQï¼Œæ¯é“åšäº†çš„æˆ‘éƒ½ä»ä¸åŒè§’åº¦ä¸ºå…¶æ·»åŠ äº†å…³é”®è¯ï¼Œæœ¬æ–‡æ”¶å½•äº† 59 é“é¢˜ï¼Œå¤šæ•°ä¸ºç®€å•é¢˜">
<meta property="og:type" content="article">
<meta property="og:title" content="buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸€ï¼‰">
<meta property="og:url" content="http://in1nit1t.github.io/2020/11/10/buuoj-%E9%80%86%E5%90%91%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%80%EF%BC%89/index.html">
<meta property="og:site_name" content="in1t&#39;s blog">
<meta property="og:description" content="å½©ç¬”æ¥ buu åšé¢˜äº† QAQï¼Œæ¯é“åšäº†çš„æˆ‘éƒ½ä»ä¸åŒè§’åº¦ä¸ºå…¶æ·»åŠ äº†å…³é”®è¯ï¼Œæœ¬æ–‡æ”¶å½•äº† 59 é“é¢˜ï¼Œå¤šæ•°ä¸ºç®€å•é¢˜">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://in1nit1t.github.io/img/cover/buuojre1.jpg">
<meta property="article:published_time" content="2020-11-10T10:42:32.000Z">
<meta property="article:modified_time" content="2021-07-07T08:27:37.367Z">
<meta property="article:author" content="in1t">
<meta property="article:tag" content="é€†å‘">
<meta property="article:tag" content="buuoj">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://in1nit1t.github.io/img/cover/buuojre1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://in1nit1t.github.io/2020/11/10/buuoj-%E9%80%86%E5%90%91%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%80%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸€ï¼‰',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-07-07 16:27:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">39</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-play-circle"></i><span> ç•ªå‰§</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/buuojre1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">in1t's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-play-circle"></i><span> ç•ªå‰§</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸€ï¼‰</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-11-10T10:42:32.000Z" title="å‘è¡¨äº 2020-11-10 18:42:32">2020-11-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-07-07T08:27:37.367Z" title="æ›´æ–°äº 2021-07-07 16:27:37">2021-07-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">10.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>48åˆ†é’Ÿ</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>å½©ç¬”æ¥ buu åšé¢˜äº† QAQï¼Œæ¯é“åšäº†çš„æˆ‘éƒ½ä»ä¸åŒè§’åº¦ä¸ºå…¶æ·»åŠ äº†å…³é”®è¯ï¼Œæ–¹ä¾¿ ctrl + F æŸ¥æ‰¾ä½ æ„Ÿå…´è¶£çš„å†…å®¹ï¼ˆæœç´¢æ—¶è¯·å‹¿åŒºåˆ†å¤§å°å†™ï¼‰ï¼ŒæŒç»­æ›´æ–°ä¸­â€¦</p>
<p>ä»¥ä¸‹æ˜¯æœ¬æ–‡æ¶‰åŠåˆ°çš„å…³é”®è¯ï¼š</p>
<ul>
<li>æ¶æ„ï¼šx86, JVM, PVM</li>
<li>æ–‡ä»¶ç±»å‹ï¼šexe, elf, apk, MachO, pyc, javascript, sys</li>
<li>è€ƒç‚¹ï¼šupx, javaå±‚, base64, maze, å›¾å½¢ç•Œé¢, DOS, patch, sha1, md5, elfè¿è¡Œæµç¨‹, èŠ±æŒ‡ä»¤, RSA, æºæ’’å¯†ç , nativeå±‚, å˜ç§base64, .NET, æ··æ·†, tea, Unityæ¸¸æˆ, åè°ƒè¯•, goè¯­è¨€, å›ºä»¶åˆ†æ, xxtea, SMC, AES_ECB, äºŒå‰æ ‘, æ•°ç‹¬, vmè™šæ‹Ÿæœº, z3, angr,  JsFuckæ··æ·†</li>
</ul>
<p>PS. ç”¨åˆ°çš„ python è„šæœ¬è¿è¡Œç¯å¢ƒ<strong>é™¤ç‰¹æ®Šæ ‡æ³¨å¤–å‡ä¸º python2</strong>ï¼Œ<strong>å¦‚æœå†…å®¹æœ‰è¯¯æˆ–è€…å›¾ç‰‡ç¼ºå¤±ï¼Œæ¬¢è¿è”ç³»æˆ‘ä¿®æ­£</strong>ã€‚</p>
<p>å‰©ä¸‹ä¹Ÿæ²¡å•¥å¥½è¯´çš„äº†ï¼Œé€å¤§å®¶ä¸€é¦–æ­Œå§ï¼Œæ­Œåå°±å« re</p>
<iframe frameborder="0" border="1"
    marginwidth="0" marginheight="0"
    width=100% height=105
    src="//music.163.com/outchain/player?type=2&id=570296030&auto=0&height=60">
</iframe>

<br>

<h3 id="easyre-x86-exe"><a href="#easyre-x86-exe" class="headerlink" title="easyre |x86,exe"></a>easyre |x86,exe</h3><p>shift + F12</p>
<br>

<h3 id="reverse1-x86-exe"><a href="#reverse1-x86-exe" class="headerlink" title="reverse1 |x86,exe"></a>reverse1 |x86,exe</h3><p>shift + F12ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/reverse1/1.png" alt="easyre"></p>
<p>æŸ¥çœ‹äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°å…³é”®å‡½æ•° sub_1400118C0ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/reverse1/2.png" alt="reverse1"></p>
<p>ä¸Šé¢çš„ for å¾ªç¯å°† Str2 ä¸­çš„ o éƒ½æ›¿æ¢æˆ 0</p>
<br>

<h3 id="reverse2-x86-elf"><a href="#reverse2-x86-elf" class="headerlink" title="reverse2 |x86,elf"></a>reverse2 |x86,elf</h3><p>åç¼–è¯‘ mainï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/reverse2/1.png" alt="reverse2"></p>
<p>fork åˆ›å»ºäº†ä¸€ä¸ªå­è¿›ç¨‹å°† flag ä¸­çš„ i å’Œ r éƒ½æ›¿æ¢æˆ 1</p>
<br>

<h3 id="å†…æ¶µçš„è½¯ä»¶-x86-exe"><a href="#å†…æ¶µçš„è½¯ä»¶-x86-exe" class="headerlink" title="å†…æ¶µçš„è½¯ä»¶ | x86,exe"></a>å†…æ¶µçš„è½¯ä»¶ | x86,exe</h3><p>shift + F12</p>
<br>

<h3 id="æ–°å¹´å¿«ä¹-x86-exe-upx"><a href="#æ–°å¹´å¿«ä¹-x86-exe-upx" class="headerlink" title="æ–°å¹´å¿«ä¹ | x86,exe,upx"></a>æ–°å¹´å¿«ä¹ | x86,exe,upx</h3><p>exe è¢« upx å‹ç¼©ï¼Œåˆ° <a target="_blank" rel="noopener" href="https://upx.github.io/">ç½‘ç«™</a> ä¸‹è½½upxï¼Œä½¿ç”¨å‘½ä»¤ <code>upx.exe -d xnkl.exe -o xnkl_unpack.exe</code> è§£å‹</p>
<p>ida æ‰“å¼€ xnkl_unpack.exeï¼Œæ‰¾åˆ° main å‡½æ•°:<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90/1.png" alt="æ–°å¹´å¿«ä¹"></p>
<br>

<h3 id="BJDCTF-2nd-guessgame-x86-exe"><a href="#BJDCTF-2nd-guessgame-x86-exe" class="headerlink" title="[BJDCTF 2nd]guessgame | x86,exe"></a>[BJDCTF 2nd]guessgame | x86,exe</h3><p>shift + F12</p>
<br>

<h3 id="helloword-JVM-apk-javaå±‚"><a href="#helloword-JVM-apk-javaå±‚" class="headerlink" title="helloword | JVM,apk,javaå±‚"></a>helloword | JVM,apk,javaå±‚</h3><p>jadx æ‰“å¼€ç±» com.example.helloword.MainActivityï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/helloword/1.png" alt="helloword"></p>
<br>

<h3 id="xor-x86-MachO"><a href="#xor-x86-MachO" class="headerlink" title="xor | x86,MachO"></a>xor | x86,MachO</h3><p>main å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/xor/1.png" alt="xor"></p>
<p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rawData = <span class="string">&quot;66 0A 6B 0C 77 26 4F 2E 40 11 78 0D 5A 3B 55 11 70 19 46 1F 76 22 4D 23 44 0E 67 06 68 0F 47 32 4F&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> rawData]</span><br><span class="line"></span><br><span class="line">flag = [target[<span class="number">0</span>]] + [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">	flag[i] = target[i] ^ target[i-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, flag))</span><br></pre></td></tr></table></figure>

<br>

<h3 id="reverse3-x86-exe-base64"><a href="#reverse3-x86-exe-base64" class="headerlink" title="reverse3 | x86,exe,base64"></a>reverse3 | x86,exe,base64</h3><p>æ‰¾åˆ° main_0 å‡½æ•°ï¼Œæ ¹æ®å‡½æ•°è¡Œä¸ºè¿˜åŸéƒ¨åˆ†å˜é‡åŠå‡½æ•°åï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/reverse3/1.png" alt="reverse3"></p>
<p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">rawData = <span class="string">&quot;e3nifIH9b_C@n@dH&quot;</span></span><br><span class="line">target = <span class="built_in">map</span>(<span class="built_in">ord</span>, rawData)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">	target[i] -= i</span><br><span class="line">src = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, target))</span><br><span class="line"><span class="built_in">print</span> base64.b64decode(src)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ä¸ä¸€æ ·çš„flag-x86-exe-maze"><a href="#ä¸ä¸€æ ·çš„flag-x86-exe-maze" class="headerlink" title="ä¸ä¸€æ ·çš„flag | x86,exe,maze"></a>ä¸ä¸€æ ·çš„flag | x86,exe,maze</h3><p>è¿·å®«é¢˜ï¼Œmain å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag/1.png" alt="ä¸ä¸€æ ·çš„flag"></p>
<p>ä¸€ç»´åŒ–çš„è¿·å®«æ˜¯ *11110100001010000101111#ï¼Œæ ¹æ® main å‡½æ•°çš„åˆ¤æ–­æ¡ä»¶ï¼Œå¯çŸ¥äºŒç»´çŠ¶æ€ä¸‹ä¸€è¡Œæœ‰ 5 ä¸ªå…ƒç´ ï¼Œè¿˜åŸäºŒç»´è¿·å®«ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag/2.png" alt="ä¸ä¸€æ ·çš„flag"></p>
<p>å°† ä¸Šä¸‹å·¦å³ æ˜ å°„åˆ° 1234 å»å°±å¾—åˆ° flag äº†</p>
<p>PS. è¿™é“é¢˜å‡ºå¾—ä¸ä¸¥è°¨ï¼Œè€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼šåœ¨ä¸€ä¸ªåœ°æ–¹åå¤å…ˆä¸‹åä¸Šï¼ˆæˆ–è€…åå¤å·¦å³æ¨ªè·³ï¼‰ï¼Œç„¶åå†èµ°åˆ°ç»ˆç‚¹ï¼Œä¾ç„¶æ˜¾ç¤ºé¡ºåºæ­£ç¡®</p>
<br>

<h3 id="SimpleRev-x86-elf"><a href="#SimpleRev-x86-elf" class="headerlink" title="SimpleRev | x86,elf"></a>SimpleRev | x86,elf</h3><p>main å‡½æ•°è°ƒç”¨ Decry å‡½æ•°ï¼Œä¸‹é¢æ˜¯å¯¹è¯¥å‡½æ•°çš„åˆ†æï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/SimpleRev/1.png" alt="SimpleRev"></p>
<p>é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼è·å¾— flagï¼Œè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;ADSFKNDCLS&quot;</span>.lower()</span><br><span class="line">key = <span class="built_in">map</span>(<span class="built_in">ord</span>, key)</span><br><span class="line">text = <span class="string">&quot;killshadow&quot;</span></span><br><span class="line">text = <span class="built_in">map</span>(<span class="built_in">ord</span>, text)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">charSet = string.uppercase + string.lowercase</span><br><span class="line">charSet = <span class="built_in">map</span>(<span class="built_in">ord</span>, charSet)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">	<span class="keyword">for</span> char <span class="keyword">in</span> charSet:</span><br><span class="line">		<span class="keyword">if</span> text[i] == (char - <span class="number">39</span> - key[i] + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>):</span><br><span class="line">			flag += <span class="built_in">chr</span>(char)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Javaé€†å‘è§£å¯†-JVM-javaå±‚"><a href="#Javaé€†å‘è§£å¯†-JVM-javaå±‚" class="headerlink" title="Javaé€†å‘è§£å¯† | JVM,javaå±‚"></a>Javaé€†å‘è§£å¯† | JVM,javaå±‚</h3><p>jadx æ‰“å¼€ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86/1.png" alt="Javaé€†å‘è§£å¯†"></p>
<p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">encrypt = [<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> encrypt:</span><br><span class="line">	flag += <span class="built_in">chr</span>((e ^ <span class="number">32</span>) - <span class="built_in">ord</span>(<span class="string">&#x27;@&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="åˆ®å¼€æœ‰å¥–-x86-exe-å›¾å½¢ç•Œé¢-base64"><a href="#åˆ®å¼€æœ‰å¥–-x86-exe-å›¾å½¢ç•Œé¢-base64" class="headerlink" title="åˆ®å¼€æœ‰å¥– | x86,exe,å›¾å½¢ç•Œé¢,base64"></a>åˆ®å¼€æœ‰å¥– | x86,exe,å›¾å½¢ç•Œé¢,base64</h3><p>ida æ‰“å¼€â€¦â€¦å¥½å®¶ä¼™ï¼Œåˆé€®åˆ°ä¸€ä¸ªä¸ç”¨æ¡†æ¶å†™å›¾å½¢åŒ–ç•Œé¢çš„ï¼Œæƒ³åŠæ³•å¹²ä»–ä¸€ç‚®ï¼</p>
<p>WinMain ä¸­å¯ä»¥çœ‹åˆ°è¯¥ç¨‹åºå°±æ˜¯å¼¹ä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯¹è¯æ¡†å¯¹åº”çš„å‡½æ•°æ˜¯ DialogFuncï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/1.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>DialogFunc å¤§è‡´çš„é€»è¾‘å°±æ˜¯ä»ä¸€ä¸ªè¾“å…¥æ¡†ä¸­è¯»å–è¾“å…¥ï¼Œç»è¿‡ä¸€äº›æ“ä½œåä¸ç‰¹å®šçš„å€¼æ¯”è¾ƒï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/2.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>ä½†æ˜¯è¿è¡Œèµ·æ¥å‘ç°æ‰¾ä¸åˆ°åº”æœ‰çš„è¾“å…¥æ¡†å’ŒæŒ‰é’®ï¼Œåªæœ‰ä¸€å¼ å›¾â€¦â€¦å½“æˆ‘ Resource Hacker åƒç´ çš„å—ï¼Ÿä¸èƒ½æƒ¯ç€ä»–ï¼Œæ‰“å¼€ RHï¼Œexe æ‹–è¿›å»ï¼ŒDialog -&gt; 103ï¼Œå¼„ä»–ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/3.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>ä¿®æ”¹åï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/4.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>File -&gt; Save Asï¼Œå¦å­˜ä¸º 2.exeï¼Œå†è¿è¡Œï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/5.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>è¾“å…¥çš„é—®é¢˜è§£å†³äº†ï¼Œæ¥ä¸‹æ¥ç»†çœ‹ä»£ç é€»è¾‘ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªéš¾å…³æ˜¯ sub_4010F0ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/6.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>è¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥æœ‰ç‚¹éº»çƒ¦ï¼Œè¿˜æœ‰é€’å½’çš„è¦ç´ åœ¨é‡Œé¢ï¼Œåæ­£å°±æ˜¯å¯¹ v7 å¼€å§‹çš„ 10 ä¸ªæ•´æ•°è¿›è¡Œå˜æ¢ã€‚ä¸¤æ¡è·¯ â€”â€” è¦ä¹ˆä¼ªä»£ç å¤åˆ¶å‡ºæ¥å†™ä¸ª C è·‘ä¸€ä¸‹ï¼Œè¦ä¹ˆåŠ¨æ€è°ƒè¯•ã€‚è¿™æˆ‘èƒ½æƒ¯ç€ Visual Studioï¼Ÿä¸Š OD</p>
<p>é‡å®šä½ä¸€æ³¢ <code>call sub_4010F0</code> æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼Œä¸‹ä¸ªæ–­ï¼Œè¾“å…¥æ¡†éšä¾¿æ•´ä¸ª 8 ä½æ•°ã€‚æ–­ä¸‹æ¥åœ¨æ•°æ®çª—å£ä¸­è·Ÿéš ecx ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/7.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>æ­¥è¿‡ï¼Œå†çœ‹:</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/8.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>å…³é—­ ODï¼Œç»§ç»­æ€¼ idaï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/9.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>ä¸‹é¢çš„åˆ¤æ–­è¯­å¥ä¸­è¦æ±‚ <code>v4 = &quot;ak1w&quot;</code>ï¼Œ<code>v5 = &quot;V1Ax&quot;</code>ï¼Œé‚£ flag[2] ~ flag[7] éƒ½çŸ¥é“äº†ã€‚å†å¾€ä¸‹çœ‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/10.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<p>ç°åœ¨çš„ v7 å’Œ v11 ç»è¿‡ sub_4010F0 çš„å˜æ¢å·²ç»å˜æˆäº† â€˜3â€™ å’Œ â€˜Jâ€™ï¼ŒOK æ¸¸æˆç»“æŸï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&#x27;&#x27;</span>] * <span class="number">8</span></span><br><span class="line">v4 = <span class="string">&quot;ak1w&quot;</span></span><br><span class="line">v5 = <span class="string">&quot;V1Ax&quot;</span></span><br><span class="line"></span><br><span class="line">t1 = b64decode(v4)</span><br><span class="line">flag[<span class="number">5</span>] = t1[<span class="number">0</span>]</span><br><span class="line">flag[<span class="number">7</span>] = t1[<span class="number">2</span>]</span><br><span class="line">flag[<span class="number">6</span>] = t1[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">t2 = b64decode(v5)</span><br><span class="line">flag[<span class="number">3</span>] = t2[<span class="number">1</span>]</span><br><span class="line">flag[<span class="number">2</span>] = t2[<span class="number">0</span>]</span><br><span class="line">flag[<span class="number">4</span>] = t2[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">flag[<span class="number">0</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;3&#x27;</span>) + <span class="number">34</span>)</span><br><span class="line">flag[<span class="number">1</span>] = <span class="string">&#x27;J&#x27;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<p>èŠœæ¹–ğŸ›«ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/11.png" alt="åˆ®å¼€æœ‰å¥–"></p>
<br>

<h3 id="BJDCTF-2nd-8086-x86-exe-DOS"><a href="#BJDCTF-2nd-8086-x86-exe-DOS" class="headerlink" title="[BJDCTF 2nd]8086 | x86,exe,DOS"></a>[BJDCTF 2nd]8086 | x86,exe,DOS</h3><p>MS DOS çš„ç¨‹åºæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„â€¦â€¦ida æ‰“å¼€ï¼Œå› ä¸ºä¸€ä¸ª jmp æ­»å¾ªç¯å¯¼è‡´ ida ä¸è¯†åˆ«å‰©ä¸‹çš„ä»£ç ï¼Œå¼ºè½¬ä¸€ä¸‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2nd8086/1.png" alt="BJDCTF2nd8086"></p>
<p>é€»è¾‘å¾ˆç®€å•:</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2nd8086/2.png" alt="BJDCTF2nd8086"></p>
<p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">encode = <span class="string">&quot;]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;&quot;</span></span><br><span class="line">encode = <span class="built_in">map</span>(<span class="built_in">ord</span>, encode)</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> encode:</span><br><span class="line">	flag.append(<span class="built_in">chr</span>(char ^ <span class="number">0x1F</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="GKCTF2020-Check-1n-x86-exe"><a href="#GKCTF2020-Check-1n-x86-exe" class="headerlink" title="[GKCTF2020]Check_1n | x86,exe"></a>[GKCTF2020]Check_1n | x86,exe</h3><p>PS. ç»äº†è¿™é¢˜ä½œè€…ï¼ŒçœŸæœ‰ç²¾åŠ›å—·ï¼Œä¸»åŠæ–¹æ˜¯å¸®ä½ æŠŠä¸‹ä¸ªæœˆçš„èŠ±å‘—è¿˜å®Œäº†è¿˜æ˜¯å’‹çš„â€¦â€¦</p>
<p>å¼€æœºè®©è¾“å¯†ç ï¼Œida shift + F12ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸² â€œå¯†ç é”™è¯¯â€ çš„äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°å‡½æ•° sub_404DF0ï¼Œå¾€ä¸Šæ‰¾æ‰¾çœ‹åˆ°å¯†ç  HelloWorld:</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GKCTF2020Check_1n/1.png" alt="GKCTF2020Check_1n"></p>
<p>è®¿é—®æ¡Œé¢ä¸Šçš„ flag æ–‡ä»¶ï¼Œå°†å¾—åˆ°çš„ base64 ä¸²è§£ç ï¼Œå¾—åˆ° Why donâ€™t you try the magic brick gameï¼Œé‚£å°±ç©ä¸€ä¸‹æ‰“ç –å—ï¼Œä¸ç”¨åŠ¨ç­‰ä»–æ­»äº†ä¸Šæ–¹å°±ä¼šå‡ºç° flag</p>
<br>

<h3 id="findit-JVM-apk-javaå±‚"><a href="#findit-JVM-apk-javaå±‚" class="headerlink" title="findit | JVM,apk,javaå±‚"></a>findit | JVM,apk,javaå±‚</h3><p>jadx æ‰“å¼€ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/findit/1.png" alt="findit"></p>
<p>å˜é‡ b æ‹¼æ¥èµ·æ¥æ˜¯ pvkq{m164675262033l4m49lnp7p9mnk28k75}</p>
<p>ä¸ç”¨æƒ³äº†ï¼Œæ— è„‘ <a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">å‡¯æ’’è§£å¯†</a>ï¼Œä½ç§»ä¸º 10</p>
<br>

<h3 id="GXYCTF2019-luck-guy-x86-elf-patch"><a href="#GXYCTF2019-luck-guy-x86-elf-patch" class="headerlink" title="[GXYCTF2019]luck_guy | x86,elf,patch"></a>[GXYCTF2019]luck_guy | x86,elf,patch</h3><p>å…³é”®å‡½æ•° get_flagï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GXYCTF2019luck_guy/1.png" alt="GXYCTF2019luck_guy"></p>
<p>ç»è¿‡åˆ†æï¼Œå¾—çŸ¥å½“æ‰§è¡Œæµä¾æ¬¡ç»è¿‡ 4ã€5ã€1 åä¼šè¾“å‡ºæ­£ç¡®çš„ flagã€‚ä¸¤æ¡è·¯ â€”â€” è„šæœ¬/patchï¼Œé‚£æˆ‘èƒ½æƒ¯ç€ python å—ï¼Œpatch å®‰æ’ï¼</p>
<p>patch ç‚¹ 1ï¼šå…ˆå»åˆ° case4</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GXYCTF2019luck_guy/2.png" alt="GXYCTF2019luck_guy"></p>
<p>patch ç‚¹ 2ï¼šæ¥ç€æ‰§è¡Œ case5</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GXYCTF2019luck_guy/3.png" alt="GXYCTF2019luck_guy"></p>
<p>patch ç‚¹ 3ï¼šcase5 ç»“æŸåè·³è½¬åˆ° case1</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GXYCTF2019luck_guy/4.png" alt="GXYCTF2019luck_guy"></p>
<p>patch ç‚¹ 4ï¼šcase1 ç»“æŸåé€€å‡ºå‡½æ•°</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GXYCTF2019luck_guy/5.png" alt="GXYCTF2019luck_guy"></p>
<p>F5 ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨çš„æ‰§è¡Œæµæ˜¯æ­£ç¡®çš„ï¼š<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GXYCTF2019luck_guy/6.png" alt="GXYCTF2019luck_guy"></p>
<p>æ”¾åˆ° linux ä¸‹å»è·‘å°±èƒ½å‡º flagï¼ˆç­‰å¾…è¾“å…¥é‚£é‡Œè¾“ä¸€ä¸ª2å°±è¡Œï¼‰</p>
<br>

<h3 id="ç®€å•æ³¨å†Œå™¨-JVM-apk-javaå±‚"><a href="#ç®€å•æ³¨å†Œå™¨-JVM-apk-javaå±‚" class="headerlink" title="ç®€å•æ³¨å†Œå™¨ | JVM,apk,javaå±‚"></a>ç®€å•æ³¨å†Œå™¨ | JVM,apk,javaå±‚</h3><p>jadx æ‰“å¼€ï¼Œé€»è¾‘å¾ˆç®€å•ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8/1.png" alt="ç®€å•æ³¨å†Œå™¨"></p>
<p>ç›´æ¥æŠŠç”Ÿæˆ flag çš„éƒ¨åˆ†æ‹¿å‡ºæ¥æ”¹ä¸€ä¸‹å§ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span></span><br><span class="line">x = <span class="built_in">map</span>(<span class="built_in">ord</span>, x)</span><br><span class="line">x[<span class="number">2</span>]  = ((x[<span class="number">2</span>] + x[<span class="number">3</span>]) - <span class="number">50</span>)</span><br><span class="line">x[<span class="number">4</span>]  = ((x[<span class="number">2</span>] + x[<span class="number">5</span>]) - <span class="number">48</span>)</span><br><span class="line">x[<span class="number">30</span>] = ((x[<span class="number">31</span>] + x[<span class="number">9</span>]) - <span class="number">48</span>)</span><br><span class="line">x[<span class="number">14</span>] = ((x[<span class="number">27</span>] + x[<span class="number">28</span>]) - <span class="number">97</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">	tmp = x[<span class="number">31</span> - i]</span><br><span class="line">	x[<span class="number">31</span> - i] = x[i]</span><br><span class="line">	x[i] = tmp</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, x))</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="rsa-rsa"><a href="#rsa-rsa" class="headerlink" title="rsa | rsa"></a>rsa | rsa</h3><p>é¢ï¼Œçº¯å¯†ç å­¦çš„é¢˜ï¼Œèµ°é”™åˆ†åŒºäº†å§è€å“¥ï¼Œé¢˜è§£è§ <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30607659/article/details/101533319">é“¾æ¥</a></p>
<br>

<h3 id="GWCTF-2019-pyre-PVM-pyc"><a href="#GWCTF-2019-pyre-PVM-pyc" class="headerlink" title="[GWCTF 2019]pyre | PVM,pyc"></a>[GWCTF 2019]pyre | PVM,pyc</h3><p>ç”¨ uncompyle6 æˆ–è€… <a target="_blank" rel="noopener" href="https://tool.lu/pyc/">åœ¨çº¿ç½‘ç«™</a> åç¼–è¯‘ pyc æ–‡ä»¶ï¼Œå¾—åˆ° python æºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Welcome to Re World!&#x27;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Your input1 is your flag~&#x27;</span></span><br><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x1d&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, </span><br><span class="line">        <span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;\x1b&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, </span><br><span class="line">        <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>ä¸æƒ³æƒ³äº†ï¼Œçˆ†ç ´å§ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x1d&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, </span><br><span class="line">		<span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;\x1b&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, </span><br><span class="line">		<span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line">code = <span class="built_in">map</span>(<span class="built_in">ord</span>, code)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code) - <span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">	code[i] ^= code[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>, <span class="number">127</span>):</span><br><span class="line">		<span class="keyword">if</span> code[i] == ((j + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span>:</span><br><span class="line">			flag += <span class="built_in">chr</span>(j)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="CrackRTF-x86-exe-sha1-md5"><a href="#CrackRTF-x86-exe-sha1-md5" class="headerlink" title="CrackRTF | x86,exe,sha1,md5"></a>CrackRTF | x86,exe,sha1,md5</h3><p>main_0 å‡½æ•°æ£€æŸ¥ç¬¬ä¸€ä¸ªè¾“å…¥çš„éƒ¨åˆ†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/1.png" alt="CrackRTF"></p>
<p>å¦‚ä½•åˆ¤æ–­ sub_40100A æ˜¯ sha1 å“ˆå¸Œå‡½æ•°å‘¢ï¼Œç‚¹è¿›å»å‘ç°å®ƒè°ƒç”¨ sub_401230ï¼Œç»§ç»­è·Ÿè¿›ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/2.png" alt="CrackRTF"></p>
<p>æ ¹æ® windows API çš„å°¿æ€§ï¼ŒCryptCreateHash å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°åº”è¯¥ç”¨æ¥æŒ‡å®š hash çš„ç±»å‹ã€‚åœ¨ <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/win32/api/wincrypt/nf-wincrypt-cryptcreatehash?f1url=%3FappId%3DDev16IDEF1%26l%3DZH-CN%26k%3Dk(CryptCreateHash);k(DevLang-C%252B%252B);k(TargetOS-Windows)%26rd%3Dtrue">MSDN æ–‡æ¡£</a> ä¸­æŸ¥æ‰¾è¯¥å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/3.png" alt="CrackRTF"></p>
<p>ç‚¹ <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id">ALG_ID</a> è¿›å»æŸ¥æ‰¾ 0x8004ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/4.png" alt="CrackRTF"></p>
<p>é‚£å¯†ç  1 å°±èƒ½å¾—åˆ°äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sha1Encode</span>(<span class="params">plain</span>):</span></span><br><span class="line">	sha = hashlib.sha1(plain.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">	<span class="keyword">return</span> sha.hexdigest().upper()</span><br><span class="line"></span><br><span class="line">passwd1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>, <span class="number">1000000</span>):</span><br><span class="line">	plain = <span class="built_in">str</span>(i) + <span class="string">&quot;@DBApp&quot;</span></span><br><span class="line">	<span class="keyword">if</span> sha1Encode(plain) == <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>:</span><br><span class="line">		passwd1 = <span class="built_in">str</span>(i)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span> passwd1</span><br><span class="line"><span class="comment"># 123321</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ¬¡è¾“å…¥æ£€æŸ¥ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/5.png" alt="CrackRTF"></p>
<p>åŒç†å¯ä»¥ç¡®å®š sub_401019 ä¸º md5 å“ˆå¸Œå‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/6.png" alt="CrackRTF"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/CrackRTF/7.png" alt="CrackRTF"></p>
<p>è¿™æ¬¡å¯†ç å°±æœ‰ç‚¹éš¾çˆ†äº†ï¼Œä¸åƒå¯†ç  1 æš—ç¤ºä½ å®ƒæ˜¯ä¸€ä¸ª 6 ä½æ•´æ•°ï¼Œè¿™é‡Œéœ€è¦è€ƒè™‘æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ã€‚ä½¿ç”¨è„šæœ¬å¯èƒ½ä¼šçˆ†å¾ˆä¹…ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©ä½¿ç”¨å·¥å…· hashcat æ¥çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç  2 ä¸º <code>~!3a@0</code></p>
<p>ä¹–ä¹–å°†è¿™ä¿©å¯†ç ä¾æ¬¡è¾“å…¥ç¨‹åºå¯ä»¥å¾—åˆ°ä¸€ä¸ª dbapp.rtfï¼Œæ‰“å¼€å°±æ˜¯ flag</p>
<br>

<h3 id="BJDCTF2020-JustRE-x86-exe-å›¾å½¢ç•Œé¢"><a href="#BJDCTF2020-JustRE-x86-exe-å›¾å½¢ç•Œé¢" class="headerlink" title="[BJDCTF2020]JustRE | x86,exe,å›¾å½¢ç•Œé¢"></a>[BJDCTF2020]JustRE | x86,exe,å›¾å½¢ç•Œé¢</h3><p>åˆæ˜¯ä¸ªä¸ç”¨æ¡†æ¶å†™å›¾å½¢ç•Œé¢çš„ï¼ŒWinMain é‡Œè°ƒç”¨ sub_4010C0 æ³¨å†Œ RE2 ç±»ï¼Œå¯¹åº”çš„çª—ä½“å‡½æ•°æ˜¯ sub_4011C0ã€‚</p>
<p>Resource Hacker æŸ¥çœ‹ â€œæµ‹è¯•ä½ çš„æ‰‹é€Ÿâ€ å¯¹è¯æ¡†çš„èµ„æºå·ä¸º 129ï¼Œåœ¨ sub_4011C0 ä¸­æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å‡½æ•°æ˜¯ DialogFuncï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2020JustRE/1.png" alt="BJDCTF2020JustRE"></p>
<p>æŸ¥çœ‹ DialogFuncï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2020JustRE/2.png" alt="BJDCTF2020JustRE"></p>
<br>

<h3 id="2019çº¢å¸½æ¯-easyRE-x86-elf-elfè¿è¡Œæµç¨‹"><a href="#2019çº¢å¸½æ¯-easyRE-x86-elf-elfè¿è¡Œæµç¨‹" class="headerlink" title="[2019çº¢å¸½æ¯]easyRE | x86,elf,elfè¿è¡Œæµç¨‹"></a>[2019çº¢å¸½æ¯]easyRE | x86,elf,elfè¿è¡Œæµç¨‹</h3><p>shift + F12ï¼ŒæŸ¥æ‰¾ â€œYou found me!!!â€ çš„äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ° sub_4009C6ã€‚ç¬¬ä¸€éƒ¨åˆ†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE/1.png" alt="2019çº¢å¸½æ¯easyRE"></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">target = [<span class="number">0</span>] * <span class="number">36</span></span><br><span class="line">target[<span class="number">0</span>] = <span class="number">73</span></span><br><span class="line">target[<span class="number">1</span>] = <span class="number">111</span></span><br><span class="line">target[<span class="number">2</span>] = <span class="number">100</span></span><br><span class="line">target[<span class="number">3</span>] = <span class="number">108</span></span><br><span class="line">target[<span class="number">4</span>] = <span class="number">62</span></span><br><span class="line">target[<span class="number">5</span>] = <span class="number">81</span></span><br><span class="line">target[<span class="number">6</span>] = <span class="number">110</span></span><br><span class="line">target[<span class="number">7</span>] = <span class="number">98</span></span><br><span class="line">target[<span class="number">8</span>] = <span class="number">40</span></span><br><span class="line">target[<span class="number">9</span>] = <span class="number">111</span></span><br><span class="line">target[<span class="number">10</span>] = <span class="number">99</span></span><br><span class="line">target[<span class="number">11</span>] = <span class="number">121</span></span><br><span class="line">target[<span class="number">12</span>] = <span class="number">127</span></span><br><span class="line">target[<span class="number">13</span>] = <span class="number">121</span></span><br><span class="line">target[<span class="number">14</span>] = <span class="number">46</span></span><br><span class="line">target[<span class="number">15</span>] = <span class="number">105</span></span><br><span class="line">target[<span class="number">16</span>] = <span class="number">127</span></span><br><span class="line">target[<span class="number">17</span>] = <span class="number">100</span></span><br><span class="line">target[<span class="number">18</span>] = <span class="number">96</span></span><br><span class="line">target[<span class="number">19</span>] = <span class="number">51</span></span><br><span class="line">target[<span class="number">20</span>] = <span class="number">119</span></span><br><span class="line">target[<span class="number">21</span>] = <span class="number">125</span></span><br><span class="line">target[<span class="number">22</span>] = <span class="number">119</span></span><br><span class="line">target[<span class="number">23</span>] = <span class="number">101</span></span><br><span class="line">target[<span class="number">24</span>] = <span class="number">107</span></span><br><span class="line">target[<span class="number">25</span>] = <span class="number">57</span></span><br><span class="line">target[<span class="number">26</span>] = <span class="number">123</span></span><br><span class="line">target[<span class="number">27</span>] = <span class="number">105</span></span><br><span class="line">target[<span class="number">28</span>] = <span class="number">121</span></span><br><span class="line">target[<span class="number">29</span>] = <span class="number">61</span></span><br><span class="line">target[<span class="number">30</span>] = <span class="number">126</span></span><br><span class="line">target[<span class="number">31</span>] = <span class="number">121</span></span><br><span class="line">target[<span class="number">32</span>] = <span class="number">76</span></span><br><span class="line">target[<span class="number">33</span>] = <span class="number">64</span></span><br><span class="line">target[<span class="number">34</span>] = <span class="number">69</span></span><br><span class="line">target[<span class="number">35</span>] = <span class="number">67</span></span><br><span class="line"></span><br><span class="line">input1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> idx, value <span class="keyword">in</span> <span class="built_in">enumerate</span>(target):</span><br><span class="line">	input1 += <span class="built_in">chr</span>(idx ^ value)</span><br><span class="line"><span class="built_in">print</span> input1</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°çš„è¾“å‡ºæ˜¯ Info:The first four chars are `flag`ã€‚ç¬¬äºŒéƒ¨åˆ†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE/2.png" alt="2019çº¢å¸½æ¯easyRE"></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">	target = base64.b64decode(target)</span><br><span class="line"><span class="built_in">print</span> target</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¾“å‡º <a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-254172.htm">[åŸåˆ›]çœ‹é›ªCTFä»å…¥é—¨åˆ°å­˜æ´»ï¼ˆå…­ï¼‰ä¸»åŠ¨é˜²å¾¡ </a>ï¼Œè®¿é—®è¯¥ç½‘ç«™å¯ä»¥åœ¨è¯„è®ºåŒºæ‰¾åˆ°å…¶ä»–é€‰æ‰‹å‘çš„ flagã€‚ä¸è¿‡å‡ºé¢˜äººçš„æœ¬æ„ä¸æ˜¯è¿™æ ·çš„ï¼Œåœ¨ elf ä¸­å¯ä»¥æ‰¾åˆ°è®¡ç®— flag çš„å‡½æ•°ã€‚è¯¥å‡½æ•°åœ¨ main å‡½æ•°è¿è¡Œç»“æŸåçš„ __libc_csu_fini å‡½æ•°ä¸­è¢«è°ƒç”¨ã€‚</p>
<p>ä¼—  æ‰€  å‘¨  çŸ¥ï¼Œelf ä» start å‡½æ•°å¼€å§‹æ‰§è¡Œï¼ˆç”± Entry point æŒ‡å®šï¼‰ï¼Œç„¶åæ‰§è¡Œé¡ºåºæ˜¯ __libc_start_main -&gt; __libc_csu_init -&gt; _init_array ä¸­çš„å‡½æ•° -&gt; main -&gt; __libc_csu_fini -&gt; _fini_array ä¸­çš„å‡½æ•°ã€‚</p>
<p>è¿™é“é¢˜çš„ start å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE/3.png" alt="2019çº¢å¸½æ¯easyRE"></p>
<p>_init_array åœ°å€å¯ä»¥åœ¨ __libc_csu_init å‡½æ•°ä¸­æ‰¾åˆ°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE/4.png" alt="2019çº¢å¸½æ¯easyRE"></p>
<p>ç¿»ä¸€ç¿» _init_array å’Œ _fini_array ä¸­çš„å‡½æ•°ï¼Œæ¯ä¸ªéƒ½ç‚¹è¿‡å» F5 çœ‹ä¸€ä¸‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE/5.png" alt="2019çº¢å¸½æ¯easyRE"></p>
<p>_fini_array çš„ç¬¬äºŒä¸ªå‡½æ•°æŒ‡é’ˆ sub_400D35 æœ€ä¸ºå¯ç–‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE/6.png" alt="2019çº¢å¸½æ¯easyRE"></p>
<p>ç»“åˆä¹‹å‰å¾—åˆ°çš„ä¿¡æ¯ Info:The first four chars are `flag`ï¼Œä¸éš¾æ¨æµ‹ v8 è¿™ä¸ªå››å­—èŠ‚å˜é‡çš„å€¼è¦æ‹¿ byte_6CC0A0 çš„å‰å››å­—èŠ‚æ¥ä¸ â€œflagâ€ é€å­—èŠ‚å¼‚æˆ–ã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;40 35 20 56 5D 18 22 45 17 2F 24 6E 62 3C 27 54 48 6C 24 6E 72 3C 32 45 5B&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line"></span><br><span class="line">xor = <span class="built_in">map</span>(<span class="built_in">ord</span>, <span class="string">&quot;flag&quot;</span>)</span><br><span class="line">key = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	key[i] = xor[i] ^ target[i]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">	flag += <span class="built_in">chr</span>(key[i%<span class="number">4</span>] ^ target[i])</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Youngter-drive-x86-exe-upx-èŠ±æŒ‡ä»¤"><a href="#Youngter-drive-x86-exe-upx-èŠ±æŒ‡ä»¤" class="headerlink" title="Youngter-drive | x86,exe,upx,èŠ±æŒ‡ä»¤"></a>Youngter-drive | x86,exe,upx,èŠ±æŒ‡ä»¤</h3><p>PS. è¿™é¢˜å‡ºçš„æœ‰é—®é¢˜ï¼Œoff_418004 å­—ç¬¦æ•°ç»„é•¿åº¦åº”è¯¥ä¸º 30ï¼Œå°‘çš„æœ€åé‚£ä¸ªå­—ç¬¦æ˜¯ â€˜yâ€™</p>
<p>å…ˆ <code>upx.exe -d</code> å¯¹ exe è¿›è¡Œè§£å‹ï¼Œida æ‰“å¼€ï¼Œå‘ç°è¿™ç©æ„å„¿è¿˜æ•´äº†ä¸ª TLS å›è°ƒæ¥æ£€æµ‹è°ƒè¯•å™¨ï¼Œæˆ‘æƒ³è¯´åŸ exe æˆ‘éƒ½è¿è¡Œä¸èµ·æ¥â€¦â€¦çœ‹çœ‹ main_0 å‡½æ•°çš„é€»è¾‘å§ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/1.png" alt="Youngter-drive"></p>
<p>StartAddress å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/2.png" alt="Youngter-drive"></p>
<p>sub_41119F å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/3.png" alt="Youngter-drive"></p>
<p>ä¸ºå•¥ä¸Šé¢ä¸¤å¼ å›¾ç‰‡çš„åˆ†è¾¨ç‡ä¸ä¸€æ ·å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºäº²çˆ±çš„å­¦æ ¡åˆåŒå’å•åœç”µäº†ï¼Œå°å¼æœºç›´æ¥æš´æ¯™ï¼Œåªèƒ½æ¢æˆç¬”è®°æœ¬ï¼Œæˆ‘ tm***</p>
<p>ä»è¿™ä¿©å‡½æ•°çš„è¡Œä¸ºå¯ä»¥åˆ¤æ–­å‡º StartAddress ä¸ sub_41119F å°†ä¼šäº¤æ›¿æ‰§è¡Œï¼Œä¸”çº¿ç¨‹ 1 ä¼šå…ˆæ‹¿åˆ°é”ï¼ˆä¿¡å·é‡ä¸é”æœºåˆ¶ï¼‰ã€‚å†æ¥ç ”ç©¶ä¸€ä¸‹ StartAddress ä¸­è°ƒç”¨çš„ sub_41112Cï¼Œè¿™ä¸ªå‡½æ•°åˆè°ƒç”¨äº† sub_411940ï¼Œè€Œ sub_411940 å› ä¸ºæ·»åŠ äº†èŠ±æŒ‡ä»¤å¯¼è‡´ ida æ— æ³•åç¼–è¯‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/4.png" alt="Youngter-drive"></p>
<p>æ‰¾æ‰¾æ˜¯å“ªé‡Œå‡ºé—®é¢˜äº†ï¼ŒOptions -&gt; General æ‰“å¼€æ ˆæŒ‡é’ˆã€æ˜¾ç¤ºå­—èŠ‚ç ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/5.png" alt="Youngter-drive"></p>
<p>æ‰¾åˆ°å¯¼è‡´ ida æ ˆè·Ÿè¸ªåˆ†æå‡ºé”™çš„èŠ±æŒ‡ä»¤ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/6.png" alt="Youngter-drive"></p>
<p>å°† <code>add esp, 8</code> nop æ‰å°±å¯ä»¥æ„‰å¿« F5 äº†ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ Alt + K è°ƒæ•´æ ˆæŒ‡é’ˆè¾¾åˆ°æ ˆå¹³è¡¡ï¼‰ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/7.png" alt="Youngter-drive"></p>
<p>åç¼–è¯‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Youngter-drive/8.png" alt="Youngter-drive"></p>
<p>è¿™ä¸ªå‡½æ•°å¹²çš„äº‹æƒ…å°±æ˜¯æŠŠè¾“å…¥çš„å¤§å†™å­—æ¯æ›¿æ¢æˆ off_418000[0] å­—ç¬¦æ•°ç»„ä¸­çš„å°å†™å­—æ¯ï¼ŒæŠŠè¾“å…¥çš„å°å†™å­—æ¯æ›¿æ¢æˆ off_418000[0] å­—ç¬¦æ•°ç»„ä¸­çš„å¤§å†™å­—æ¯ï¼Œè€Œä¸”æ˜¯éš”ä¸€ä¸ªå­—ç¬¦å¤„ç†ä¸€æ¬¡ï¼ˆä¸Šé¢åˆ†æè¿‡äº†ï¼‰</p>
<p>æœ€ååœ¨ sub_411190 -&gt; sub_411880 å‡½æ•°ä¸­åˆ¤æ–­å¤„ç†åçš„è¾“å…¥ä¸ off_418004 æ˜¯å¦é€å­—èŠ‚ç›¸ç­‰ï¼Œç„¶è€Œè¿™é‡Œé¢˜ç›®å‡ºé”™äº†ï¼Œoff_418004 å­—ç¬¦æ•°ç»„é•¿åº¦åº”è¯¥ä¸º 30ï¼Œå°‘çš„é‚£ä¸ªå­—ç¬¦æ˜¯ â€˜yâ€™ï¼Œä¸Šè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span> + <span class="string">&#x27;y&#x27;</span></span><br><span class="line">table = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line">target = <span class="built_in">map</span>(<span class="built_in">ord</span>, target)</span><br><span class="line">table = <span class="built_in">map</span>(<span class="built_in">ord</span>, table)</span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&#x27;&#x27;</span>] * <span class="built_in">len</span>(target)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">	<span class="keyword">if</span> i % <span class="number">2</span>:</span><br><span class="line">		<span class="keyword">if</span> target[i] &lt; <span class="number">97</span>:</span><br><span class="line">			flag[i] = <span class="built_in">chr</span>(table.index(target[i]) + <span class="number">96</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			flag[i] = <span class="built_in">chr</span>(table.index(target[i]) + <span class="number">38</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag[i] = <span class="built_in">chr</span>(target[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ACTFæ–°ç”Ÿèµ›2020-easyre-x86-exe-upx"><a href="#ACTFæ–°ç”Ÿèµ›2020-easyre-x86-exe-upx" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]easyre | x86,exe,upx"></a>[ACTFæ–°ç”Ÿèµ›2020]easyre | x86,exe,upx</h3><p><code>upx.exe -d</code> å¯¹ exe è¿›è¡Œè§£å‹ï¼Œida æ‰“å¼€æ‰¾åˆ° main å‡½æ•°ï¼Œé€»è¾‘å¾ˆç®€å•ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020easyre/1.png" alt="ACTFæ–°ç”Ÿèµ›2020easyre"></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">table = <span class="string">&quot;7E 7D 7C 7B 7A 79 78 77 76 75 74 73 72 71 70 6F 6E 6D 6C 6B 6A 69 68 67 66 65 64 63 62 61 60 5F 5E 5D 5C 5B 5A 59 58 57 56 55 54 53 52 51 50 4F 4E 4D 4C 4B 4A 49 48 47 46 45 44 43 42 41 40 3F 3E 3D 3C 3B 3A 39 38 37 36 35 34 33 32 31 30 2F 2E 2D 2C 2B 2A 29 28 27 26 25 24 23 20 21 22 00&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">table = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> table]</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0</span>] * <span class="number">12</span></span><br><span class="line">key[<span class="number">0</span>] = <span class="number">42</span></span><br><span class="line">key[<span class="number">1</span>] = <span class="number">70</span></span><br><span class="line">key[<span class="number">2</span>] = <span class="number">39</span></span><br><span class="line">key[<span class="number">3</span>] = <span class="number">34</span></span><br><span class="line">key[<span class="number">4</span>] = <span class="number">78</span></span><br><span class="line">key[<span class="number">5</span>] = <span class="number">44</span></span><br><span class="line">key[<span class="number">6</span>] = <span class="number">34</span></span><br><span class="line">key[<span class="number">7</span>] = <span class="number">40</span></span><br><span class="line">key[<span class="number">8</span>] = <span class="number">73</span></span><br><span class="line">key[<span class="number">9</span>] = <span class="number">63</span></span><br><span class="line">key[<span class="number">10</span>] = <span class="number">43</span></span><br><span class="line">key[<span class="number">11</span>] = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">list</span>(<span class="string">&quot;ACTF&#123;&quot;</span>) + [<span class="string">&#x27;&#x27;</span>] * <span class="number">12</span> + [<span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">	flag[<span class="number">5</span>+i] = <span class="built_in">chr</span>(table.index(key[i]) + <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ç›¸å†Œ-JVM-apk-nativeå±‚"><a href="#ç›¸å†Œ-JVM-apk-nativeå±‚" class="headerlink" title="ç›¸å†Œ | JVM,apk,nativeå±‚"></a>ç›¸å†Œ | JVM,apk,nativeå±‚</h3><p>Android Killer æ‰“å¼€ï¼Œå¾—çŸ¥å…¥å£ç±»æ˜¯ cn.baidujiayuan.ver5304.C1ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%9B%B8%E5%86%8C/1.png" alt="ç›¸å†Œ"></p>
<p>jadx æ‰“å¼€çœ‹çœ‹è¯¥ç±»çš„ onCreate æ–¹æ³•ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%9B%B8%E5%86%8C/2.png" alt="ç›¸å†Œ"></p>
<p>A2ã€M2ã€C2 è¿™å‡ ä¸ªç±»éƒ½æ¯”è¾ƒå¯ç–‘ï¼Œé¢˜ç›®è®©æ‰¾ email åœ°å€ï¼Œå°± C2 æ²¾ç‚¹è¾¹äº†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%9B%B8%E5%86%8C/3.png" alt="ç›¸å†Œ"></p>
<p>å³é”®è·³åˆ° NativeMethod çš„å£°æ˜å¤„ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%9B%B8%E5%86%8C/4.png" alt="ç›¸å†Œ"></p>
<p>éƒ½æ˜¯ native å±‚çš„æ–¹æ³•ï¼Œé‚£å°±æŠŠ so åº“æ‹¿å‡ºæ¥ï¼ˆapk åç¼€æ”¹æˆ zipï¼Œè§£å‹å so åº“åœ¨ lib ç›®å½•ä¸‹ï¼‰ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ª arm 32 ä½çš„ libcore.soã€‚ida æ‰“å¼€ï¼Œæ‰¾åˆ°æ–¹æ³• Java_com_net_cn_NativeMethod_mï¼ˆJNI å¼€å‘ç¼–è¯‘æ—¶ä¼šåœ¨æ–¹æ³•åå‰åŠ ä¸Šç±»çš„è·¯å¾„ï¼‰ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª base64 å­—ç¬¦ä¸²ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%9B%B8%E5%86%8C/5.png" alt="ç›¸å†Œ"></p>
<p>base64 è§£ç ä¸€ä¸‹å°±æ˜¯ flag</p>
<br>

<h3 id="SUCTF2019-SignIn-x86-elf-RSA"><a href="#SUCTF2019-SignIn-x86-elf-RSA" class="headerlink" title="[SUCTF2019]SignIn | x86,elf,RSA"></a>[SUCTF2019]SignIn | x86,elf,RSA</h3><p>main å‡½æ•°é€»è¾‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/SUCTF2019SignIn/1.png" alt="SUCTF2019SignIn"></p>
<p>ç”¨åˆ°äº†ä¸€äº› gmp å¤§æ•°è¿ç®—çš„å‡½æ•°ï¼š</p>
<ul>
<li>gmpz_init_set_str(buffer, str, radix) ï¼šå°†è¿›åˆ¶ä¸º radix çš„ str è¡¨ç¤ºçš„æ•°å­˜åˆ° buffer ä¸­å»</li>
<li>gmpz_powm(x, y, z)ï¼šreturn x**y % z</li>
</ul>
<p>ç»å…¸ RSA åŠ å¯†ï¼ŒæŠŠ mod åˆ†è§£æˆ p å’Œ qï¼Œç”¨ gmpy2 åº“è§£å¾—æ˜æ–‡ outputï¼ˆ<strong>python3 è¿è¡Œ</strong>ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line"></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">c = <span class="built_in">int</span>(<span class="string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, <span class="number">16</span>)</span><br><span class="line">plain = <span class="built_in">pow</span>(c, d, p * q)</span><br><span class="line">output = <span class="string">&quot;%x&quot;</span> % plain</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"><span class="comment"># 73756374667b50776e5f405f68756e647265645f79656172737d</span></span><br></pre></td></tr></table></figure>

<p>output æ˜¯ç»è¿‡ Encode å‡½æ•°ç¼–ç è¿‡çš„ï¼Œè¯¥å‡½æ•°æ¯æ¬¡å–æ¥è¾“å…¥çš„ä¸€ä¸ªå­—èŠ‚ï¼Œé«˜ 4 bit å’Œä½ 4 bit åˆ†åˆ«åˆ° byte_202010 å­—ç¬¦æ•°ç»„ä¸­å»æ˜ å°„ä¸ºæ–°çš„å­—ç¬¦ï¼Œå°†è¾“å…¥çš„ 32 å­—èŠ‚æ‰©å±•ä¸º 64 å­—èŠ‚çš„ outputï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/SUCTF2019SignIn/2.png" alt="SUCTF2019SignIn"></p>
<p>é€†å›å»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">output = <span class="string">&quot;73756374667b50776e5f405f68756e647265645f79656172737d&quot;</span></span><br><span class="line">flag = [<span class="string">&#x27;&#x27;</span>] * (<span class="built_in">len</span>(output) // <span class="number">2</span>)</span><br><span class="line">mapTable = <span class="string">&quot;30 31 32 33 34 35 36 37 38 39 61 62 63 64 65 66&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">mapTable = [<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">16</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> mapTable]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(output), <span class="number">2</span>):</span><br><span class="line">	high4Bit = mapTable.index(output[i])</span><br><span class="line">	low4Bit  = mapTable.index(output[i+<span class="number">1</span>])</span><br><span class="line">	curByte  = high4Bit &lt;&lt; <span class="number">4</span> | low4Bit</span><br><span class="line">	flag[i//<span class="number">2</span>] = <span class="built_in">chr</span>(curByte)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ACTFæ–°ç”Ÿèµ›2020-rome-x86-exe-æºæ’’å¯†ç "><a href="#ACTFæ–°ç”Ÿèµ›2020-rome-x86-exe-æºæ’’å¯†ç " class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]rome | x86,exe,æºæ’’å¯†ç "></a>[ACTFæ–°ç”Ÿèµ›2020]rome | x86,exe,æºæ’’å¯†ç </h3><p>æºæ’’å¯†ç ï¼Œé€»è¾‘ç®€å•ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020rome/1.png" alt="ACTFæ–°ç”Ÿèµ›2020rome"></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">target = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">target[<span class="number">0</span>] = <span class="number">81</span></span><br><span class="line">target[<span class="number">1</span>] = <span class="number">115</span></span><br><span class="line">target[<span class="number">2</span>] = <span class="number">119</span></span><br><span class="line">target[<span class="number">3</span>] = <span class="number">51</span></span><br><span class="line">target[<span class="number">4</span>] = <span class="number">115</span></span><br><span class="line">target[<span class="number">5</span>] = <span class="number">106</span></span><br><span class="line">target[<span class="number">6</span>] = <span class="number">95</span></span><br><span class="line">target[<span class="number">7</span>] = <span class="number">108</span></span><br><span class="line">target[<span class="number">8</span>] = <span class="number">122</span></span><br><span class="line">target[<span class="number">9</span>] = <span class="number">52</span></span><br><span class="line">target[<span class="number">10</span>] = <span class="number">95</span></span><br><span class="line">target[<span class="number">11</span>] = <span class="number">85</span></span><br><span class="line">target[<span class="number">12</span>] = <span class="number">106</span></span><br><span class="line">target[<span class="number">13</span>] = <span class="number">119</span></span><br><span class="line">target[<span class="number">14</span>] = <span class="number">64</span></span><br><span class="line">target[<span class="number">15</span>] = <span class="number">108</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">list</span>(<span class="string">&quot;ACTF&#123;&quot;</span>) + [<span class="string">&#x27;&#x27;</span>] * <span class="number">16</span> + [<span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= target[i] &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> string.uppercase:</span><br><span class="line">			<span class="keyword">if</span> target[i] == (<span class="built_in">ord</span>(j) - <span class="number">51</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>):</span><br><span class="line">				flag[i+<span class="number">5</span>] = j</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= target[i] &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> string.lowercase:</span><br><span class="line">			<span class="keyword">if</span> target[i] == (<span class="built_in">ord</span>(j) - <span class="number">79</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>):</span><br><span class="line">				flag[i+<span class="number">5</span>] = j</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag[i+<span class="number">5</span>] = <span class="built_in">chr</span>(target[i])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="GUET-CTF2019-re-x86-elf-upx"><a href="#GUET-CTF2019-re-x86-elf-upx" class="headerlink" title="[GUET-CTF2019]re | x86,elf,upx"></a>[GUET-CTF2019]re | x86,elf,upx</h3><p>PS. é¢˜ç›®æœ‰è¯¯ï¼Œflag[6] = â€˜1â€™</p>
<p>upx è§£å‹ä»¥åï¼Œida æ‰“å¼€ï¼Œshift + F12 æŸ¥æ‰¾ â€œinput your flagâ€ å­—ç¬¦ä¸²çš„äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ° main å‡½æ•°ï¼ˆæˆ–è€…å¯ä»¥é€šè¿‡ start å‡½æ•°ç›´æ¥æ‰¾ï¼‰ï¼Œé€»è¾‘å¾ˆç®€å•ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUET-CTF2019re/1.png" alt="GUET-CTF2019re"></p>
<p>Check å‡½æ•°å¯¹è¾“å…¥çš„æ¯ä¸€å­—èŠ‚è¿›è¡Œæ£€æŸ¥ï¼Œé™¤å›å»å°±èƒ½å¾—åˆ° flag äº†ï¼Œè¿™é‡Œé¢˜ç›®å°‘äº†ä¸€ä¸ªæ¡ä»¶å¯¼è‡´ flag[6] æ— æ³•ç¡®å®šï¼Œç»å°è¯•å flag[6] = â€˜1â€™ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line">flag[<span class="number">0</span>] = <span class="number">166163712</span> / <span class="number">1629056</span></span><br><span class="line">flag[<span class="number">1</span>] = <span class="number">731332800</span> / <span class="number">6771600</span></span><br><span class="line">flag[<span class="number">2</span>] = <span class="number">357245568</span> / <span class="number">3682944</span></span><br><span class="line">flag[<span class="number">3</span>] = <span class="number">1074393000</span> / <span class="number">10431000</span></span><br><span class="line">flag[<span class="number">4</span>] = <span class="number">489211344</span> / <span class="number">3977328</span></span><br><span class="line">flag[<span class="number">5</span>] = <span class="number">518971936</span> / <span class="number">5138336</span></span><br><span class="line">flag[<span class="number">6</span>] = <span class="built_in">ord</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">flag[<span class="number">7</span>] = <span class="number">406741500</span> / <span class="number">7532250</span></span><br><span class="line">flag[<span class="number">8</span>] = <span class="number">294236496</span> / <span class="number">5551632</span></span><br><span class="line">flag[<span class="number">9</span>] = <span class="number">177305856</span> / <span class="number">3409728</span></span><br><span class="line">flag[<span class="number">10</span>] = <span class="number">650683500</span> / <span class="number">13013670</span></span><br><span class="line">flag[<span class="number">11</span>] = <span class="number">298351053</span> / <span class="number">6088797</span></span><br><span class="line">flag[<span class="number">12</span>] = <span class="number">386348487</span> / <span class="number">7884663</span></span><br><span class="line">flag[<span class="number">13</span>] = <span class="number">438258597</span> / <span class="number">8944053</span></span><br><span class="line">flag[<span class="number">14</span>] = <span class="number">249527520</span> / <span class="number">5198490</span></span><br><span class="line">flag[<span class="number">15</span>] = <span class="number">445362764</span> / <span class="number">4544518</span></span><br><span class="line">flag[<span class="number">17</span>] = <span class="number">174988800</span> / <span class="number">3645600</span></span><br><span class="line">flag[<span class="number">16</span>] = <span class="number">981182160</span> / <span class="number">10115280</span></span><br><span class="line">flag[<span class="number">18</span>] = <span class="number">493042704</span> / <span class="number">9667504</span></span><br><span class="line">flag[<span class="number">19</span>] = <span class="number">257493600</span> / <span class="number">5364450</span></span><br><span class="line">flag[<span class="number">20</span>] = <span class="number">767478780</span> / <span class="number">13464540</span></span><br><span class="line">flag[<span class="number">21</span>] = <span class="number">312840624</span> / <span class="number">5488432</span></span><br><span class="line">flag[<span class="number">22</span>] = <span class="number">1404511500</span> / <span class="number">14479500</span></span><br><span class="line">flag[<span class="number">23</span>] = <span class="number">316139670</span> / <span class="number">6451830</span></span><br><span class="line">flag[<span class="number">24</span>] = <span class="number">619005024</span> / <span class="number">6252576</span></span><br><span class="line">flag[<span class="number">25</span>] = <span class="number">372641472</span> / <span class="number">7763364</span></span><br><span class="line">flag[<span class="number">26</span>] = <span class="number">373693320</span> / <span class="number">7327320</span></span><br><span class="line">flag[<span class="number">27</span>] = <span class="number">498266640</span> / <span class="number">8741520</span></span><br><span class="line">flag[<span class="number">28</span>] = <span class="number">452465676</span> / <span class="number">8871876</span></span><br><span class="line">flag[<span class="number">29</span>] = <span class="number">208422720</span> / <span class="number">4086720</span></span><br><span class="line">flag[<span class="number">30</span>] = <span class="number">515592000</span> / <span class="number">9374400</span></span><br><span class="line">flag[<span class="number">31</span>] = <span class="number">719890500</span> / <span class="number">5759124</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">map</span>(<span class="built_in">chr</span>, flag)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="FlareOn4-login-javascript"><a href="#FlareOn4-login-javascript" class="headerlink" title="[FlareOn4]login | javascript"></a>[FlareOn4]login | javascript</h3><p>åˆæ˜¯ä¸€ä¸ªèµ°é”™ç‰‡åœºçš„é¢˜ç›®ï¼Œæ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ htmlï¼Œå¯ä»¥çœ‹åˆ°ä¸€æ®µ javascript å†™çš„æ£€æŸ¥ flag çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span><br><span class="line">	<span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span><br><span class="line">	<span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span><br><span class="line">		alert(<span class="string">&quot;Correct flag!&quot;</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ‰€æœ‰å¤§å°å†™ï¼Œå°†å…¶ â€œå³ç§»â€ 13 ä½ï¼Œå¦¥å¦¥çš„æºæ’’åŠ å¯†ï¼Œæ‡’å¾—å†™è„šæœ¬äº†ï¼Œä¸Š <a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">ç½‘ç«™</a></p>
<br>

<h3 id="V-amp-N2020-å…¬å¼€èµ›-strangeCpp-x86-exe"><a href="#V-amp-N2020-å…¬å¼€èµ›-strangeCpp-x86-exe" class="headerlink" title="[V&amp;N2020 å…¬å¼€èµ›]strangeCpp | x86,exe"></a>[V&amp;N2020 å…¬å¼€èµ›]strangeCpp | x86,exe</h3><p>shift +F12ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸² â€œflag{â€¦}â€ çš„äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°å‡½æ•° sub_140013AA0ï¼Œå¼€å¤´æœ‰ä¸€ä¸² putchar è¾“å‡º welcome çš„åœ°æ–¹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/VN2020%E5%85%AC%E5%BC%80%E8%B5%9BstrangeCpp/1.png" alt="VN2020å…¬å¼€èµ›strangeCpp"></p>
<p>éšä¾¿ç‚¹ä¸€ä¸ª byte_â€¦ è·Ÿè¿‡å»ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªé•¿åº¦ä¸º 17 çš„å¯ç–‘å­—ç¬¦æ•°ç»„ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/VN2020%E5%85%AC%E5%BC%80%E8%B5%9BstrangeCpp/2.png" alt="VN2020å…¬å¼€èµ›strangeCpp"></p>
<p>æŸ¥æ‰¾äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°å…³é”®å‡½æ•° sub_140013580ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/VN2020%E5%85%AC%E5%BC%80%E8%B5%9BstrangeCpp/3.png" alt="VN2020å…¬å¼€èµ›strangeCpp"></p>
<p>é€šè¿‡ <code>result == 607052314</code>ï¼Œä¸é€†å‘ sub_140011384 å‡½æ•°å¯ä»¥ç¡®å®š key çš„å€¼ï¼Œsub_140011384 é€»è¾‘å¦‚ä¸‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/VN2020%E5%85%AC%E5%BC%80%E8%B5%9BstrangeCpp/4.png" alt="VN2020å…¬å¼€èµ›strangeCpp"></p>
<p>çˆ†ç ´å‘—ï¼Œå› ä¸º python çš„ int ç±»å‹æ²¡æœ‰ä½æ•°é™åˆ¶ï¼Œåœ¨å·¦ç§» 8 ä½å’Œä¹˜ 291 æ—¶éƒ½ä¸å­˜åœ¨æˆªæ–­å’Œæº¢å‡ºï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨ç»™ä»–æˆªæ–­ä¸€ä¸‹ï¼ˆ&amp; 0xFFFFFFFFï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14549744</span>):</span><br><span class="line">	<span class="keyword">if</span> ((i &lt;&lt; <span class="number">8</span>) ^ (i &gt;&gt; <span class="number">12</span>)) * <span class="number">291</span> &amp; <span class="number">0xFFFFFFFF</span> == <span class="number">607052314</span>:</span><br><span class="line">		key = i</span><br><span class="line">		<span class="built_in">print</span> <span class="string">&quot;Key: &quot;</span> + <span class="built_in">str</span>(key)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;26 2C 21 27 3B 0D 04 75 68 34 28 25 0E 35 2D 69 3D&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">table = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> table]</span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&#x27;&#x27;</span>] * <span class="built_in">len</span>(table)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">	flag[i] = <span class="built_in">chr</span>(table[i] ^ key &amp; <span class="number">0xFF</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(flag)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä¸º</p>
<ul>
<li>Key: 123456</li>
<li>flag{MD5(theNum)}</li>
</ul>
<p>md5 ä¸€ä¸‹ key å°±æ˜¯ flag äº†</p>
<br>

<h3 id="BJDCTF2020-easy-x86-exe-patch"><a href="#BJDCTF2020-easy-x86-exe-patch" class="headerlink" title="[BJDCTF2020]easy | x86,exe,patch"></a>[BJDCTF2020]easy | x86,exe,patch</h3><p>main å‡½æ•°å•¥äº‹æ²¡å¹²ï¼Œå‡½æ•°åˆ—è¡¨é‡Œç¿»ä¸€ç¿»ï¼Œæ‰¾åˆ°ä¸€ä¸ªå¯ç–‘å‡½æ•° quesã€‚åˆ†æåå‘ç°è¯¥å‡½æ•°ä¸è¦æ±‚è¾“å…¥ï¼Œå´åœ¨ä¸åœè¾“å‡ºï¼Œé‚£å°±åœ¨ main é‡Œ patch ä¸€ä¸‹ï¼Œè®©æ‰§è¡Œæµé¡ºè·¯æ‰§è¡Œè¯¥å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2020easy/1.png" alt="BJDCTF2020easy"></p>
<p>è¿è¡Œä¸€ä¸‹å¾—åˆ° flagï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2020easy/2.png" alt="BJDCTF2020easy"></p>
<p>ä¸ patch ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œexe ä¹Ÿæ²¡æœ‰å¼€åŸºå€é‡å®šä½ï¼ŒOD åŠ¨æ€è°ƒè¯•æ—¶ç›´æ¥ä¿®æ”¹ eip åˆ°è¯¥å‡½æ•°å³å¯</p>
<br>

<h3 id="ACTFæ–°ç”Ÿèµ›2020-usualCrypt-x86-exe-å˜ç§base64"><a href="#ACTFæ–°ç”Ÿèµ›2020-usualCrypt-x86-exe-å˜ç§base64" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]usualCrypt | x86,exe,å˜ç§base64"></a>[ACTFæ–°ç”Ÿèµ›2020]usualCrypt | x86,exe,å˜ç§base64</h3><p>main å‡½æ•°é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯å°†è¾“å…¥ä¸¢åˆ° sub_401080 å‡½æ•°å¤„ç†ï¼Œç»“æœä¸ byte_40E0E4 å­—ç¬¦æ•°ç»„é€å­—èŠ‚æ¯”è¾ƒã€‚</p>
<p>sub_401080 å‡½æ•°ä¸»ä½“æ˜¯ä¸ª base64 ç¼–ç ï¼Œè¿™ä¸€ç‚¹ä»ç¼–ç è¡¨ byte_40E0A0 ä¸éš¾çœ‹å‡ºã€‚ä½†æ˜¯åœ¨ç¼–ç å¼€å§‹å‰ï¼Œè¯¥å‡½æ•°è°ƒç”¨äº† sub_401000 å¯¹ç¼–ç è¡¨è¿›è¡Œäº†å˜æ¢ï¼ŒOD å¯ä»¥è°ƒå‡ºæ¥ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020usualCrypt/1.png" alt="ACTFæ–°ç”Ÿèµ›2020usualCrypt"></p>
<p>ç¼–ç ç»“æŸåï¼Œè°ƒç”¨ sub_401030 å¯¹ç¼–ç çš„ç»“æœè¿›è¡Œå¤§å°å†™çš„ç¿»è½¬ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020usualCrypt/2.png" alt="ACTFæ–°ç”Ÿèµ›2020usualCrypt"></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">new_table = <span class="string">&quot;ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">target = <span class="string">&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;</span></span><br><span class="line"></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> target:</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">		tmp = <span class="built_in">ord</span>(i) - <span class="number">32</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">&#x27;A&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">		tmp = <span class="built_in">ord</span>(i) + <span class="number">32</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		tmp = <span class="built_in">ord</span>(i)</span><br><span class="line">	res += <span class="built_in">chr</span>(tmp)</span><br><span class="line"></span><br><span class="line">general = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">	general += old_table[new_table.find(i)]</span><br><span class="line"><span class="built_in">print</span> base64.b64decode(general)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="V-amp-N2020-å…¬å¼€èµ›-CSRe-x86-exe-NET-æ··æ·†"><a href="#V-amp-N2020-å…¬å¼€èµ›-CSRe-x86-exe-NET-æ··æ·†" class="headerlink" title="[V&amp;N2020 å…¬å¼€èµ›]CSRe | x86,exe,.NET,æ··æ·†"></a>[V&amp;N2020 å…¬å¼€èµ›]CSRe | x86,exe,.NET,æ··æ·†</h3><p>æ€ä¹ˆçœ‹å‡ºæœ‰æ··æ·†çš„å‘¢ï¼Ÿç”¨ Reflector æ‰“å¼€åå‘ç°ç±»åéƒ½æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œè¿˜æœ‰ä¸€å †è«åå…¶å¦™çš„è®¡ç®—å‡½æ•°ï¼Œç»éªŒå‘Šè¯‰æˆ‘å®ƒè¢«æ··æ·†äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨è¯¸å¦‚ Exeinfo PE è¿™æ ·çš„å·¥å…·æ¥æ£€æŸ¥</p>
<p>.NET æ¡†æ¶çš„ç¨‹åºå»æ··æ·†éœ€è¦ç”¨åˆ° <strong>de4dot</strong>ï¼Œä½ å¯ä»¥åœ¨ <a target="_blank" rel="noopener" href="https://github.com/de4dot/de4dot">github</a> ä¸‹è½½æºç æ¥ç¼–è¯‘æœ€æ–°ç‰ˆï¼Œä¹Ÿå¯ä»¥ä¸‹è½½åˆ«äººå·²ç»ç¼–è¯‘å¥½çš„ <a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1045680-1-1.html">ç¨æ—§ä¸€äº›çš„ç‰ˆæœ¬</a>ï¼Œä½¿ç”¨æ–¹æ³•å°±æ˜¯ <code>de4dot.exe xxx.exe</code>ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ xxx-cleaned.exe</p>
<p>å»æ··æ·†åå†ç”¨ Reflector æ‰“å¼€ï¼Œæ‰¾åˆ° main å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/VN2020%E5%85%AC%E5%BC%80%E8%B5%9BCSRe/1.png" alt="VN2020å…¬å¼€èµ›CSRe"></p>
<p>ä¸¤ä¸ª sha1 æ‹¿å»ç½‘ç«™ä¸€æŸ¥ï¼Œä¸€ä¸ªæ˜¯ 314159ï¼Œå¦ä¸€ä¸ªæ˜¯ returnï¼Œæ‰€ä»¥ str å’Œ str2 åˆ†åˆ«æ˜¯ 1415 å’Œ turn</p>
<br>

<h3 id="MRCTF2020-Transform-x86-exe"><a href="#MRCTF2020-Transform-x86-exe" class="headerlink" title="[MRCTF2020]Transform | x86,exe"></a>[MRCTF2020]Transform | x86,exe</h3><p>main é€»è¾‘æŒºç®€å•çš„ï¼Œç›´æ¥ä¸Šè„šæœ¬å§ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;67 79 7B 7F 75 2B 3C 52 53 79 57 5E 5D 42 7B 2D 2A 66 42 7E 4C 57 79 41 6B 7E 65 3C 5C 45 6F 62 4D&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line">table = [<span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">3</span>, <span class="number">17</span>, <span class="number">32</span>, <span class="number">29</span>, <span class="number">11</span>, <span class="number">30</span>, <span class="number">27</span>, <span class="number">22</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">2</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">31</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">14</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">33</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">	flag[table[i]] = table[i] ^ target[i]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, flag))</span><br></pre></td></tr></table></figure>

<br>

<h3 id="GWCTF-2019-xxor-x86-elf-tea"><a href="#GWCTF-2019-xxor-x86-elf-tea" class="headerlink" title="[GWCTF 2019]xxor | x86,elf,tea"></a>[GWCTF 2019]xxor | x86,elf,tea</h3><p>main å‡½æ•°åˆ†æå¹¶è¿˜åŸç¬¦å·ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GWCTF2019xxor/1.png" alt="GWCTF2019xxor"></p>
<p>æ™®é€š tea è§£å¯†å¾ˆç®€å•ï¼Œå®Œå…¨åè¿‡æ¥å°±è¡Œï¼ˆC++ 32ä½ï¼‰ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TeaDecode</span><span class="params">(<span class="keyword">unsigned</span>* cipher, <span class="keyword">unsigned</span>* key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum&#123; <span class="number">0x458BCD42</span> * <span class="number">64</span> &#125;;</span><br><span class="line">	<span class="keyword">unsigned</span> lowWord = *cipher;</span><br><span class="line">	<span class="keyword">unsigned</span> highWord = cipher[<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		highWord -= (lowWord + sum + <span class="number">20</span>) ^ ((lowWord &lt;&lt; <span class="number">6</span>) + key[<span class="number">2</span>]) ^ ((lowWord &gt;&gt; <span class="number">9</span>) + key[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">		lowWord -= (highWord + sum + <span class="number">11</span>) ^ ((highWord &lt;&lt; <span class="number">6</span>) + *key) ^ ((highWord &gt;&gt; <span class="number">9</span>) + key[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">		sum -= <span class="number">0x458BCD42</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	*cipher = lowWord;</span><br><span class="line">	cipher[<span class="number">1</span>] = highWord;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Check å‡½æ•°è§£ä¸€ä¸ªä¸‰å…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼ˆæ³¨æ„æº¢å‡ºä¸æˆªæ–­ï¼‰ï¼š<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GWCTF2019xxor/2.png" alt="GWCTF2019xxor"></p>
<p>æœ‰ï¼š</p>
<ul>
<li>target[2] = 3774025685</li>
<li>target[3] = 1548802262</li>
<li>target[4] = 2652626477</li>
</ul>
<p>è„šæœ¬ï¼ˆC++ 32ä½ï¼‰ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> target[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">	target[<span class="number">2</span>] = <span class="number">3774025685</span>;</span><br><span class="line">	target[<span class="number">3</span>] = <span class="number">1548802262</span>;</span><br><span class="line">	target[<span class="number">4</span>] = <span class="number">2652626477</span>;</span><br><span class="line"></span><br><span class="line">	target[<span class="number">0</span>] = <span class="number">0xDF48EF7E</span>;</span><br><span class="line">	target[<span class="number">5</span>] = <span class="number">0x84F30420</span>;</span><br><span class="line">	target[<span class="number">1</span>] = <span class="number">0x20CAACF4</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">unsigned</span> key[]&#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="built_in">TeaDecode</span>(target + i, key);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">unsigned</span> i : target) &#123;</span><br><span class="line">		std::cout &lt;&lt; std::hex &lt;&lt; i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä¸º 666c61677b72655f69735f6772656174217dï¼Œpython2 ä¸­ decode(â€œhexâ€) ä¸€ä¸‹å¾—åˆ° flag</p>
<br>

<h3 id="HDCTF2019-Maze-x86-exe-upx-maze"><a href="#HDCTF2019-Maze-x86-exe-upx-maze" class="headerlink" title="[HDCTF2019]Maze | x86,exe,upx,maze"></a>[HDCTF2019]Maze | x86,exe,upx,maze</h3><p>upx è§£å‹ç¼©åï¼Œmain å‡½æ•°ç”±äºå­˜åœ¨èŠ±æŒ‡ä»¤ï¼Œå¯¼è‡´ ida æ— æ³•è§£æï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/HDCTF2019Maze/1.png" alt="HDCTF2019Maze"></p>
<p>Undefine ä»¥åå°† 0xE8 nop æ‰</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/HDCTF2019Maze/2.png" alt="HDCTF2019Maze"></p>
<p>åœ¨ 0x90 å¤„æŒ‰ â€˜câ€™ å°†æ•°æ®å¼ºè½¬æˆä»£ç ï¼Œä¹‹ååœ¨ main å‡½æ•°å¼€å§‹å¤„æŒ‰ â€˜pâ€™ å½¢æˆå‡½æ•°ï¼Œå°±å¯ä»¥ F5 äº†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/HDCTF2019Maze/3.png" alt="HDCTF2019Maze"></p>
<p>åç¼–è¯‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/HDCTF2019Maze/4.png" alt="HDCTF2019Maze"></p>
<p>ç”±äºæ²¡æœ‰å¯¹è¿·å®«çš„ç‚¹æ˜¯å¦å¯ä»¥é€šè¡Œè¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥å­˜åœ¨å¾ˆå¤šç§è·¯å¾„éƒ½è¾“å‡ºç­”æ¡ˆæ­£ç¡®çš„æƒ…å†µ</p>
<p>shift + F12 å¯ä»¥æ‰¾åˆ°é•¿åº¦ä¸º 70 çš„è¿·å®«ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/HDCTF2019Maze/5.png" alt="HDCTF2019Maze"></p>
<p>å½“é¡¶è¾¹ * ä¾§è¾¹ä¸º 10 * 7 æ—¶ï¼Œæ»¡è¶³ç»ˆç‚¹åœ¨ (5ï¼Œ-4) çš„è¦æ±‚ï¼Œè¿˜åŸäºŒç»´è¿·å®«ï¼š<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/HDCTF2019Maze/6.png" alt="HDCTF2019Maze"></p>
<p>æ‰€ä»¥æ­£ç¡®çš„è·¯å¾„ä¸º ssaaasaassdddw</p>
<br>

<h3 id="BJDCTF2020-BJD-hamburger-competition-x86-exe-NET-Unityæ¸¸æˆ"><a href="#BJDCTF2020-BJD-hamburger-competition-x86-exe-NET-Unityæ¸¸æˆ" class="headerlink" title="[BJDCTF2020]BJD hamburger competition | x86,exe,.NET,Unityæ¸¸æˆ"></a>[BJDCTF2020]BJD hamburger competition | x86,exe,.NET,Unityæ¸¸æˆ</h3><p>ä½œè€…è„‘æ´å¯ä»¥å—·ã€‚ç©è¿‡ Unity æ¸¸æˆå¼€å‘çš„åº”è¯¥æ¸…æ¥šï¼Œç”Ÿæˆæ¸¸æˆæ—¶ï¼Œå¼€å‘è€…å†™çš„æ‰€æœ‰ C# ç±»ä¼šè¢«æ•´åˆç¼–è¯‘åˆ° <strong>Assembly-CSharp.dll</strong> é‡Œï¼Œè¯¥åŠ¨æ€é“¾æ¥åº“æ‰€åœ¨çš„è·¯å¾„æ˜¯ xxx_Data\Managedï¼Œå…¶ä¸­ xxx ä¸ºæ¸¸æˆåã€‚</p>
<p>è¿™é¢˜çš„ dll å°±åœ¨ BJD hamburger competition_Data\Managed ç›®å½•ä¸‹ï¼ŒReflector æ‰“å¼€è¯¥ dllï¼Œåœ¨ ButtonSpawnFruit ç±»ä¸­æ‰¾åˆ° Spawn æ–¹æ³•ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2020BJDhamburgercompetition/1.png" alt="BJDCTF2020BJDhamburgercompetition"></p>
<p>ç½‘ç«™ä¸ŠæŸ¥ä¸‹è¿™ä¸ª sha1ï¼Œå¾—åˆ° 1001ï¼Œå…ˆçœ‹çœ‹ä»–å†™çš„ Md5ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/BJDCTF2020BJDhamburgercompetition/2.png" alt="BJDCTF2020BJDhamburgercompetition"></p>
<p>é‚£å°±å– 1001 çš„ md5 å¤§å†™å‰ 20 ä¸ªå­—ç¬¦ä½œä¸º flag</p>
<br>

<h3 id="WUSTCTF2020-level1-x86-elf"><a href="#WUSTCTF2020-level1-x86-elf" class="headerlink" title="[WUSTCTF2020]level1 | x86,elf"></a>[WUSTCTF2020]level1 | x86,elf</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	data = f.read().split(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">data = <span class="built_in">map</span>(<span class="built_in">int</span>, data)</span><br><span class="line">data = [<span class="number">0</span>] + data</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">	<span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(data[i] &gt;&gt; i)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(data[i] / i)</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="WUSTCTF2020-level2-x86-elf-upx"><a href="#WUSTCTF2020-level2-x86-elf-upx" class="headerlink" title="[WUSTCTF2020]level2 | x86,elf,upx"></a>[WUSTCTF2020]level2 | x86,elf,upx</h3><p>upx è§£å‹ç¼©åï¼Œmain å‡½æ•°çš„æ±‡ç¼–ä¸­å¯ä»¥çœ‹åˆ° flag</p>
<br>

<h3 id="crackMe-x86-exe-åè°ƒè¯•"><a href="#crackMe-x86-exe-åè°ƒè¯•" class="headerlink" title="crackMe | x86,exe,åè°ƒè¯•"></a>crackMe | x86,exe,åè°ƒè¯•</h3><p>æ•´ç†ä¸€ä¸‹ main å‡½æ•°çš„é€»è¾‘ï¼Œæ ¹æ®å„å˜é‡ã€å‡½æ•°è¡Œä¸ºç»™ä»–ä»¬åŠ ç¬¦å·ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/1.png" alt="crackMe"></p>
<p>CheckValid å‡½æ•°åŸºæœ¬æ²¡å•¥ç”¨ï¼Œç”¨æ¥æ£€æµ‹è¾“å…¥é•¿åº¦å’Œè¾“å…¥å­—ç¬¦çš„åˆæ³•æ€§ï¼ŒPreparePrint å‡½æ•°å‡†å¤‡è¾“å‡ºï¼ŒCongratulation å­˜æ”¾åœ¨ v7ï¼Œå¤±è´¥çš„å­—ç¬¦ä¸²å­˜æ”¾åœ¨ v5ã€‚PrepareTable å‡½æ•°é€šè¿‡è¾“å…¥çš„ user æ¥å˜æ¢åŠ å¯†è¡¨ï¼Œè¯¥å‡½æ•°å¯ä»¥é€šè¿‡ python æ¨¡æ‹Ÿï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PrepareTable</span>(<span class="params">user</span>):</span></span><br><span class="line">	user  = <span class="built_in">map</span>(<span class="built_in">ord</span>, user)</span><br><span class="line">	table = <span class="built_in">range</span>(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">	v5, v9, v6 = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> v5 &lt; <span class="number">256</span>:</span><br><span class="line">		v3 = table[v5]</span><br><span class="line">		v9 = (v9 + v3 + user[v6 % <span class="built_in">len</span>(user)]) &amp; <span class="number">0xFF</span></span><br><span class="line">		v4 = table[v9]</span><br><span class="line">		table[v9] = v3</span><br><span class="line">		table[v5] = v4</span><br><span class="line">		v5 += <span class="number">1</span></span><br><span class="line">		v6 += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> table</span><br><span class="line"></span><br><span class="line">userName = <span class="string">&quot;welcomebeijing&quot;</span></span><br><span class="line">table = PrepareTable(userName)</span><br></pre></td></tr></table></figure>

<p>CheckPassword å‡½æ•°é‡Œé¢æœ‰ä¸‰å¤„åè°ƒè¯•ï¼Œæ£€æµ‹åˆ°æœ‰è°ƒè¯•ç—•è¿¹æ—¶ï¼Œä¼šè¿›å…¥è¯¯å¯¼çš„åˆ†æ”¯ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/2.png" alt="crackMe"></p>
<p>æŠŠå®ƒä»¬ patch æ‰ä»¥åï¼Œå…ˆæ¥çœ‹ä¸Šé¢çš„ while å¾ªç¯ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/3.png" alt="crackMe"></p>
<p>å¥½éº»çƒ¦ï¼Œä¸æƒ³é™æ€åˆ†æäº†ï¼Œä¸Š OD å§ï¼Œå¯†ç ä¸€æ è¾“ 1234abcdABCDï¼Œç­‰ while è·³å‡ºçœ‹çœ‹ v15 é‡Œçš„å€¼ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/4.png" alt="crackMe"></p>
<p>å¯ä»¥çœ‹åˆ° 12 ä¸ªå­—ç¬¦å˜æˆäº† 6 ä¸ªå­—èŠ‚ï¼Œæ¯ä¸¤ä¸ªå­—ç¬¦å‡‘æˆä¸€ä¸ªå­—èŠ‚ã€‚ä¸‹ä¸€ä¸ª while å¾ªç¯ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/5.png" alt="crackMe"></p>
<p>å…¶ä¸­ sub_401710 å‡½æ•°ç»è¿‡åŠ¨æ€è°ƒè¯•åå‘ç°ä¸ä¼šå¯¹ target æ•°ç»„æˆ–è€… user äº§ç”Ÿä»»ä½•å½±å“ï¼Œè¯¥å¾ªç¯å¹²çš„äº‹å°±æ˜¯ç»™é•¿åº¦ä¸º 8 çš„ target æ•°ç»„èµ‹å€¼ï¼Œæ¯æ¬¡èµ‹å€¼ä¸€å­—èŠ‚ï¼Œæ ¹æ®ä¸Šä¸€ä¸ª while å¾ªç¯å¯ä»¥æ¨å‡ºè¾“å…¥çš„å¯†ç é•¿åº¦ä¸º 16ã€‚</p>
<p>æœ€åçš„ sub_401470 å‡½æ•°ç”¨æ¥æ£€æŸ¥ target æ•°ç»„æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/6.png" alt="crackMe"></p>
<p>è¯¥å‡½æ•°å¯¹ target æ•°ç»„è¿›è¡Œé€å­—èŠ‚æ£€æŸ¥ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/crackMe/7.png" alt="crackMe"></p>
<p>éœ€è¦æ³¨æ„ï¼Œåœ¨æ£€æŸ¥ target[5] æ—¶å­˜åœ¨åè°ƒè¯•çš„æ··æ·†ä¿¡æ¯ã€‚ç”±æ­¤å‡½æ•°å¯å¾— target = [100, 98, 97, 112, 112, 115, 101, 99]ï¼Œå†é€†ä¸€ä¸‹ç¬¬äºŒä¸ª while å¾ªç¯å³å¯å¾—åˆ° passwordï¼Œå®Œæ•´è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PrepareTable</span>(<span class="params">user</span>):</span></span><br><span class="line">	user  = <span class="built_in">map</span>(<span class="built_in">ord</span>, user)</span><br><span class="line">	table = <span class="built_in">range</span>(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">	v5, v9, v6 = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> v5 &lt; <span class="number">256</span>:</span><br><span class="line">		v3 = table[v5]</span><br><span class="line">		v9 = (v9 + v3 + user[v6 % <span class="built_in">len</span>(user)]) &amp; <span class="number">0xFF</span></span><br><span class="line">		v4 = table[v9]</span><br><span class="line">		table[v9] = v3</span><br><span class="line">		table[v5] = v4</span><br><span class="line">		v5 += <span class="number">1</span></span><br><span class="line">		v6 += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> table</span><br><span class="line"></span><br><span class="line">userName = <span class="string">&quot;welcomebeijing&quot;</span></span><br><span class="line">table = PrepareTable(userName)</span><br><span class="line"></span><br><span class="line">target = [<span class="number">100</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">112</span>, <span class="number">112</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">99</span>]</span><br><span class="line"></span><br><span class="line">password = <span class="string">&#x27;&#x27;</span></span><br><span class="line">v12, v13, v3, v4 = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">	v13 += <span class="number">1</span></span><br><span class="line">	v12 = (v12 + table[v13]) &amp; <span class="number">0xFF</span></span><br><span class="line">	v3 = table[v13]</span><br><span class="line">	v4 = table[v12]</span><br><span class="line">	table[v12] = v3</span><br><span class="line">	table[v13] = v4</span><br><span class="line">	password += <span class="string">&quot;%02x&quot;</span> % (target[i] ^ table[(v3 + v4) &amp; <span class="number">0xFF</span>])</span><br><span class="line"><span class="built_in">print</span> password</span><br></pre></td></tr></table></figure>

<br>

<h3 id="FlareOn4-IgniteMe-x86-exe"><a href="#FlareOn4-IgniteMe-x86-exe" class="headerlink" title="[FlareOn4]IgniteMe | x86,exe"></a>[FlareOn4]IgniteMe | x86,exe</h3><p>è«å¾— main å‡½æ•°ï¼Œæ‰€æœ‰äº‹æƒ…éƒ½åœ¨ start å‡½æ•°åšå®Œï¼Œæ ¹æ®å‡½æ•°è¡Œä¸ºè¡¥ä¸€ä¸‹ç¬¦å·ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/FlareOn4IgniteMe/1.png" alt="FlareOn4IgniteMe"></p>
<p>GetInput å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/FlareOn4IgniteMe/2.png" alt="FlareOn4IgniteMe"></p>
<p>CheckInputï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/FlareOn4IgniteMe/3.png" alt="FlareOn4IgniteMe"></p>
<p>sub_401000 å‡½æ•°è¿”å›ä¸€ä¸ª key ç”¨äºä¸‹é¢å¼‚æˆ–ï¼Œè¯¥å€¼å¯ä»¥é™æ€åˆ†æï¼Œä¹Ÿå¯ä»¥åŠ¨æ€è°ƒè¯•ï¼Œexe æ²¡æœ‰å¼€é‡å®šä½ã€‚é€»è¾‘éƒ½å¾ˆç®€å•ï¼Œç›´æ¥ä¸Šè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;0D 26 49 45 2A 17 78 44 2B 6C 5D 5E 45 12 2F 17 2B 44 6F 6E 56 09 5F 45 47 73 26 0A 0D 13 17 48 42 01 40 4D 0C 02 69&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">0x27</span></span><br><span class="line">key = <span class="number">0x700004</span> &amp; <span class="number">0xFF</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">	flag[i] = target[i] ^ key</span><br><span class="line">	key = flag[i]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, flag))</span><br></pre></td></tr></table></figure>

<br>

<h3 id="MRCTF2020-Xor-x86-exe"><a href="#MRCTF2020-Xor-x86-exe" class="headerlink" title="[MRCTF2020]Xor | x86,exe"></a>[MRCTF2020]Xor | x86,exe</h3><p>shift + F12ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸² â€œGive Me Your Flag Stringâ€ çš„äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ° sub_401090ï¼Œå…¶å®è¿™å°±æ˜¯ main å‡½æ•°ã€‚F5 å‘ç°æŠ¥é”™ â€”â€” call analysis failedï¼Œè¿™ä¸ªé”™ä¸€èˆ¬æ˜¯ ida æ— æ³•æ­£ç¡®è¯†åˆ« <strong>å‡½æ•°å‚æ•°ä¸ªæ•°</strong> æˆ– <strong>å‡½æ•°è°ƒç”¨çº¦å®š</strong> å¯¼è‡´çš„ã€‚å°¤å…¶æ˜¯è°ƒç”¨å¦‚ printfã€scanf è¿™äº›å‚æ•°ä¸ªæ•°å¯å˜çš„å‡½æ•°å‡½æ•°æ—¶ï¼Œida ä¼šå‡ºç°è¿™æ ·çš„é”™è¯¯ã€‚</p>
<p>å‡ºç°è¿™ç§æƒ…å†µéœ€è¦çœ‹ <strong>output window</strong>ï¼Œé€šè¿‡ log ä¿¡æ¯çŸ¥é“æ˜¯å“ªå¥è°ƒç”¨åˆ†æå¤±è´¥äº†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/MRCTF2020Xor/1.png" alt="MRCTF2020Xor"></p>
<p>è¿™é‡Œæ˜¯åœ°å€ 0x401095 å¤„çš„è°ƒç”¨åˆ†æå¤±è´¥äº†ï¼Œæ­¤åœ°å€å¤„è°ƒç”¨äº† sub_401020ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/MRCTF2020Xor/2.png" alt="MRCTF2020Xor"></p>
<p>åŒå‡»è·Ÿè¿‡å» F5 ä¸€ä¸‹ï¼Œè®© ida çå¤§çœ¼ç›å¥½å¥½çœ‹çœ‹è¿™ä¸ªå‡½æ•°ï¼Œå†å›åˆ° sub_401090ï¼Œæ­¤æ—¶å°±å¯ä»¥ F5 äº†ã€‚å…¶ä»–é¢˜ç›®å¦‚æœåšåˆ°è¿™æ­¥è¿˜ä¸èƒ½ F5ï¼Œå°±éœ€è¦äººå·¥å¹²é¢„ï¼Œå°†å…‰æ ‡æ”¾åœ¨å‡½æ•°å¤´çš„ä½ç½®æŒ‰ â€˜Yâ€™ å¼ºè¡Œä¿®æ”¹å‚æ•°ä¸ªæ•°æˆ–å‚æ•°ç±»å‹</p>
<p>F5 åäº‹æƒ…å°±å˜å¾—ç®€å•äº†ï¼Œç›´æ¥è´´è„šæœ¬äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;4D 53 41 57 42 7E 46 58 5A 3A 4A 3A 60 74 51 4A 22 4E 40 20 62 70 64 64 7D 38 67&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">target = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> target]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">	flag += <span class="built_in">chr</span>(i ^ target[i])</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="GKCTF2020-BabyDriver-x86-sys-maze"><a href="#GKCTF2020-BabyDriver-x86-sys-maze" class="headerlink" title="[GKCTF2020]BabyDriver | x86,sys,maze"></a>[GKCTF2020]BabyDriver | x86,sys,maze</h3><p>æ‹¿åˆ°æ‰‹æ˜¯ä¸ªé©±åŠ¨ï¼Œæƒ³è¿è¡Œèµ·æ¥çš„è¯éœ€è¦æ”¹æ³¨å†Œè¡¨å¹¶æŠŠæ–‡ä»¶æ”¾åˆ°ç³»ç»Ÿæ–‡ä»¶å¤¹ï¼Œç„¶åé‡å¯â€¦â€¦è¿˜å¥½é™æ€åˆ†æèµ·æ¥ä¸éš¾</p>
<p>shift + F12 æŸ¥æ‰¾å­—ç¬¦ä¸² â€œsuccess! flag is flag{md5(input)}â€ çš„äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°å‡½æ•° sub_140001380ã€‚ç»è¿‡åˆ†æè¡¥ä¸Šä¸€äº›ç¬¦å·ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140001380</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> currentPos; <span class="comment">// ecx</span></span><br><span class="line">  __int16 *v6; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v7; <span class="comment">// rbp</span></span><br><span class="line">  __int16 v8; <span class="comment">// dx</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// dl</span></span><br><span class="line">  CHAR *v10; <span class="comment">// rcx</span></span><br><span class="line"></span><br><span class="line">  v2 = a2;</span><br><span class="line">  <span class="keyword">if</span> ( *(a2 + <span class="number">48</span>) &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = *(a2 + <span class="number">24</span>);</span><br><span class="line">    v4 = *(a2 + <span class="number">56</span>) &gt;&gt; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      currentPos = Position;</span><br><span class="line">      v6 = (v3 + <span class="number">2</span>);</span><br><span class="line">      v7 = v4;</span><br><span class="line">      <span class="keyword">while</span> ( *(v3 + <span class="number">4</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_28:</span><br><span class="line">        v6 += <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">if</span> ( !--v7 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">      &#125;</span><br><span class="line">      maze[currentPos] = <span class="string">&#x27;.&#x27;</span>;                   <span class="comment">// é“è·¯</span></span><br><span class="line">      v8 = *v6;</span><br><span class="line">      <span class="keyword">if</span> ( *v6 == <span class="number">23</span> )                          <span class="comment">// up</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( currentPos &amp; <span class="number">0xFFFFFFF0</span> )          <span class="comment">// åˆ°è¾¾ä¸Šè¾¹ç•Œ</span></span><br><span class="line">        &#123;</span><br><span class="line">          currentPos -= <span class="number">16</span>;                  	<span class="comment">// ç”±æ­¤å¯çŸ¥ä¸€è¡Œ 16 ä¸ªå­—ç¬¦</span></span><br><span class="line">          <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">        &#125;</span><br><span class="line">        currentPos += <span class="number">208</span>;</span><br><span class="line">        Position = currentPos;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v8 == <span class="number">37</span> )                           <span class="comment">// down</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (currentPos &amp; <span class="number">0xFFFFFFF0</span>) != <span class="number">208</span> ) <span class="comment">// åˆ°è¾¾ä¸‹è¾¹ç•Œ</span></span><br><span class="line">        &#123;</span><br><span class="line">          currentPos += <span class="number">16</span>;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">        &#125;</span><br><span class="line">        currentPos -= <span class="number">208</span>;</span><br><span class="line">        Position = currentPos;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v8 == <span class="number">36</span> )                           <span class="comment">// left</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( currentPos &amp; <span class="number">0xF</span> )                 <span class="comment">// åˆ°è¾¾å·¦è¾¹ç•Œ</span></span><br><span class="line">        &#123;</span><br><span class="line">          --currentPos;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">        &#125;</span><br><span class="line">        currentPos += <span class="number">15</span>;</span><br><span class="line">        Position = currentPos;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v8 != <span class="number">38</span> )                           <span class="comment">// right</span></span><br><span class="line">        <span class="keyword">goto</span> LABEL_22;</span><br><span class="line">      <span class="keyword">if</span> ( (currentPos &amp; <span class="number">0xF</span>) == <span class="number">15</span> )           <span class="comment">// åˆ°è¾¾å³è¾¹ç•Œ</span></span><br><span class="line">        currentPos -= <span class="number">15</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        ++currentPos;</span><br><span class="line">LABEL_21:</span><br><span class="line">      Position = currentPos;</span><br><span class="line">LABEL_22:</span><br><span class="line">      v9 = maze[currentPos];</span><br><span class="line">      <span class="keyword">if</span> ( v9 == <span class="string">&#x27;*&#x27;</span> )                          <span class="comment">// å¢™å£</span></span><br><span class="line">      &#123;</span><br><span class="line">        v10 = <span class="string">&quot;failed!\n&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v9 != <span class="string">&#x27;#&#x27;</span> )                        <span class="comment">// ç»ˆç‚¹</span></span><br><span class="line">        &#123;</span><br><span class="line">LABEL_27:</span><br><span class="line">          maze[currentPos] = <span class="string">&#x27;o&#x27;</span>;               <span class="comment">// èµ·ç‚¹</span></span><br><span class="line">          <span class="keyword">goto</span> LABEL_28;</span><br><span class="line">        &#125;</span><br><span class="line">        v10 = <span class="string">&quot;success! flag is flag&#123;md5(v3)&#125;\n&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      Position = <span class="number">16</span>;</span><br><span class="line">      DbgPrint(v10);</span><br><span class="line">      currentPos = Position;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_29:</span><br><span class="line">  <span class="keyword">if</span> ( *(v2 + <span class="number">65</span>) )</span><br><span class="line">    *(*(v2 + <span class="number">184</span>) + <span class="number">3</span>i64) |= <span class="number">1u</span>;</span><br><span class="line">  <span class="keyword">return</span> *(v2 + <span class="number">48</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°çš„åŠŸèƒ½æ˜¯ç›‘å¬é”®ç›˜æŒ‰é”®ï¼Œä»è€Œæ§åˆ¶ç›®æ ‡åœ¨è¿·å®«ä¸­çš„ç§»åŠ¨ï¼Œmaze æ‹¿å‡ºæ¥å¤„ç†ä¸€ä¸‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GKCTF2020BabyDriver/1.png" alt="GKCTF2020BabyDriver"></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé©±åŠ¨åˆ¤æ–­æŒ‰é”®ç”¨çš„æ˜¯é”®ç›˜æ‰«æç ï¼Œå¯ä»¥åœ¨ <a target="_blank" rel="noopener" href="https://www.supfree.net/search.asp?id=6386">ç½‘ç«™</a> æŸ¥è¯¢ï¼Œ37 å’Œ 38 åˆ†åˆ«å¯¹åº” K å’Œ Lï¼Œå°†ä¹‹å‰çš„è·¯å¾„æ›¿æ¢ä¸€ä¸‹ï¼Œå† md5ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;RDDDRRDRDDDRRRDDDRRRRRR&quot;</span></span><br><span class="line">path = path.replace(<span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">path = path.replace(<span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;K&#x27;</span>)</span><br><span class="line">md5 = hashlib.md5(path)</span><br><span class="line"><span class="built_in">print</span> md5.hexdigest()</span><br></pre></td></tr></table></figure>

<br>

<h3 id="firmware-å›ºä»¶åˆ†æ-upx"><a href="#firmware-å›ºä»¶åˆ†æ-upx" class="headerlink" title="firmware | å›ºä»¶åˆ†æ,upx"></a>firmware | å›ºä»¶åˆ†æ,upx</h3><p>æ‹¿åˆ°ä¸€ä¸ªè·¯ç”±å™¨å›ºä»¶ï¼Œ<code>binwalk -e</code> åˆ†ç¦»å¾—åˆ°ä¸€ä¸ªå‹ç¼©çš„æ–‡ä»¶ç³»ç»Ÿ <strong>120200.squashfs</strong> ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/firmware/1.png" alt="firmware"></p>
<p>éœ€è¦ç”¨åˆ° <a target="_blank" rel="noopener" href="https://github.com/mirror/firmware-mod-kit.git">firmware-mod-kit</a> è§£å‹ï¼Œå®‰è£…æ–¹æ³•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git build-essential zlib1g-dev liblzma-dev python-magic</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mirror/firmware-mod-kit.git</span><br><span class="line"><span class="built_in">cd</span> firmware-mod-kit/src</span><br><span class="line">./configure &amp;&amp; make</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æŒ‡ä»¤ <code>./unsquashfs_all.sh 120200.squashfs</code> è§£å‹æ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶å¤¹ <strong>squashfs-root</strong>ï¼Œç¿»ä¸€ä¸‹é‡Œé¢çš„æ–‡ä»¶ï¼Œåœ¨ tmp ç›®å½•ä¸‹å‘ç°å¯æ‰§è¡Œæ–‡ä»¶ backdoorï¼Œä¸”è¢« upx å‹ç¼©äº†ã€‚upx è§£å‹å ida æ‰“å¼€ï¼Œæ‰¾åˆ° initConnection å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/firmware/2.png" alt="firmware"></p>
<p>commServer æ˜¯ echo.byethost51.comï¼Œç«¯å£ä¸º 36667</p>
<br>

<h3 id="MRCTF2020-hello-world-go-x86-elf-goè¯­è¨€"><a href="#MRCTF2020-hello-world-go-x86-elf-goè¯­è¨€" class="headerlink" title="[MRCTF2020]hello_world_go | x86,elf,goè¯­è¨€"></a>[MRCTF2020]hello_world_go | x86,elf,goè¯­è¨€</h3><p>main.main å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/MRCTF2020hello_world_go/1.png" alt="MRCTF2020hello_world_go"></p>
<p>unk_4D3C58 å³ä¸º flag</p>
<br>

<h3 id="FlareOn6-Overlong-x86-exe-patch"><a href="#FlareOn6-Overlong-x86-exe-patch" class="headerlink" title="[FlareOn6]Overlong | x86,exe,patch"></a>[FlareOn6]Overlong | x86,exe,patch</h3><p>start å‡½æ•°é‡Œå¼¹äº†ä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯¹è¯æ¡†çš„å†…å®¹ç”± PrepareText å‡½æ•°å¤„ç†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/FlareOn6Overlong/1.png" alt="FlareOn6Overlong"></p>
<p>å°†ç¬¬ä¸‰ä¸ªå‚æ•° patch æˆ 127 å†è¿è¡Œå°±èƒ½å¾—åˆ° flagï¼ˆæˆ–è€…åŠ¨æ€è°ƒè¯•æŠŠä¼ å‚ä¿®æ”¹ä¸€ä¸‹ï¼‰</p>
<br>

<h3 id="WUSTCTF2020-level3-x86-elf-elfè¿è¡Œæµç¨‹"><a href="#WUSTCTF2020-level3-x86-elf-elfè¿è¡Œæµç¨‹" class="headerlink" title="[WUSTCTF2020]level3 | x86,elf,elfè¿è¡Œæµç¨‹"></a>[WUSTCTF2020]level3 | x86,elf,elfè¿è¡Œæµç¨‹</h3><p>main å‡½æ•°é€»è¾‘æ¸…æ™°ï¼Œè¦æ±‚å¯¹ d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD== è¿›è¡Œ base64 è§£å¯†ã€‚ä½†æ˜¯åœ¨ main å‡½æ•°æ‰§è¡Œå‰ï¼Œbase ç¼–ç è¡¨è¢«å‡½æ•° O_OLookAtYou åšäº†æ‰‹è„šï¼Œè¯¥å‡½æ•°åœ¨ _init_array æ•°ç»„ä¸­ï¼Œä¼šåœ¨ main å‡½æ•°ä¹‹å‰è¢«æ‰§è¡Œï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/WUSTCTF2020level3/1.png" alt="WUSTCTF2020level3"></p>
<p>elf è¿è¡Œæµç¨‹è¯¦è§æœ¬æ–‡ <strong>[2019çº¢å¸½æ¯]easyRE</strong> writeup</p>
<p>åŠ¨æ€è°ƒè¯•å°†æ–°çš„ç¼–ç è¡¨æ‹¿å‡ºæ¥ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/WUSTCTF2020level3/2.png" alt="WUSTCTF2020level3"></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span></span><br><span class="line">new_table = <span class="string">&quot;TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span></span><br><span class="line"></span><br><span class="line">general = <span class="string">&#x27;&#x27;</span></span><br><span class="line">target = <span class="string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> target :</span><br><span class="line">	general += old_table[new_table.find(i)]</span><br><span class="line"><span class="built_in">print</span> base64.b64decode(general)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="WUSTCTF2020-Cr0ssfun-x86-elf"><a href="#WUSTCTF2020-Cr0ssfun-x86-elf" class="headerlink" title="[WUSTCTF2020]Cr0ssfun | x86,elf"></a>[WUSTCTF2020]Cr0ssfun | x86,elf</h3><p>check å‡½æ•°å¯¹ flag çš„æ¯ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­ï¼Œæå‡ºæ¥æ‹¼åœ¨ä¸€èµ·å°±å¯ä»¥äº†ï¼Œä½¿ç”¨ sublime çš„æ­£åˆ™æ›¿æ¢åŠŸèƒ½ä¼šé«˜æ•ˆå¾ˆå¤š</p>
<br>

<h3 id="GXYCTF2019-simple-CPP-x86-exe-åè°ƒè¯•"><a href="#GXYCTF2019-simple-CPP-x86-exe-åè°ƒè¯•" class="headerlink" title="[GXYCTF2019]simple CPP | x86,exe,åè°ƒè¯•"></a>[GXYCTF2019]simple CPP | x86,exe,åè°ƒè¯•</h3><p>æ™šç‚¹å†å†™~</p>
<br>

<h3 id="2019çº¢å¸½æ¯-xx-x86-exe-xxtea"><a href="#2019çº¢å¸½æ¯-xx-x86-exe-xxtea" class="headerlink" title="[2019çº¢å¸½æ¯]xx | x86,exe,xxtea"></a>[2019çº¢å¸½æ¯]xx | x86,exe,xxtea</h3><p>PS. æœ¬é¢˜æ‰€æœ‰è„šæœ¬è¯­è¨€ç¯å¢ƒä¸º C/C++</p>
<p>sub_1400011A0 æ˜¯ main å‡½æ•°ï¼ˆé€šè¿‡å­—ç¬¦ä¸²äº¤å‰å¼•ç”¨æ‰¾åˆ°ï¼‰ï¼Œå¹²äº†å‡ ä»¶äº‹ï¼š</p>
<ul>
<li>è¾“å…¥ 19 ä¸ªå­—ç¬¦</li>
<li>å‰ 4 ä¸ªå­—ç¬¦ä½œä¸º key</li>
<li>è°ƒç”¨ sub_140001AB0 å‡½æ•°ï¼ˆxxtea_encodeï¼‰åŠ å¯†è¾“å…¥ï¼Œå¯†é’¥ä¸º keyï¼ŒåŠ å¯†ç»“æœè®°ä¸º r1</li>
<li>è½®æ¢åŠ å¯† r1ï¼ŒåŠ å¯†ç»“æœè®°ä¸º r2</li>
<li>for å¾ªç¯ä» r2 ç¬¬ä¸‰ä¸ªå­—ç¬¦å¼€å§‹é€å­—èŠ‚å¼‚æˆ–åŠ å¯† r2ï¼ŒåŠ å¯†ç»“æœè®°ä¸º r3</li>
<li>r3 åº”è¯¥ä¸ä¸€ä¸ªé•¿åº¦ä¸º 24 å­—èŠ‚çš„æ•°ç»„é€å­—èŠ‚ç›¸ç­‰ï¼Œè¾“å‡º You win</li>
</ul>
<p>r2 åŠ å¯†åˆ° r3 çš„é€»è¾‘ç”¨ C å¯ä»¥å†™ä½œï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Encode3</span><span class="params">(<span class="keyword">char</span>* input)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">24</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (i / <span class="number">3</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">char</span> tmp = input[i];</span><br><span class="line">			<span class="keyword">do</span></span><br><span class="line">			&#123;</span><br><span class="line">				tmp ^= input[idx++];</span><br><span class="line">			&#125; <span class="keyword">while</span> (idx &lt; i / <span class="number">3</span>);</span><br><span class="line">			input[i] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•…r3 è¿˜åŸ r2ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Decode3</span><span class="params">(<span class="keyword">char</span>* input)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">23</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">		<span class="keyword">int</span> idx = i / <span class="number">3</span> - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (i / <span class="number">3</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">char</span> tmp = input[i];</span><br><span class="line">			<span class="keyword">do</span></span><br><span class="line">			&#123;</span><br><span class="line">				tmp ^= input[idx--];</span><br><span class="line">			&#125; <span class="keyword">while</span> (idx &gt;= <span class="number">0</span>);</span><br><span class="line">			input[i] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>r1 åˆ° r2 çš„è½®æ¢åŠ å¯† F5 åç¼–è¯‘å¾—å¾ˆæ¸…æ¥šï¼Œä¸‹é¢æ˜¯ r2 è¿˜åŸ r1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Decode2</span><span class="params">(<span class="keyword">char</span>* cipher, <span class="keyword">char</span>* plain)</span> </span>&#123;</span><br><span class="line">	plain[<span class="number">2</span>] = cipher[<span class="number">0</span>];</span><br><span class="line">	plain[<span class="number">0</span>] = cipher[<span class="number">1</span>];</span><br><span class="line">	plain[<span class="number">3</span>] = cipher[<span class="number">2</span>];</span><br><span class="line">	plain[<span class="number">1</span>] = cipher[<span class="number">3</span>];</span><br><span class="line">	plain[<span class="number">6</span>] = cipher[<span class="number">4</span>];</span><br><span class="line">	plain[<span class="number">4</span>] = cipher[<span class="number">5</span>];</span><br><span class="line">	plain[<span class="number">7</span>] = cipher[<span class="number">6</span>];</span><br><span class="line">	plain[<span class="number">5</span>] = cipher[<span class="number">7</span>];</span><br><span class="line">	plain[<span class="number">10</span>] = cipher[<span class="number">8</span>];</span><br><span class="line">	plain[<span class="number">8</span>] = cipher[<span class="number">9</span>];</span><br><span class="line">	plain[<span class="number">11</span>] = cipher[<span class="number">10</span>];</span><br><span class="line">	plain[<span class="number">9</span>] = cipher[<span class="number">11</span>];</span><br><span class="line">	plain[<span class="number">14</span>] = cipher[<span class="number">12</span>];</span><br><span class="line">	plain[<span class="number">12</span>] = cipher[<span class="number">13</span>];</span><br><span class="line">	plain[<span class="number">15</span>] = cipher[<span class="number">14</span>];</span><br><span class="line">	plain[<span class="number">13</span>] = cipher[<span class="number">15</span>];</span><br><span class="line">	plain[<span class="number">18</span>] = cipher[<span class="number">16</span>];</span><br><span class="line">	plain[<span class="number">16</span>] = cipher[<span class="number">17</span>];</span><br><span class="line">	plain[<span class="number">19</span>] = cipher[<span class="number">18</span>];</span><br><span class="line">	plain[<span class="number">17</span>] = cipher[<span class="number">19</span>];</span><br><span class="line">	plain[<span class="number">22</span>] = cipher[<span class="number">20</span>];</span><br><span class="line">	plain[<span class="number">20</span>] = cipher[<span class="number">21</span>];</span><br><span class="line">	plain[<span class="number">23</span>] = cipher[<span class="number">22</span>];</span><br><span class="line">	plain[<span class="number">21</span>] = cipher[<span class="number">23</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>r1 åˆ°æ˜æ–‡è¾“å…¥çš„è§£å¯†éœ€è¦ xxtea_decodeï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº†åˆ«äººå†™å¥½çš„é¡¹ç›® <a target="_blank" rel="noopener" href="https://github.com/xxtea/xxtea-c">githubÂ xxtea</a>ï¼ŒVS é‡Œå¯¼å…¥å°±èƒ½ç”¨äº†ã€‚key å› ä¸ºå–çš„æ˜¯å¼€å¤´ 4 ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥çŒœ â€œflagâ€ï¼Œä¸‹é¢æ˜¯è§£å¯†è„šæœ¬çš„ main å‡½æ•°ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;xxtea.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// r3 -&gt; r2</span></span><br><span class="line">	<span class="keyword">char</span> r3[]&#123; <span class="number">0xCE</span>, <span class="number">0xBC</span>, <span class="number">0x40</span>, <span class="number">0x6B</span>, <span class="number">0x7C</span>, <span class="number">0x3A</span>, <span class="number">0x95</span>, <span class="number">0xC0</span>, <span class="number">0xEF</span>, <span class="number">0x9B</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x91</span>, <span class="number">0xF7</span>, <span class="number">0x02</span>, <span class="number">0x35</span>, <span class="number">0x23</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0xC8</span>, <span class="number">0xE7</span>, <span class="number">0x56</span>, <span class="number">0x56</span>, <span class="number">0xFA</span> &#125;;</span><br><span class="line">	Decode3(r3);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// r2 -&gt; r1</span></span><br><span class="line">	<span class="keyword">char</span> r1[<span class="number">24</span>];</span><br><span class="line">	Decode2(r3, r1);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// r1 -&gt; æ˜æ–‡</span></span><br><span class="line">	<span class="keyword">size_t</span> len = <span class="number">24</span>;</span><br><span class="line">	<span class="keyword">char</span> key[] = &#123; <span class="string">&quot;flag&quot;</span> &#125;;</span><br><span class="line">	<span class="keyword">char</span>* plain = (<span class="keyword">char</span> *)xxtea_decrypt(r1, len, key, &amp;len);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; plain &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ACTFæ–°ç”Ÿèµ›2020-Oruga-x86-elf-maze"><a href="#ACTFæ–°ç”Ÿèµ›2020-Oruga-x86-elf-maze" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]Oruga | x86,elf,maze"></a>[ACTFæ–°ç”Ÿèµ›2020]Oruga | x86,elf,maze</h3><p>main å‡½æ•°å‰é¢åœ¨æ£€æŸ¥è¾“å…¥å‰ 5 ä¸ªå­—ç¬¦æ˜¯ä¸æ˜¯ â€œactf{â€œï¼Œç„¶åè°ƒç”¨ sub_78A æ¥æ£€æŸ¥ flag å†…å®¹ã€‚è¯¥å‡½æ•°å¯ä»¥ç†è§£æˆä¸€ä¸ªç±»ä¼¼æ»‘åŠ¨å†°å£¶çš„æ¸¸æˆï¼Œå†°å£¶åœ¨å†°é¢ä¸Šæ»‘åŠ¨ï¼Œä¸ç¢°åˆ°å¢™å£å°±åœä¸ä¸‹æ¥ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020Oruga/1.png" alt="ACTFæ–°ç”Ÿèµ›2020Oruga"></p>
<p>å¦‚æœä¸æ˜¯å¾ˆç†è§£ï¼Œå¯ä»¥ç©ä¸‹è¿™ä¸ª <a target="_blank" rel="noopener" href="http://www.4399.com/flash/213575_1.htm">4399Â æ»‘åŠ¨æµ·ç»µæ¼†</a></p>
<p>map ä¸­çš„ 0 è¡¨ç¤ºå†°é¢ï¼Œæ„Ÿå¹å·è¡¨ç¤ºç»ˆç‚¹ï¼Œå…¶ä»–å­—ç¬¦è¡¨ç¤ºå¢™å£ã€‚æŠŠ map æ‹¿å‡ºæ¥å¤„ç†ä¸€ä¸‹ï¼Œ0 æ›¿æ¢æˆ * æ–¹ä¾¿è§‚å¯Ÿï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">maze = <span class="string">&quot;00 00 00 00 23 00 00 00 00 00 00 00 23 23 23 23 00 00 00 23 23 00 00 00 4F 4F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4F 4F 00 50 50 00 00 00 00 00 00 4C 00 4F 4F 00 4F 4F 00 50 50 00 00 00 00 00 00 4C 00 4F 4F 00 4F 4F 00 50 00 00 00 00 00 00 4C 4C 00 4F 4F 00 00 00 00 50 00 00 00 00 00 00 00 00 00 4F 4F 00 00 00 00 50 00 00 00 00 23 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 23 00 00 00 00 00 00 00 00 00 4D 4D 4D 00 00 00 23 00 00 00 00 00 00 00 00 00 00 4D 4D 4D 00 00 00 00 45 45 00 00 00 30 00 4D 00 4D 00 4D 00 00 00 00 45 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 45 45 54 54 54 49 00 4D 00 4D 00 4D 00 00 00 00 45 00 00 54 00 49 00 4D 00 4D 00 4D 00 00 00 00 45 00 00 54 00 49 00 4D 00 4D 00 4D 21 00 00 00 45 45&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">maze = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> maze]</span><br><span class="line">maze = [i <span class="keyword">if</span> i !=<span class="number">0</span> <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;*&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> maze]</span><br><span class="line">maze = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, maze))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(maze), <span class="number">16</span>):</span><br><span class="line">	<span class="built_in">print</span> maze[i:i+<span class="number">16</span>]</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°è·¯å¾„ï¼ˆå‡è®¾ ä¸Š - Uï¼Œä¸‹ - Dï¼Œå·¦ - Lï¼Œå³ - Rï¼‰ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020Oruga/2.png" alt="MRCTF2020hello_world_go"></p>
<p>æ›¿æ¢æˆé¢˜ç›®ä¸­ç”¨åˆ°çš„æ§åˆ¶æ–¹å‘çš„å››ä¸ªå­—ç¬¦ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path = <span class="string">&quot;DRURDRULDRULD&quot;</span></span><br><span class="line">path = path.replace(<span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;M&#x27;</span>)</span><br><span class="line">path = path.replace(<span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;W&#x27;</span>)</span><br><span class="line">path = path.replace(<span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;J&#x27;</span>)</span><br><span class="line">path = path.replace(<span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;E&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> path</span><br></pre></td></tr></table></figure>

<br>

<h3 id="GWCTF-2019-re3-x86-elf-SMC-md5-AES-ECB"><a href="#GWCTF-2019-re3-x86-elf-SMC-md5-AES-ECB" class="headerlink" title="[GWCTF 2019]re3 | x86,elf,SMC,md5,AES_ECB"></a>[GWCTF 2019]re3 | x86,elf,SMC,md5,AES_ECB</h3><p>main å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GWCTF2019re3/1.png" alt="GWCTF2019re3"></p>
<p>for å¾ªç¯è¡¨ç¤ºåªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™æ‰ä¼šè§£å¯† sub_402219 å‡½æ•°ï¼ˆè¯¥å‡½æ•°é€å­—èŠ‚å¼‚æˆ– 0x99ï¼‰ï¼Œå†™ä¸ª python çš„ idc è„šæœ¬ç›´æ¥è¿˜åŸè¯¥å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"></span><br><span class="line">funcAddr = <span class="number">0x402219</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">224</span>):</span><br><span class="line">	enc = get_bytes(funcAddr + i, <span class="number">1</span>)</span><br><span class="line">	dec = <span class="built_in">ord</span>(enc) ^ <span class="number">0x99</span></span><br><span class="line">	patch_byte(funcAddr + i, dec)</span><br></pre></td></tr></table></figure>

<p>åœ¨ ida ä¸­é€‰æ‹© File -&gt; Script Fileâ€¦ï¼Œé€‰æ‹©è¯¥è„šæœ¬å³å¯è¿è¡Œã€‚æ¥åˆ°åœ°å€ 0x402219 å¤„ï¼Œå…‰æ ‡æ”¾åœ¨ sub_402219 æ ‡ç­¾ä¸Šï¼ŒæŒ‰ U å–æ¶ˆå‡½æ•°å®šä¹‰ï¼Œå†æŒ‰ C æ•°æ®è½¬æ±‡ç¼–ä»£ç ï¼Œæœ€åæŒ‰ P åˆ›å»ºå‡½æ•°ï¼ŒF5 åç¼–è¯‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GWCTF2019re3/2.png" alt="GWCTF2019re3"></p>
<p>è‡³äºä¸ºä»€ä¹ˆçŸ¥é“é‚£ä¸ªå‡½æ•°æ˜¯ AES åŠ å¯†ï¼Œida æœ‰ä¸ªæ’ä»¶å« findcrypto è°ç”¨è°çŸ¥é“ï¼Œå®‰è£…æ–¹å¼è¯·è‡ªè¡Œç™¾åº¦ã€‚å¸¸ç”¨åŠ å¯†æ¨¡å¼ä¸€èˆ¬å°± CBC/ECBï¼ŒCBC æ¨¡å¼éœ€è¦ ivï¼Œè¿™é‡Œå°±ä¿©å‚æ•°ï¼Œä¸€ä¸ª keyï¼Œ ä¸€ä¸ªå¾…åŠ å¯†æ˜æ–‡ï¼Œæ‰€ä»¥åŠ å¯†æ¨¡å¼å°±æ˜¯ ECB å’¯ã€‚key ç”± sub_40207B å‡½æ•°å‡†å¤‡ï¼Œå¯ä»¥ç›´æ¥ gdb åŠ¨è°ƒä»å†…å­˜ä¸­æ‹¿å‡ºæ¥ã€‚ä¸‹é¢æ˜¯è§£å¯†è„šæœ¬ï¼ˆpython3ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">text</span>):</span></span><br><span class="line">	key = <span class="string">&quot;cb 8d 49 35 21 b4 7a 4c c1 ae 7e 62 22 92 66 ce&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">	key = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">	key = <span class="built_in">bytes</span>(key)</span><br><span class="line"></span><br><span class="line">	mode = AES.MODE_ECB</span><br><span class="line">	cryptor = AES.new(key, mode)</span><br><span class="line">	plain_text = cryptor.decrypt(a2b_hex(text))</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">bytes</span>.decode(plain_text).rstrip(<span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">raw = <span class="string">&quot;BC 0A AD C0 14 7C 5E CC E0 B1 40 BC 9C 51 D5 2B 46 B2 B9 43 4D E5 32 4B AD 7F B4 B3 9C DB 4B 5B&quot;</span></span><br><span class="line">target = raw.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">piece1 = target[:<span class="number">32</span>]</span><br><span class="line">piece2 = target[<span class="number">32</span>:]</span><br><span class="line"><span class="built_in">print</span>(decrypt(piece1) + decrypt(piece2))</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-singal-x86-exe-vmè™šæ‹Ÿæœº-angr"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-singal-x86-exe-vmè™šæ‹Ÿæœº-angr" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal | x86,exe,vmè™šæ‹Ÿæœº,angr"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal | x86,exe,vmè™šæ‹Ÿæœº,angr</h3><p>æ‰“å¼€ vm_operad å‡½æ•°ï¼Œçœ‹æ ·å­å‡ºé¢˜äººå†™äº†ä¸ªè¶…å°å‹è™šæ‹Ÿæœºï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84singal/1.png" alt="ç½‘é¼æ¯2020é’é¾™ç»„singal"></p>
<p>ä¸‰ç§æ–¹æ³•</p>
<p>ç¬¬ä¸€ç§ â€”â€” code ä¹Ÿä¸å¤šï¼Œæ‰‹åŠ¨è·Ÿè¸ªæ¯ä¸€æ¬¡ switchï¼Œå¾—åˆ° flag æ¯ä¸€ä½çš„è®¡ç®—æ–¹å¼ï¼Œå†å†™è„šæœ¬é€†å›å»</p>
<p>ç¬¬äºŒç§ â€”â€” ç¨å¾®åˆ†æä¸€ä¸‹å¾—çŸ¥ case 1 èµ‹å€¼ mem æ•°ç»„ï¼Œcase 7 æ‹¿ mem ä¸ target è¿›è¡Œæ¯”è¾ƒï¼ŒæŠŠ vm_operad ä» ida æ‘˜ä¸‹æ¥ï¼Œç”¨ VS æ”¹äº¿å°ç‚¹ï¼Œå†™ä¸ªç¨‹åºçˆ†ç ´ flagï¼ˆæˆ–è€…é€†ç€ code å›å»ï¼Œä» target åæ¨è¾“å…¥ï¼‰ã€‚çˆ†ç ´çš„è„šæœ¬æˆ‘è´´è¿™å„¿äº†ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vcruntime_string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable : 4996)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> code[<span class="number">0x1C8</span> / <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)];</span><br><span class="line"><span class="keyword">char</span> target[<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> mem[<span class="number">100</span>]; <span class="comment">// [esp-85h] [ebp-85h]</span></span><br><span class="line"><span class="keyword">char</span> reg; <span class="comment">// [esp-21h] [ebp-21h]</span></span><br><span class="line"><span class="keyword">int</span> dsp2; <span class="comment">// [esp-20h] [ebp-20h]</span></span><br><span class="line"><span class="keyword">int</span> tIdx; <span class="comment">// [esp-1Ch] [ebp-1Ch]</span></span><br><span class="line"><span class="keyword">int</span> idx; <span class="comment">// [esp-18h] [ebp-18h]</span></span><br><span class="line"><span class="keyword">int</span> dsp1; <span class="comment">// [esp-14h] [ebp-14h]</span></span><br><span class="line"><span class="keyword">int</span> ip; <span class="comment">// [esp-10h] [ebp-10h]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> mem_bak[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> reg_bak;</span><br><span class="line"><span class="keyword">int</span> dsp2_bak;</span><br><span class="line"><span class="keyword">int</span> tIdx_bak;</span><br><span class="line"><span class="keyword">int</span> idx_bak;</span><br><span class="line"><span class="keyword">int</span> dsp1_bak;</span><br><span class="line"><span class="keyword">int</span> ip_bak;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–è™šæ‹Ÿæœºç¯å¢ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">env_init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä»£ç æ®µ</span></span><br><span class="line">    <span class="comment">// memdump æ–‡ä»¶å†…å®¹ä¸º 0x403040 å¼€å§‹çš„ 0x1C8 ä¸ªå­—èŠ‚</span></span><br><span class="line">    FILE* fp = <span class="built_in">fopen</span>(<span class="string">&quot;C:\\memdump&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Error memdump file path.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fread</span>(code, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), <span class="built_in"><span class="keyword">sizeof</span></span>(code) / <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), fp);</span><br><span class="line">    <span class="built_in">fclose</span>(fp);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å†…å­˜åŠå„å¯„å­˜å™¨</span></span><br><span class="line">    <span class="built_in">memset</span>(mem, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(mem));</span><br><span class="line">    reg = <span class="number">0</span>;</span><br><span class="line">    ip = <span class="number">0</span>;</span><br><span class="line">    dsp1 = <span class="number">0</span>;</span><br><span class="line">    idx = <span class="number">0</span>;</span><br><span class="line">    tIdx = <span class="number">0</span>;</span><br><span class="line">    dsp2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–targetæ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++) &#123;</span><br><span class="line">        target[i] = (<span class="keyword">char</span>)code[<span class="number">0x154</span> / <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) + <span class="number">2</span> * i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹æ‘„å¿«ç…§</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">save_vm_state</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(mem_bak, mem, <span class="built_in"><span class="keyword">sizeof</span></span>(mem));</span><br><span class="line">    reg_bak = reg;</span><br><span class="line">    dsp2_bak = dsp2;</span><br><span class="line">    tIdx_bak = tIdx;</span><br><span class="line">    idx_bak = idx;</span><br><span class="line">    dsp1_bak = dsp1;</span><br><span class="line">    ip_bak = ip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¿«ç…§è¿˜åŸ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">recover_vm_state</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(mem, mem_bak, <span class="built_in"><span class="keyword">sizeof</span></span>(mem));</span><br><span class="line">    reg = reg_bak;</span><br><span class="line">    dsp2 = dsp2_bak;</span><br><span class="line">    tIdx = tIdx_bak;</span><br><span class="line">    idx = idx_bak;</span><br><span class="line">    dsp1 = dsp1_bak;</span><br><span class="line">    ip = ip_bak;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è™šæ‹Ÿæœºè¿è¡Œå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">vm_operate</span><span class="params">(<span class="keyword">int</span> cur, <span class="keyword">char</span>* input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in"><span class="keyword">switch</span></span> (code[ip])</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> (cur == tIdx) &#123;</span><br><span class="line">                <span class="keyword">return</span> reg == target[cur];</span><br><span class="line">            &#125;</span><br><span class="line">            ++ip;</span><br><span class="line">            ++tIdx;</span><br><span class="line">            ++dsp1;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            reg = (<span class="keyword">char</span>)(code[ip + <span class="number">1</span>]) + input[dsp1];</span><br><span class="line">            ip += <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            reg = input[dsp1] - (<span class="keyword">char</span>)(code[ip + <span class="number">1</span>]);</span><br><span class="line">            ip += <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            reg = code[ip + <span class="number">1</span>] ^ input[dsp1];</span><br><span class="line">            ip += <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            reg = code[ip + <span class="number">1</span>] * input[dsp1];</span><br><span class="line">            ip += <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            ++ip;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            <span class="comment">// åŸä¸ºæ¯”è¾ƒåŠ å¯†ç»“æœä¸target</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">            input[dsp2] = reg;</span><br><span class="line">            ++ip;</span><br><span class="line">            ++dsp2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">            <span class="comment">// åŸä¸ºæ¥æ”¶é•¿åº¦ä¸º15çš„è¾“å…¥</span></span><br><span class="line">            ++ip;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">            reg = input[dsp1] - <span class="number">1</span>;</span><br><span class="line">            ++ip;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">            reg = input[dsp1] + <span class="number">1</span>;</span><br><span class="line">            ++ip;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">env_init</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºå¿«ç…§</span></span><br><span class="line">        <span class="built_in">save_vm_state</span>();</span><br><span class="line">        <span class="comment">// æ‰€æœ‰å¯è§å­—ç¬¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">33</span>; j &lt; <span class="number">128</span>; j++) &#123;</span><br><span class="line">            flag[i] = j;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">vm_operate</span>(i, flag)) &#123;</span><br><span class="line">                <span class="comment">// flag[i]ä¸­é€”å¯èƒ½ä¼šè¢«case 8ä¿®æ”¹ï¼Œè¿™é‡Œå†èµ‹å€¼ä¸€æ¬¡</span></span><br><span class="line">                flag[i] = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æœ¬æ¬¡çŒœæµ‹ä¸æ­£ç¡®ï¼Œè¿˜åŸç°åœº</span></span><br><span class="line">            <span class="built_in">recover_vm_state</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flag[<span class="number">15</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºå‰ä¸¤ç§æ–¹æ³•éå¸¸ä¸æ–¹ä¾¿ï¼Œéƒ½éœ€è¦è®¤çœŸåˆ†ææ¯ä¸ª opcode å¯¹åº”å¹²äº†ä»€ä¹ˆäº‹ï¼Œè¾¹è°ƒè¾¹å†™ï¼Œä¸€è¡€æ—©æ²¡äº†ã€‚æœ‰æ²¡æœ‰æ— è„‘å†²å†²å†²çš„æ–¹æ³•å‘¢ï¼Ÿä¸‹é¢æœ‰è¯·ç¬¬ä¸‰ç§æ–¹æ³• â€”â€” <strong>angr ç¬¦å·æ‰§è¡Œ</strong> éš†é‡ç™»åœº</p>
<p>ç»è¿‡å‡ ä¸ªç‰ˆæœ¬çš„æ›´æ–°ï¼Œangr çš„ API ç°åœ¨ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œä¸äº†è§£çš„å¯ä»¥é˜…è¯» <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3990">ç³»åˆ—æ–‡ç« </a>ï¼Œè¿™é‡Œç›´æ¥è´´è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">project = angr.Project(<span class="string">&quot;./signal.exe&quot;</span>, auto_load_libs = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@project.hook(<span class="params"><span class="number">0x40179E</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MyHook</span>(<span class="params">state</span>):</span></span><br><span class="line">	<span class="built_in">print</span>(state.posix.dumps(<span class="number">0</span>))</span><br><span class="line">	project.terminate_execution()</span><br><span class="line"></span><br><span class="line">project.execute()</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæˆªå›¾ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84singal/2.png" alt="ç½‘é¼æ¯2020é’é¾™ç»„singal"></p>
<p>ä»€ä¹ˆå«ç§’è§£ï¼Ÿ</p>
<br>

<h3 id="GUET-CTF2019-number-game-x86-elf-äºŒå‰æ ‘-æ•°ç‹¬"><a href="#GUET-CTF2019-number-game-x86-elf-äºŒå‰æ ‘-æ•°ç‹¬" class="headerlink" title="[GUET-CTF2019]number_game | x86,elf,äºŒå‰æ ‘,æ•°ç‹¬"></a>[GUET-CTF2019]number_game | x86,elf,äºŒå‰æ ‘,æ•°ç‹¬</h3><p>æ ¹æ®å‡½æ•°è¡Œä¸ºè¿˜åŸ main é€»è¾‘ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/1.png" alt="GUETCTF2019number_game"></p>
<p>ç»“ç‚¹çš„ç»“æ„ä½“ç»åˆ†æåæœ‰ï¼š<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/2.png" alt="GUETCTF2019number_game"></p>
<p>Preorder_builder å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/3.png" alt="GUETCTF2019number_game"></p>
<p>Inorder ä¸­åºéå†å‡½æ•°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/4.png" alt="GUETCTF2019number_game"></p>
<p>CheckSudoku å‡½æ•°æ£€æŸ¥æ˜¯å¦æ»¡è¶³æ•°ç‹¬æ¸¸æˆçš„è¦æ±‚ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/5.png" alt="GUETCTF2019number_game"></p>
<p>æŠŠæ•°ç‹¬æ‹¿å‡ºæ¥çœ‹çœ‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/6.png" alt="GUETCTF2019number_game"></p>
<p>é¡ºä¾¿æ‰‹è§£äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(0, 2) = 0</span><br><span class="line">(1, 2) = 4</span><br><span class="line">(1, 4) = 2</span><br><span class="line">(2, 1) = 1</span><br><span class="line">(2, 4) = 4</span><br><span class="line">(3, 0) = 2</span><br><span class="line">(3, 2) = 1</span><br><span class="line">(3, 3) = 4</span><br><span class="line">(4, 2) = 3</span><br><span class="line">(4, 3) = 0</span><br></pre></td></tr></table></figure>

<p>FillSudoku å‡½æ•°åœ¨å¡«å†™æ•°ç‹¬çš„æ—¶å€™ä½¿ç”¨çš„å°±æ˜¯ä¸­åºéå†å¾—åˆ°çš„æ•°ç»„ä¸‹æ ‡åºåˆ—ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/GUETCTF2019number_game/7.png" alt="GUETCTF2019number_game"></p>
<p>ç†è§£äº†åŸç†å¯ä»¥ç…§ç€å†™ä¸ªå‰åºã€ä¸­åºæ¥è·å¾—å¡«å…¥æ•°ç‹¬æ—¶æ•°ç»„ä¸‹æ ‡çš„æ˜ å°„åºåˆ—ã€‚æˆ‘å·æ‡’ç›´æ¥æŠŠ CheckValid å‡½æ•° patch æ‰ï¼Œç„¶åè¾“ä¸ª ABCDEFGHIJï¼ŒåŠ¨æ€è°ƒè¯•çœ‹çœ‹è¢«æ˜ å°„åˆ°å“ªé‡Œå»äº†ï¼Œå¾—åˆ°è¢«å¡«å†™åçš„æ•°ç‹¬ä¸º 14H2330D1I0B23JE3AF042CG1ï¼Œæ•…æœ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(0, 2) = 0 -&gt; H</span><br><span class="line">(1, 2) = 4 -&gt; D</span><br><span class="line">(1, 4) = 2 -&gt; I</span><br><span class="line">(2, 1) = 1 -&gt; B</span><br><span class="line">(2, 4) = 4 -&gt; J</span><br><span class="line">(3, 0) = 2 -&gt; E</span><br><span class="line">(3, 2) = 1 -&gt; A</span><br><span class="line">(3, 3) = 4 -&gt; F</span><br><span class="line">(4, 2) = 3 -&gt; C</span><br><span class="line">(4, 3) = 0 -&gt; G</span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§ A-J çš„é¡ºåºç»„ç»‡å¥½è¾“å…¥å°±æ˜¯ flag äº†</p>
<br>

<h3 id="Zer0pts2020-easy-strcmp-x86-elf-elfè¿è¡Œæµç¨‹"><a href="#Zer0pts2020-easy-strcmp-x86-elf-elfè¿è¡Œæµç¨‹" class="headerlink" title="[Zer0pts2020]easy strcmp | x86,elf,elfè¿è¡Œæµç¨‹"></a>[Zer0pts2020]easy strcmp | x86,elf,elfè¿è¡Œæµç¨‹</h3><p>main å‡½æ•°ç®€å•åœ°é€šè¿‡ strcmp æ¥åˆ¤æ–­è¾“å…¥ï¼Œé‚£è‚¯å®šæ²¡è¿™ä¹ˆç®€å•ã€‚ç›´æ¥æ‰¾ init_arrayï¼Œå‘ç°å¯ç–‘å‡½æ•° sub_795ï¼š</p>
<p> <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Zer0pts2020easystrcmp/1.png" alt="Zer0pts2020easystrcmp"></p>
<p>è¯¥å‡½æ•°å°† strcmp çš„ plt è¡¨é¡¹æ›¿æ¢ä¸ºè™šå‡çš„ strcmpï¼Œmain å‡½æ•°è°ƒç”¨ strcmp æ—¶æ§åˆ¶æµä¼šæ¥åˆ° FakeStrcmpï¼š<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Zer0pts2020easystrcmp/2.png" alt="Zer0pts2020easystrcmp"></p>
<p>FakeStrcmp é¦–å…ˆå¯¹è¾“å…¥è¿›è¡Œå˜æ¢ï¼Œå†è°ƒç”¨ RealStrcmpï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/Zer0pts2020easystrcmp/3.png" alt="Zer0pts2020easystrcmp"></p>
<p>è„šæœ¬è¿˜åŸæ—¶éœ€è¦æ³¨æ„å°ç«¯åºçš„é—®é¢˜ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&quot;zer0pts&#123;********CENSORED********&#125;&quot;</span></span><br><span class="line">target = <span class="built_in">map</span>(<span class="built_in">ord</span>, target)</span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(target), <span class="number">8</span>):</span><br><span class="line">	tmp = target[i:i+<span class="number">8</span>]</span><br><span class="line">	num = <span class="number">0</span></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">			num += tmp[j] &lt;&lt; j * <span class="number">8</span></span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line">	nums.append(num)</span><br><span class="line"></span><br><span class="line">res = []</span><br><span class="line">qword_201060 = [<span class="number">0</span>, <span class="number">0x410A4335494A0942</span>, <span class="number">0xB0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>, <span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">	res.append(qword_201060[i] + nums[i])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">	tmp = <span class="string">&quot;%016X&quot;</span> % res[i]</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>, -<span class="number">1</span>, -<span class="number">2</span>):</span><br><span class="line">		flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(tmp[j:j+<span class="number">2</span>], <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span> flag.strip(<span class="string">&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="FlareOn3-Challenge1-x86-exe-å˜ç§base64"><a href="#FlareOn3-Challenge1-x86-exe-å˜ç§base64" class="headerlink" title="[FlareOn3]Challenge1 | x86,exe,å˜ç§base64"></a>[FlareOn3]Challenge1 | x86,exe,å˜ç§base64</h3><p>main å‡½æ•°é€»è¾‘æ¸…æ™°ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/FlareOn3Challenge1/1.png" alt="FlareOn3Challenge1"></p>
<p>ä¸è¿‡ base64 ç¼–ç è¡¨è¢«æ›¿æ¢ï¼Œè¿˜åŸï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">ori = <span class="string">&#x27;&#x27;</span></span><br><span class="line">target = <span class="string">&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;</span></span><br><span class="line"></span><br><span class="line">oldTable = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">newTable = <span class="string">&quot;ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> target:</span><br><span class="line">	idx = newTable.find(i)</span><br><span class="line">	ori += oldTable[idx]</span><br><span class="line"><span class="built_in">print</span> base64.b64decode(ori)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="equation-javascript-JsFuckæ··æ·†"><a href="#equation-javascript-JsFuckæ··æ·†" class="headerlink" title="equation | javascript, JsFuckæ··æ·†"></a>equation | javascript, JsFuckæ··æ·†</h3><p>å¯ä»¥ç›´æ¥ç”¨ js å†™æ­£åˆ™æ›¿æ¢ï¼Œä½†æœ€åè¿˜æ˜¯è¦åˆ° python é‡Œæ¥ç”¨ z3 æ±‚è§£å™¨ï¼Œæ‰€ä»¥å¹²è„†å°±å…¨ç”¨ python å¥½äº†ï¼Œpython é‡Œæ‰§è¡Œ js ä»£ç éœ€è¦ç”¨åˆ° PyExecJS åº“ã€‚æ‰€æœ‰ç­‰å¼åæ··æ·†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ExecFront</span>(<span class="params">string</span>):</span></span><br><span class="line">	num = execjs.<span class="built_in">eval</span>(string.group(<span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;l[%s]&quot;</span> % num</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ExecBehind</span>(<span class="params">string</span>):</span></span><br><span class="line">	num = execjs.<span class="built_in">eval</span>(string.group(<span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot; == %s&quot;</span> % num</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;equation.html&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	data = f.read()</span><br><span class="line"><span class="comment"># å–å‡º html æ–‡æ¡£ä¸­çš„æ‰€æœ‰ç­‰å¼</span></span><br><span class="line">equations = re.search(<span class="string">r&quot;if\((.+)\)&#123;&quot;</span>, data).group(<span class="number">1</span>).split(<span class="string">&quot;&amp;&amp;&quot;</span>)</span><br><span class="line"><span class="comment"># æ¯ä¸ªç­‰å¼åˆ†ä¸¤éƒ¨åˆ†åŒ¹é…å¤„ç†</span></span><br><span class="line"><span class="keyword">for</span> equation <span class="keyword">in</span> equations:</span><br><span class="line">	<span class="comment"># &#x27;==&#x27; å‰é¢çš„éƒ¨åˆ†</span></span><br><span class="line">	tmp = re.sub(<span class="string">r&quot;(?:l\[)([!\+\[\]]+)(?:\])&quot;</span>, ExecFront, equation)</span><br><span class="line">	<span class="comment"># &#x27;==&#x27; åé¢çš„éƒ¨åˆ†</span></span><br><span class="line">	<span class="built_in">print</span> re.sub(<span class="string">r&quot;(?:==)(.+)&quot;</span>, ExecBehind, tmp)</span><br></pre></td></tr></table></figure>

<p>è¿˜æŒºå¾—åŠ²å„¿ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="../img/equation/1.png" alt="equation"></p>
<p>ä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ z3ï¼Œè¿˜éœ€è¦å°æ”¹äº¿äº›åœ°æ–¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> z3</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ExecFront</span>(<span class="params">string</span>):</span></span><br><span class="line">	num = execjs.<span class="built_in">eval</span>(string.group(<span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;flag_char[%s]&quot;</span> % num</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ExecBehind</span>(<span class="params">string</span>):</span></span><br><span class="line">	num = execjs.<span class="built_in">eval</span>(string.group(<span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot; == %s&quot;</span> % num</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;equation.html&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	data = f.read()</span><br><span class="line"></span><br><span class="line">flag_len = <span class="number">0x2a</span></span><br><span class="line">solver = z3.Solver()</span><br><span class="line">flag_char = [z3.Int(<span class="string">&quot;char%d&quot;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ çº¦æŸ</span></span><br><span class="line">equations = re.search(<span class="string">r&quot;if\((.+)\)&#123;&quot;</span>, data).group(<span class="number">1</span>).split(<span class="string">&quot;&amp;&amp;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> equation <span class="keyword">in</span> equations:</span><br><span class="line">	tmp = re.sub(<span class="string">r&quot;(?:l\[)([!\+\[\]]+)(?:\])&quot;</span>, ExecFront, equation)</span><br><span class="line">	eq = re.sub(<span class="string">r&quot;(?:==)(.+)&quot;</span>, ExecBehind, tmp)</span><br><span class="line">	<span class="comment"># print eq</span></span><br><span class="line">	<span class="built_in">eval</span>( <span class="string">&quot;solver.add( &quot;</span> + eq + <span class="string">&quot; )&quot;</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚è§£å™¨æ±‚è§£</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == z3.sat:</span><br><span class="line">	s = solver.model()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">		flag += <span class="built_in">chr</span>(s[flag_char[i]].as_long())</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ACTFæ–°ç”Ÿèµ›2020-Universe-final-answer-x86-elf-z3-angr"><a href="#ACTFæ–°ç”Ÿèµ›2020-Universe-final-answer-x86-elf-z3-angr" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]Universe_final_answer | x86,elf,z3,angr"></a>[ACTFæ–°ç”Ÿèµ›2020]Universe_final_answer | x86,elf,z3,angr</h3><p>sub_860 åä¸ªæœªçŸ¥æ•°ï¼Œåä¸ªæ–¹ç¨‹ï¼ŒæœªçŸ¥æ•°å¯¹åº”è¾“å…¥çš„ keyï¼Œå¯ä»¥ä½¿ç”¨ python z3-solver åº“æ¥æ±‚è§£å¤šå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼Œä½†æˆ‘æ‡’å¾—ä» ida ä¸Šæ‘˜æ–¹ç¨‹äº†ï¼Œangr æœ€å–œæ¬¢è¿™ç§äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">base_addr = <span class="number">0x400000</span></span><br><span class="line"></span><br><span class="line">project = angr.Project(<span class="string">&quot;./UniverseFinalAnswer&quot;</span>, </span><br><span class="line">				main_opts = &#123;<span class="string">&quot;base_addr&quot;</span> : base_addr&#125;,</span><br><span class="line">				auto_load_libs = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">state = project.factory.entry_state(add_options = &#123;angr.options.LAZY_SOLVES&#125;)</span><br><span class="line">simManager = project.factory.simgr(state)</span><br><span class="line">simManager.explore(find = base_addr + <span class="number">0x71A</span>, avoid = base_addr + <span class="number">0x6EF</span>)</span><br><span class="line"></span><br><span class="line">flag = simManager.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(flag[:<span class="number">10</span>].decode())</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ° F0uRTy_7w@ï¼Œè¿è¡Œç¨‹åºï¼Œè¾“å…¥è¯¥ key å¾—åˆ° flag</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">in1t</a></span></div><div class="post-cover__authorid"><span class="post-copyright-meta">å°é¢ç”»å¸ˆ: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://www.pixiv.net/users/9790122">9790122</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://in1nit1t.github.io/2020/11/10/buuoj-%E9%80%86%E5%90%91%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%80%EF%BC%89/">http://in1nit1t.github.io/2020/11/10/buuoj-é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸€ï¼‰/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://in1nit1t.github.io" target="_blank">in1t's blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91/">é€†å‘</a><a class="post-meta__tags" href="/tags/buuoj/">buuoj</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/buuojre1.jpg" data-sites="wechat,qq,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/28/buuoj-%E9%80%86%E5%90%91%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E4%BA%8C%EF%BC%89/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/buuojre2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆäºŒï¼‰</div></div></a></div><div class="next-post pull-right"><a href="/2020/10/13/Xposed%E4%B8%8EEdXposed%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/xposedbuild.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Xposedä¸EdXposedæ¡†æ¶æ­å»º</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2021/02/03/buuoj-é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸‰ï¼‰/" title="buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸‰ï¼‰"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/buuojre3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-03</div><div class="title">buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸‰ï¼‰</div></div></a></div><div><a href="/2020/11/28/buuoj-é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆäºŒï¼‰/" title="buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆäºŒï¼‰"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/buuojre2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-28</div><div class="title">buuoj é€†å‘åˆ·é¢˜ä¹‹æ—…ï¼ˆäºŒï¼‰</div></div></a></div><div><a href="/2020/03/18/Source-Insight-3ç ´è§£/" title="Source Insight 3ç ´è§£"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/cover/sourceinsight.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-18</div><div class="title">Source Insight 3ç ´è§£</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#easyre-x86-exe"><span class="toc-number">1.</span> <span class="toc-text">easyre |x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse1-x86-exe"><span class="toc-number">2.</span> <span class="toc-text">reverse1 |x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse2-x86-elf"><span class="toc-number">3.</span> <span class="toc-text">reverse2 |x86,elf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E6%B6%B5%E7%9A%84%E8%BD%AF%E4%BB%B6-x86-exe"><span class="toc-number">4.</span> <span class="toc-text">å†…æ¶µçš„è½¯ä»¶ | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90-x86-exe-upx"><span class="toc-number">5.</span> <span class="toc-text">æ–°å¹´å¿«ä¹ | x86,exe,upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-guessgame-x86-exe"><span class="toc-number">6.</span> <span class="toc-text">[BJDCTF 2nd]guessgame | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#helloword-JVM-apk-java%E5%B1%82"><span class="toc-number">7.</span> <span class="toc-text">helloword | JVM,apk,javaå±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xor-x86-MachO"><span class="toc-number">8.</span> <span class="toc-text">xor | x86,MachO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse3-x86-exe-base64"><span class="toc-number">9.</span> <span class="toc-text">reverse3 | x86,exe,base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag-x86-exe-maze"><span class="toc-number">10.</span> <span class="toc-text">ä¸ä¸€æ ·çš„flag | x86,exe,maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SimpleRev-x86-elf"><span class="toc-number">11.</span> <span class="toc-text">SimpleRev | x86,elf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86-JVM-java%E5%B1%82"><span class="toc-number">12.</span> <span class="toc-text">Javaé€†å‘è§£å¯† | JVM,javaå±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96-x86-exe-%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2-base64"><span class="toc-number">13.</span> <span class="toc-text">åˆ®å¼€æœ‰å¥– | x86,exe,å›¾å½¢ç•Œé¢,base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-8086-x86-exe-DOS"><span class="toc-number">14.</span> <span class="toc-text">[BJDCTF 2nd]8086 | x86,exe,DOS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF2020-Check-1n-x86-exe"><span class="toc-number">15.</span> <span class="toc-text">[GKCTF2020]Check_1n | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#findit-JVM-apk-java%E5%B1%82"><span class="toc-number">16.</span> <span class="toc-text">findit | JVM,apk,javaå±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-luck-guy-x86-elf-patch"><span class="toc-number">17.</span> <span class="toc-text">[GXYCTF2019]luck_guy | x86,elf,patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8-JVM-apk-java%E5%B1%82"><span class="toc-number">18.</span> <span class="toc-text">ç®€å•æ³¨å†Œå™¨ | JVM,apk,javaå±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa-rsa"><span class="toc-number">19.</span> <span class="toc-text">rsa | rsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GWCTF-2019-pyre-PVM-pyc"><span class="toc-number">20.</span> <span class="toc-text">[GWCTF 2019]pyre | PVM,pyc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CrackRTF-x86-exe-sha1-md5"><span class="toc-number">21.</span> <span class="toc-text">CrackRTF | x86,exe,sha1,md5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-JustRE-x86-exe-%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2"><span class="toc-number">22.</span> <span class="toc-text">[BJDCTF2020]JustRE | x86,exe,å›¾å½¢ç•Œé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE-x86-elf-elf%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">23.</span> <span class="toc-text">[2019çº¢å¸½æ¯]easyRE | x86,elf,elfè¿è¡Œæµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Youngter-drive-x86-exe-upx-%E8%8A%B1%E6%8C%87%E4%BB%A4"><span class="toc-number">24.</span> <span class="toc-text">Youngter-drive | x86,exe,upx,èŠ±æŒ‡ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-easyre-x86-exe-upx"><span class="toc-number">25.</span> <span class="toc-text">[ACTFæ–°ç”Ÿèµ›2020]easyre | x86,exe,upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C-JVM-apk-native%E5%B1%82"><span class="toc-number">26.</span> <span class="toc-text">ç›¸å†Œ | JVM,apk,nativeå±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF2019-SignIn-x86-elf-RSA"><span class="toc-number">27.</span> <span class="toc-text">[SUCTF2019]SignIn | x86,elf,RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-rome-x86-exe-%E6%81%BA%E6%92%92%E5%AF%86%E7%A0%81"><span class="toc-number">28.</span> <span class="toc-text">[ACTFæ–°ç”Ÿèµ›2020]rome | x86,exe,æºæ’’å¯†ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-re-x86-elf-upx"><span class="toc-number">29.</span> <span class="toc-text">[GUET-CTF2019]re | x86,elf,upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn4-login-javascript"><span class="toc-number">30.</span> <span class="toc-text">[FlareOn4]login | javascript</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#V-amp-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B-strangeCpp-x86-exe"><span class="toc-number">31.</span> <span class="toc-text">[V&amp;N2020 å…¬å¼€èµ›]strangeCpp | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-easy-x86-exe-patch"><span class="toc-number">32.</span> <span class="toc-text">[BJDCTF2020]easy | x86,exe,patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-usualCrypt-x86-exe-%E5%8F%98%E7%A7%8Dbase64"><span class="toc-number">33.</span> <span class="toc-text">[ACTFæ–°ç”Ÿèµ›2020]usualCrypt | x86,exe,å˜ç§base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#V-amp-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B-CSRe-x86-exe-NET-%E6%B7%B7%E6%B7%86"><span class="toc-number">34.</span> <span class="toc-text">[V&amp;N2020 å…¬å¼€èµ›]CSRe | x86,exe,.NET,æ··æ·†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-Transform-x86-exe"><span class="toc-number">35.</span> <span class="toc-text">[MRCTF2020]Transform | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GWCTF-2019-xxor-x86-elf-tea"><span class="toc-number">36.</span> <span class="toc-text">[GWCTF 2019]xxor | x86,elf,tea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDCTF2019-Maze-x86-exe-upx-maze"><span class="toc-number">37.</span> <span class="toc-text">[HDCTF2019]Maze | x86,exe,upx,maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-BJD-hamburger-competition-x86-exe-NET-Unity%E6%B8%B8%E6%88%8F"><span class="toc-number">38.</span> <span class="toc-text">[BJDCTF2020]BJD hamburger competition | x86,exe,.NET,Unityæ¸¸æˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level1-x86-elf"><span class="toc-number">39.</span> <span class="toc-text">[WUSTCTF2020]level1 | x86,elf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level2-x86-elf-upx"><span class="toc-number">40.</span> <span class="toc-text">[WUSTCTF2020]level2 | x86,elf,upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crackMe-x86-exe-%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">41.</span> <span class="toc-text">crackMe | x86,exe,åè°ƒè¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn4-IgniteMe-x86-exe"><span class="toc-number">42.</span> <span class="toc-text">[FlareOn4]IgniteMe | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-Xor-x86-exe"><span class="toc-number">43.</span> <span class="toc-text">[MRCTF2020]Xor | x86,exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF2020-BabyDriver-x86-sys-maze"><span class="toc-number">44.</span> <span class="toc-text">[GKCTF2020]BabyDriver | x86,sys,maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#firmware-%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90-upx"><span class="toc-number">45.</span> <span class="toc-text">firmware | å›ºä»¶åˆ†æ,upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-hello-world-go-x86-elf-go%E8%AF%AD%E8%A8%80"><span class="toc-number">46.</span> <span class="toc-text">[MRCTF2020]hello_world_go | x86,elf,goè¯­è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn6-Overlong-x86-exe-patch"><span class="toc-number">47.</span> <span class="toc-text">[FlareOn6]Overlong | x86,exe,patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level3-x86-elf-elf%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">48.</span> <span class="toc-text">[WUSTCTF2020]level3 | x86,elf,elfè¿è¡Œæµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-Cr0ssfun-x86-elf"><span class="toc-number">49.</span> <span class="toc-text">[WUSTCTF2020]Cr0ssfun | x86,elf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-simple-CPP-x86-exe-%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">50.</span> <span class="toc-text">[GXYCTF2019]simple CPP | x86,exe,åè°ƒè¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-xx-x86-exe-xxtea"><span class="toc-number">51.</span> <span class="toc-text">[2019çº¢å¸½æ¯]xx | x86,exe,xxtea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Oruga-x86-elf-maze"><span class="toc-number">52.</span> <span class="toc-text">[ACTFæ–°ç”Ÿèµ›2020]Oruga | x86,elf,maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GWCTF-2019-re3-x86-elf-SMC-md5-AES-ECB"><span class="toc-number">53.</span> <span class="toc-text">[GWCTF 2019]re3 | x86,elf,SMC,md5,AES_ECB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-singal-x86-exe-vm%E8%99%9A%E6%8B%9F%E6%9C%BA-angr"><span class="toc-number">54.</span> <span class="toc-text">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal | x86,exe,vmè™šæ‹Ÿæœº,angr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-number-game-x86-elf-%E4%BA%8C%E5%8F%89%E6%A0%91-%E6%95%B0%E7%8B%AC"><span class="toc-number">55.</span> <span class="toc-text">[GUET-CTF2019]number_game | x86,elf,äºŒå‰æ ‘,æ•°ç‹¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zer0pts2020-easy-strcmp-x86-elf-elf%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">56.</span> <span class="toc-text">[Zer0pts2020]easy strcmp | x86,elf,elfè¿è¡Œæµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn3-Challenge1-x86-exe-%E5%8F%98%E7%A7%8Dbase64"><span class="toc-number">57.</span> <span class="toc-text">[FlareOn3]Challenge1 | x86,exe,å˜ç§base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#equation-javascript-JsFuck%E6%B7%B7%E6%B7%86"><span class="toc-number">58.</span> <span class="toc-text">equation | javascript, JsFuckæ··æ·†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Universe-final-answer-x86-elf-z3-angr"><span class="toc-number">59.</span> <span class="toc-text">[ACTFæ–°ç”Ÿèµ›2020]Universe_final_answer | x86,elf,z3,angr</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/cover/buuojre1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By in1t</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="åšå®¢æ¡†æ¶ä¸ºHexo"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-orange?style=flat&logo=bitdefender" title="ä¸»é¢˜é‡‡ç”¨butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Source-Github-brightgreen?style=flat&logo=GitHub" title="æœ¬ç«™é¡¹ç›®ç”±Gtihubæ‰˜ç®¡"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);</script><div class="js-pjax"></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="/js/modify.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="ğŸ’,ğŸŒ¸,ğŸ’®,ğŸµ,ğŸŒ¹,ğŸ¥€,ğŸŒº,ğŸŒ»,ğŸŒ¼,ğŸŒ·,ğŸŒ±,ğŸŒ²,ğŸŒ³,ğŸŒ´,ğŸŒµ,ğŸŒ¾,ğŸŒ¿,â˜˜,ğŸ€,ğŸ,ğŸ‚,ğŸƒ,ğŸ‡,ğŸˆ,ğŸ‰,ğŸŠ,ğŸ‹,ğŸŒ,ğŸ,ğŸ,ğŸ,ğŸ,ğŸ‘,ğŸ’,ğŸ“,ğŸ¥,ğŸ…,ğŸ¥¥,ğŸ¥‘,ğŸ†,ğŸ¥”,ğŸ¥•,ğŸŒ½,ğŸŒ¶,ğŸ¥’,ğŸ¥¬,ğŸ¥¦,ğŸ§„,ğŸ§…,ğŸ„,ğŸ¥œ,ğŸŒ°,ğŸ,ğŸ¥,ğŸ¥–,ğŸ¥¨,ğŸ¥¯,ğŸ¥,ğŸ§‡,ğŸ§€,ğŸ–,ğŸ—,ğŸ¥©,ğŸ¥“,ğŸ”,ğŸŸ,ğŸ•,ğŸŒ­,ğŸ¥ª,ğŸŒ®,ğŸŒ¯,ğŸ¥™,ğŸ§†,ğŸ¥š,ğŸ³,ğŸ¥˜,ğŸ²,ğŸ¥£,ğŸ¥—,ğŸ¿,ğŸ§ˆ,ğŸ§‚,ğŸ¥«,ğŸ±,ğŸ˜,ğŸ™,ğŸš,ğŸ›,ğŸœ,ğŸ ,ğŸ¢,ğŸ£,ğŸ¤,ğŸ¥,ğŸ¥®,ğŸ¡,ğŸ¥Ÿ,ğŸ¥ ,ğŸ¥¡,ğŸ¦ª,ğŸ¨,ğŸ©,ğŸª,ğŸ‚,ğŸ°,ğŸ§,ğŸ¥§,ğŸ«,ğŸ¬,ğŸ­,ğŸ®,ğŸ¯,ğŸ¼,ğŸ¥›,â˜•,ğŸµ,ğŸ¶,ğŸ¾,ğŸ·,ğŸ¹,ğŸ»,ğŸ¥‚,ğŸ¥ƒ,ğŸ¥¤,ğŸ§ƒ,ğŸ§‰,ğŸ§Š,ğŸ¥¢,ğŸ½,ğŸ¥„" data-fontsize="20px" data-random="false" async="async"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":20,"vOffset":-65},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body></html>